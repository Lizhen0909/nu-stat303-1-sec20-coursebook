<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; More on Pandas – Data Science I with python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Data visualization.html" rel="next">
<link href="./Pandas.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Reading data.html">Exploratory data analysis: Core tools</a></li><li class="breadcrumb-item"><a href="./data_types_in_pandas.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More on Pandas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="https://statistics.northwestern.edu/" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science I with python</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started: Coding environment</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./venv_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Setting up your environment with VS Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow_enhance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Enhancing Workflow in Jupyter Notebooks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Prerequisite: Python programming</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Introduction to Python and Jupyter Notebooks.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data structures</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Exploratory data analysis: Core tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reading Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_types_in_pandas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More on Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Advanced_Data_Visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Data Wrangling: Essential skills</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Grouping and Aggregation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Reshaping and Enrichment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Assignment A</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment B.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Assignment B</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment C.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Assignment C</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment D.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">Assignment D</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment E.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">E</span>&nbsp; <span class="chapter-title">Assignment E</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment F.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">F</span>&nbsp; <span class="chapter-title">Assignment F</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">G</span>&nbsp; <span class="chapter-title">Datasets &amp; Templates</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#types-of-data" id="toc-types-of-data" class="nav-link active" data-scroll-target="#types-of-data"><span class="header-section-number">8.1</span> Types of Data</a>
  <ul>
  <li><a href="#available-data-types-and-associated-built-in-functions" id="toc-available-data-types-and-associated-built-in-functions" class="nav-link" data-scroll-target="#available-data-types-and-associated-built-in-functions"><span class="header-section-number">8.1.1</span> Available Data Types and Associated Built-in Functions</a></li>
  <li><a href="#data-type-filtering" id="toc-data-type-filtering" class="nav-link" data-scroll-target="#data-type-filtering"><span class="header-section-number">8.1.2</span> Data Type Filtering</a></li>
  <li><a href="#data-type-conversion" id="toc-data-type-conversion" class="nav-link" data-scroll-target="#data-type-conversion"><span class="header-section-number">8.1.3</span> Data Type Conversion</a></li>
  <li><a href="#working-with-datatime-data" id="toc-working-with-datatime-data" class="nav-link" data-scroll-target="#working-with-datatime-data"><span class="header-section-number">8.1.4</span> Working with <code>datatime</code> Data</a>
  <ul class="collapse">
  <li><a href="#the-dt-accessor" id="toc-the-dt-accessor" class="nav-link" data-scroll-target="#the-dt-accessor"><span class="header-section-number">8.1.4.1</span> the <code>dt</code> accessor</a></li>
  </ul></li>
  <li><a href="#working-with-object-data" id="toc-working-with-object-data" class="nav-link" data-scroll-target="#working-with-object-data"><span class="header-section-number">8.1.5</span> Working with <code>object</code> Data</a>
  <ul class="collapse">
  <li><a href="#the-str-accessor-in-pandas" id="toc-the-str-accessor-in-pandas" class="nav-link" data-scroll-target="#the-str-accessor-in-pandas"><span class="header-section-number">8.1.5.1</span> the <code>str</code> accessor in pandas</a></li>
  <li><a href="#the-re-module-in-python-is-used-for-regular-expression" id="toc-the-re-module-in-python-is-used-for-regular-expression" class="nav-link" data-scroll-target="#the-re-module-in-python-is-used-for-regular-expression"><span class="header-section-number">8.1.5.2</span> the <code>re</code> module in Python is used for regular expression</a></li>
  <li><a href="#the-nltk-library-for-nlp-skipped" id="toc-the-nltk-library-for-nlp-skipped" class="nav-link" data-scroll-target="#the-nltk-library-for-nlp-skipped"><span class="header-section-number">8.1.5.3</span> the <code>NLTK</code> Library for NLP (skipped)</a></li>
  </ul></li>
  <li><a href="#working-with-numerical-data" id="toc-working-with-numerical-data" class="nav-link" data-scroll-target="#working-with-numerical-data"><span class="header-section-number">8.1.6</span> Working with <code>numerical</code> Data</a>
  <ul class="collapse">
  <li><a href="#summary-statistics-across-rowscolumns-in-pandas" id="toc-summary-statistics-across-rowscolumns-in-pandas" class="nav-link" data-scroll-target="#summary-statistics-across-rowscolumns-in-pandas"><span class="header-section-number">8.1.6.1</span> Summary statistics across rows/columns in Pandas</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./Reading data.html">Exploratory data analysis: Core tools</a></li><li class="breadcrumb-item"><a href="./data_types_in_pandas.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More on Pandas</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">More on Pandas</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="types-of-data" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="types-of-data"><span class="header-section-number">8.1</span> Types of Data</h2>
<p>Each column(feature) in a pandas dataframe has a datatype associated with it. Those datatypes can be grouped into <strong>Numerical</strong>, <strong>Categorical</strong>, and <strong>Dates</strong>.</p>
<div id="cell-2" class="cell" data-execution_count="2">
<div class="cell-output cell-output-display" data-execution_count="2">
<img src="./images/datatypes.gif" width="500">
</div>
</div>
<div id="cell-3" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-4" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>movie_ratings <span class="op">=</span> pd.read_csv(<span class="st">'./datasets/movie_ratings.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">US Gross</th>
<th data-quarto-table-cell-role="th">Worldwide Gross</th>
<th data-quarto-table-cell-role="th">Production Budget</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">MPAA Rating</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Major Genre</th>
<th data-quarto-table-cell-role="th">Creative Type</th>
<th data-quarto-table-cell-role="th">IMDB Rating</th>
<th data-quarto-table-cell-role="th">IMDB Votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Opal Dreams</td>
<td>14443</td>
<td>14443</td>
<td>9000000</td>
<td>Nov 22 2006</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
<td>6.5</td>
<td>468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Major Dundee</td>
<td>14873</td>
<td>14873</td>
<td>3800000</td>
<td>Apr 07 1965</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Western/Musical</td>
<td>Fiction</td>
<td>6.7</td>
<td>2588</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>The Informers</td>
<td>315000</td>
<td>315000</td>
<td>18000000</td>
<td>Apr 24 2009</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Horror/Thriller</td>
<td>Fiction</td>
<td>5.2</td>
<td>7595</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Buffalo Soldiers</td>
<td>353743</td>
<td>353743</td>
<td>15000000</td>
<td>Jul 25 2003</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Comedy</td>
<td>Fiction</td>
<td>6.9</td>
<td>13510</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>The Last Sin Eater</td>
<td>388390</td>
<td>388390</td>
<td>2200000</td>
<td>Feb 09 2007</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
<td>5.7</td>
<td>1012</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>The <code>dtypes</code> property is used to find the data types associated with each column in the DataFrame.</p>
<div id="cell-6" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>Title                 object
US Gross               int64
Worldwide Gross        int64
Production Budget      int64
Release Date          object
MPAA Rating           object
Source                object
Major Genre           object
Creative Type         object
IMDB Rating          float64
IMDB Votes             int64
dtype: object</code></pre>
</div>
</div>
<section id="available-data-types-and-associated-built-in-functions" class="level3" data-number="8.1.1">
<h3 data-number="8.1.1" class="anchored" data-anchor-id="available-data-types-and-associated-built-in-functions"><span class="header-section-number">8.1.1</span> Available Data Types and Associated Built-in Functions</h3>
<p>In a DataFrame, columns can have different data types. Here are the common data types you’ll encounter and some built-in functions associated with each type:</p>
<ol type="1">
<li><strong>Numerical Data (int, float)</strong>
<ul>
<li>Built-in functions: <code>mean()</code>, <code>sum()</code>, <code>min()</code>, <code>max()</code>, <code>std()</code>, <code>median()</code>, <code>quantile()</code>, etc.</li>
</ul></li>
<li><strong>Object Data (str or mixed types)</strong>
<ul>
<li>Built-in functions: <code>str.contains()</code>, <code>str.startswith()</code>, <code>str.endswith()</code>, <code>str.lower()</code>, <code>str.upper()</code>, <code>str.replace()</code>, etc.</li>
</ul></li>
<li><strong>Datetime Data (dates)</strong>
<ul>
<li>Built-in functions: <code>dt.year</code>, <code>dt.month</code>, <code>dt.day</code>, <code>dt.strftime()</code>, <code>dt.weekday()</code>, <code>dt.hour</code>, etc.</li>
</ul></li>
</ol>
<p>These functions help in exploring and transforming the data effectively depending on the type of data in each column.</p>
</section>
<section id="data-type-filtering" class="level3" data-number="8.1.2">
<h3 data-number="8.1.2" class="anchored" data-anchor-id="data-type-filtering"><span class="header-section-number">8.1.2</span> Data Type Filtering</h3>
<p>We can filter the columns based on its data types</p>
<div id="cell-9" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># select just categorical(object) columns</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>movie_ratings.select_dtypes(include<span class="op">=</span><span class="st">'object'</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">MPAA Rating</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Major Genre</th>
<th data-quarto-table-cell-role="th">Creative Type</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Opal Dreams</td>
<td>Nov 22 2006</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Major Dundee</td>
<td>Apr 07 1965</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Western/Musical</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>The Informers</td>
<td>Apr 24 2009</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Horror/Thriller</td>
<td>Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Buffalo Soldiers</td>
<td>Jul 25 2003</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Comedy</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>The Last Sin Eater</td>
<td>Feb 09 2007</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-10" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the numeric columns</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">US Gross</th>
<th data-quarto-table-cell-role="th">Worldwide Gross</th>
<th data-quarto-table-cell-role="th">Production Budget</th>
<th data-quarto-table-cell-role="th">IMDB Rating</th>
<th data-quarto-table-cell-role="th">IMDB Votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>14443</td>
<td>14443</td>
<td>9000000</td>
<td>6.5</td>
<td>468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>14873</td>
<td>14873</td>
<td>3800000</td>
<td>6.7</td>
<td>2588</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>315000</td>
<td>315000</td>
<td>18000000</td>
<td>5.2</td>
<td>7595</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>353743</td>
<td>353743</td>
<td>15000000</td>
<td>6.9</td>
<td>13510</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>388390</td>
<td>388390</td>
<td>2200000</td>
<td>5.7</td>
<td>1012</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="data-type-conversion" class="level3" data-number="8.1.3">
<h3 data-number="8.1.3" class="anchored" data-anchor-id="data-type-conversion"><span class="header-section-number">8.1.3</span> Data Type Conversion</h3>
<p>Often, after the inital reading, we need to convert the datatypes of some of the columns to make them suitable for analysis,as the available functions and operations depend on the column’s data type. For example, the datatype of Release Date in the DataFrame <code>movie_ratings</code> is object. To perform datetime related computations on this variable, we’ll need to convert it to a datatime format. We’ll use the Pandas function <code>to_datatime()</code> to covert it to a datatime format. Similar functions such as <code>to_numeric()</code>, <code>to_string()</code> etc., can be used for other conversions.</p>
<p>In Pandas, the <code>errors='coerce'</code> parameter is often used in the context of data conversion, specifically when using the <code>pd.to_numeric</code> function. This argument tells Pandas to convert values that it can and set the ones it cannot convert to <code>NaN</code>. It’s a way of gracefully handling errors without raising an exception. Read the textbook for an example</p>
<div id="cell-12" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the datatype of release data column </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(movie_ratings[<span class="st">'Release Date'</span>].dtypes)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Release Date'</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>object</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>0    Nov 22 2006
1    Apr 07 1965
2    Apr 24 2009
3    Jul 25 2003
4    Feb 09 2007
Name: Release Date, dtype: object</code></pre>
</div>
</div>
<p>Next, we’ll convert the <code>Release Date</code> column in the DataFrame to the <code>datetime</code> format to facilitate further analysis.</p>
<div id="cell-14" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Release Date'</span>] <span class="op">=</span> pd.to_datetime(movie_ratings[<span class="st">'Release Date'</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's check the datatype of release data column again</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Release Date'</span>].dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>dtype('&lt;M8[ns]')</code></pre>
</div>
</div>
<p><code>dtype('&lt;M8[ns]')</code> means a 64-bit datetime object with nanosecond precision stored in little-endian format. This data type is commonly used to represent timestamps in high-resolution time series data.</p>
</section>
<section id="working-with-datatime-data" class="level3" data-number="8.1.4">
<h3 data-number="8.1.4" class="anchored" data-anchor-id="working-with-datatime-data"><span class="header-section-number">8.1.4</span> Working with <code>datatime</code> Data</h3>
<section id="the-dt-accessor" class="level4" data-number="8.1.4.1">
<h4 data-number="8.1.4.1" class="anchored" data-anchor-id="the-dt-accessor"><span class="header-section-number">8.1.4.1</span> the <code>dt</code> accessor</h4>
<p>The <code>.dt</code> accessor is a powerful tool in pandas that allows you to extract and manipulate components of datetime columns in a DataFrame. This is useful for analysis and feature engineering when dealing with time-related data.</p>
<p>You can extract various parts of a datetime column using <code>.dt</code></p>
<table class="caption-top table">
<colgroup>
<col style="width: 17%">
<col style="width: 43%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Attribute</th>
<th>Description</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>.dt.year</code></td>
<td>Extracts the year</td>
<td><code>df['Release Date'].dt.year</code></td>
</tr>
<tr class="even">
<td><code>.dt.month</code></td>
<td>Extracts the month (1-12)</td>
<td><code>df['Release Date'].dt.month</code></td>
</tr>
<tr class="odd">
<td><code>.dt.day</code></td>
<td>Extracts the day of the month (1-31)</td>
<td><code>df['Release Date'].dt.day</code></td>
</tr>
<tr class="even">
<td><code>.dt.hour</code></td>
<td>Extracts the hour (0-23)</td>
<td><code>df['Release Date'].dt.hour</code></td>
</tr>
<tr class="odd">
<td><code>.dt.minute</code></td>
<td>Extracts the minute</td>
<td><code>df['Release Date'].dt.minute</code></td>
</tr>
<tr class="even">
<td><code>.dt.second</code></td>
<td>Extracts the second</td>
<td><code>df['Release Date'].dt.second</code></td>
</tr>
<tr class="odd">
<td><code>.dt.weekday</code></td>
<td>Extracts the day of the week (0=Monday, 6=Sunday)</td>
<td><code>df['Release Date'].dt.weekday</code></td>
</tr>
<tr class="even">
<td><code>.dt.dayofyear</code></td>
<td>Extracts the day of the year (1-366)</td>
<td><code>df['Release Date'].dt.dayofyear</code></td>
</tr>
<tr class="odd">
<td><code>.dt.is_leap_year</code></td>
<td>Checks if the year is a leap year</td>
<td><code>df['Release Date'].dt.is_leap_year</code></td>
</tr>
</tbody>
</table>
<p>Let’s add the year for the movie_ratings dataframe next</p>
<div id="cell-16" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting the year from the release date</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Release Year'</span>] <span class="op">=</span> movie_ratings[<span class="st">'Release Date'</span>].dt.year</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="18">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">US Gross</th>
<th data-quarto-table-cell-role="th">Worldwide Gross</th>
<th data-quarto-table-cell-role="th">Production Budget</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">MPAA Rating</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Major Genre</th>
<th data-quarto-table-cell-role="th">Creative Type</th>
<th data-quarto-table-cell-role="th">IMDB Rating</th>
<th data-quarto-table-cell-role="th">IMDB Votes</th>
<th data-quarto-table-cell-role="th">Release Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Opal Dreams</td>
<td>14443</td>
<td>14443</td>
<td>9000000</td>
<td>2006-11-22</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
<td>6.5</td>
<td>468</td>
<td>2006</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Major Dundee</td>
<td>14873</td>
<td>14873</td>
<td>3800000</td>
<td>1965-04-07</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Western/Musical</td>
<td>Fiction</td>
<td>6.7</td>
<td>2588</td>
<td>1965</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>The Informers</td>
<td>315000</td>
<td>315000</td>
<td>18000000</td>
<td>2009-04-24</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Horror/Thriller</td>
<td>Fiction</td>
<td>5.2</td>
<td>7595</td>
<td>2009</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Buffalo Soldiers</td>
<td>353743</td>
<td>353743</td>
<td>15000000</td>
<td>2003-07-25</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Comedy</td>
<td>Fiction</td>
<td>6.9</td>
<td>13510</td>
<td>2003</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>The Last Sin Eater</td>
<td>388390</td>
<td>388390</td>
<td>2200000</td>
<td>2007-02-09</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
<td>5.7</td>
<td>1012</td>
<td>2007</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In your pandas dataframe, if having start date and end date, your can calculate the time duration between them like below</p>
<div id="cell-18" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let's calculate the days since release till Jan 1st 2024</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>movie_ratings[<span class="st">'Days Since Release'</span>] <span class="op">=</span> (pd.Timestamp(<span class="st">'2024-01-01'</span>) <span class="op">-</span> movie_ratings[<span class="st">'Release Date'</span>]).dt.days</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>movie_ratings.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">US Gross</th>
<th data-quarto-table-cell-role="th">Worldwide Gross</th>
<th data-quarto-table-cell-role="th">Production Budget</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">MPAA Rating</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Major Genre</th>
<th data-quarto-table-cell-role="th">Creative Type</th>
<th data-quarto-table-cell-role="th">IMDB Rating</th>
<th data-quarto-table-cell-role="th">IMDB Votes</th>
<th data-quarto-table-cell-role="th">Days Since Release</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Opal Dreams</td>
<td>14443</td>
<td>14443</td>
<td>9000000</td>
<td>2006-11-22</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
<td>6.5</td>
<td>468</td>
<td>6249</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Major Dundee</td>
<td>14873</td>
<td>14873</td>
<td>3800000</td>
<td>1965-04-07</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Western/Musical</td>
<td>Fiction</td>
<td>6.7</td>
<td>2588</td>
<td>21453</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>The Informers</td>
<td>315000</td>
<td>315000</td>
<td>18000000</td>
<td>2009-04-24</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Horror/Thriller</td>
<td>Fiction</td>
<td>5.2</td>
<td>7595</td>
<td>5365</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Buffalo Soldiers</td>
<td>353743</td>
<td>353743</td>
<td>15000000</td>
<td>2003-07-25</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Comedy</td>
<td>Fiction</td>
<td>6.9</td>
<td>13510</td>
<td>7465</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>The Last Sin Eater</td>
<td>388390</td>
<td>388390</td>
<td>2200000</td>
<td>2007-02-09</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
<td>5.7</td>
<td>1012</td>
<td>6170</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Filtering Data</strong>: Use extracted datetime components to filter rows. Aggregation and grouping using datetime components will be covered in future chapters.</p>
<div id="cell-20" class="cell" data-execution_count="21">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where the release month is January</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>january_releases <span class="op">=</span> movie_ratings[movie_ratings[<span class="st">'Release Date'</span>].dt.month <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>january_releases.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="21">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">US Gross</th>
<th data-quarto-table-cell-role="th">Worldwide Gross</th>
<th data-quarto-table-cell-role="th">Production Budget</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">MPAA Rating</th>
<th data-quarto-table-cell-role="th">Source</th>
<th data-quarto-table-cell-role="th">Major Genre</th>
<th data-quarto-table-cell-role="th">Creative Type</th>
<th data-quarto-table-cell-role="th">IMDB Rating</th>
<th data-quarto-table-cell-role="th">IMDB Votes</th>
<th data-quarto-table-cell-role="th">Release Year</th>
<th data-quarto-table-cell-role="th">Days Since Release</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>Thr3e</td>
<td>1008849</td>
<td>1060418</td>
<td>2400000</td>
<td>2007-01-05</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Horror/Thriller</td>
<td>Fiction</td>
<td>5.0</td>
<td>2825</td>
<td>2007</td>
<td>6205</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">57</td>
<td>Impostor</td>
<td>6114237</td>
<td>6114237</td>
<td>40000000</td>
<td>2002-01-04</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Horror/Thriller</td>
<td>Fiction</td>
<td>6.0</td>
<td>9020</td>
<td>2002</td>
<td>8032</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">62</td>
<td>The Last Station</td>
<td>6616974</td>
<td>6616974</td>
<td>18000000</td>
<td>2010-01-15</td>
<td>R</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Non-Fiction</td>
<td>7.0</td>
<td>3465</td>
<td>2010</td>
<td>5099</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">63</td>
<td>The Big Bounce</td>
<td>6471394</td>
<td>6626115</td>
<td>50000000</td>
<td>2004-01-30</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Comedy</td>
<td>Fiction</td>
<td>4.8</td>
<td>9195</td>
<td>2004</td>
<td>7276</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">84</td>
<td>Not Easily Broken</td>
<td>10572742</td>
<td>10572742</td>
<td>5000000</td>
<td>2009-01-09</td>
<td>PG/PG-13</td>
<td>Adapted screenplay</td>
<td>Drama</td>
<td>Fiction</td>
<td>5.2</td>
<td>1010</td>
<td>2009</td>
<td>5470</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="working-with-object-data" class="level3" data-number="8.1.5">
<h3 data-number="8.1.5" class="anchored" data-anchor-id="working-with-object-data"><span class="header-section-number">8.1.5</span> Working with <code>object</code> Data</h3>
<p>In pandas, the <code>object</code> data type is a flexible data type that can store a mix of text (strings), mixed types, or arbitrary Python objects. It is commonly used for string data and is a key part of working with categorical or unstructured data in pandas.</p>
<p>Similar to datetime objects having a <code>dt</code> accessor, a number of specialized string methods are available when using the <code>str</code> accessor. These methods have in general matching names with the equivalent built-in string methods for single elements, but are applied element-wise on each of the values of the columns.</p>
<section id="the-str-accessor-in-pandas" class="level4" data-number="8.1.5.1">
<h4 data-number="8.1.5.1" class="anchored" data-anchor-id="the-str-accessor-in-pandas"><span class="header-section-number">8.1.5.1</span> the <code>str</code> accessor in pandas</h4>
<p>The <code>str</code> accessor in pandas provides a wide range of string methods that allow for efficient and convenient text processing on an entire Series of strings. Here are some commonly used str methods:</p>
<ul>
<li>String splitting: <code>str.split()</code></li>
<li>String joining: <code>str.join()</code></li>
<li>Substrings: <code>str.slice(start, stop)</code>, <code>str[0]</code></li>
<li>String Case Conversion: <code>str.lower()</code>, <code>str.upper()</code>, <code>str.capitalize()</code></li>
<li>Whitespace Removal: <code>str.strip()</code>, <code>str.lstrip()</code>, <code>str.rstrip()</code></li>
<li>Replacing and Removing: <code>str.replace('old', 'new')</code></li>
<li>Pattern matching and extraction: <code>str.contains('pattern')</code>, <code>startswith('prefix')</code>, <code>endswith('suffix')</code></li>
<li>String length and counting: <code>str.len()</code>, <code>str.count()</code></li>
</ul>
<p>Let’s use the well-known titanic dataset to illustrate how to manipulate string columns in pandas dataframe next</p>
<div id="cell-22" class="cell" data-execution_count="25">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/titanic.csv'</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>titanic.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-23" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>titanic.Name</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>0                                Braund, Mr. Owen Harris
1      Cumings, Mrs. John Bradley (Florence Briggs Th...
2                                 Heikkinen, Miss. Laina
3           Futrelle, Mrs. Jacques Heath (Lily May Peel)
4                               Allen, Mr. William Henry
                             ...                        
886                                Montvila, Rev. Juozas
887                         Graham, Miss. Margaret Edith
888             Johnston, Miss. Catherine Helen "Carrie"
889                                Behr, Mr. Karl Howell
890                                  Dooley, Mr. Patrick
Name: Name, Length: 891, dtype: object</code></pre>
</div>
</div>
<p>The <code>Name</code> column varies in length and contains passengers’ last names, titles, and first names. By extracting the title from the <code>Name</code> column, we could infer the <strong>sex</strong> of the passenger and add it as a new feature. This could potentially be a significant predictor of survival, as the “ladies first” principle was often applied during the Titanic evacuation. Adding this feature may enhance the model’s ability to predict whether a passenger survived.</p>
<div id="cell-25" class="cell" data-execution_count="27">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's check the length of the name of each passenger</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">"Name"</span>].<span class="bu">str</span>.<span class="bu">len</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="27">
<pre><code>0      23
1      51
2      22
3      44
4      24
       ..
886    21
887    28
888    40
889    21
890    19
Name: Name, Length: 891, dtype: int64</code></pre>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check what is the maximum length of the name</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>titanic.loc[titanic[<span class="st">"Name"</span>].<span class="bu">str</span>.<span class="bu">len</span>().idxmax(), <span class="st">"Name"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>'Penasco y Castellana, Mrs. Victor de Satode (Maria Josefa Perez de Soto y Vallejo)'</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="29">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the observations that contains the word 'Mrs'</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>titanic[titanic.Name.<span class="bu">str</span>.contains(<span class="st">'Mrs.'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">8</td>
<td>9</td>
<td>1</td>
<td>3</td>
<td>Johnson, Mrs. Oscar W (Elisabeth Vilhelmina Berg)</td>
<td>27.0</td>
<td>0</td>
<td>2</td>
<td>347742</td>
<td>11.1333</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">9</td>
<td>10</td>
<td>1</td>
<td>2</td>
<td>Nasser, Mrs. Nicholas (Adele Achem)</td>
<td>14.0</td>
<td>1</td>
<td>0</td>
<td>237736</td>
<td>30.0708</td>
<td>NaN</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15</td>
<td>16</td>
<td>1</td>
<td>2</td>
<td>Hewlett, Mrs. (Mary D Kingcome)</td>
<td>55.0</td>
<td>0</td>
<td>0</td>
<td>248706</td>
<td>16.0000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">871</td>
<td>872</td>
<td>1</td>
<td>1</td>
<td>Beckwith, Mrs. Richard Leonard (Sallie Monypeny)</td>
<td>47.0</td>
<td>1</td>
<td>1</td>
<td>11751</td>
<td>52.5542</td>
<td>D35</td>
<td>S</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">874</td>
<td>875</td>
<td>1</td>
<td>2</td>
<td>Abelson, Mrs. Samuel (Hannah Wizosky)</td>
<td>28.0</td>
<td>1</td>
<td>0</td>
<td>P/PP 3381</td>
<td>24.0000</td>
<td>NaN</td>
<td>C</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">879</td>
<td>880</td>
<td>1</td>
<td>1</td>
<td>Potter, Mrs. Thomas Jr (Lily Alexenia Wilson)</td>
<td>56.0</td>
<td>0</td>
<td>1</td>
<td>11767</td>
<td>83.1583</td>
<td>C50</td>
<td>C</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">880</td>
<td>881</td>
<td>1</td>
<td>2</td>
<td>Shelley, Mrs. William (Imanita Parrish Hall)</td>
<td>25.0</td>
<td>0</td>
<td>1</td>
<td>230433</td>
<td>26.0000</td>
<td>NaN</td>
<td>S</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">885</td>
<td>886</td>
<td>0</td>
<td>3</td>
<td>Rice, Mrs. William (Margaret Norton)</td>
<td>39.0</td>
<td>0</td>
<td>5</td>
<td>382652</td>
<td>29.1250</td>
<td>NaN</td>
<td>Q</td>
</tr>
</tbody>
</table>

<p>129 rows × 11 columns</p>
</div>
</div>
</div>
<div id="cell-28" class="cell" data-execution_count="30">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the observations that contains the word 'Mrs'</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>titanic.Name.<span class="bu">str</span>.count(<span class="st">'Mrs.'</span>).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>129</code></pre>
</div>
</div>
<div id="cell-29" class="cell" data-execution_count="32">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># split the name column into two columns</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>titanic.Name.<span class="bu">str</span>.split(<span class="st">','</span>, expand<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Braund</td>
<td>Mr. Owen Harris</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Cumings</td>
<td>Mrs. John Bradley (Florence Briggs Thayer)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Heikkinen</td>
<td>Miss. Laina</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Futrelle</td>
<td>Mrs. Jacques Heath (Lily May Peel)</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Allen</td>
<td>Mr. William Henry</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">886</td>
<td>Montvila</td>
<td>Rev. Juozas</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">887</td>
<td>Graham</td>
<td>Miss. Margaret Edith</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">888</td>
<td>Johnston</td>
<td>Miss. Catherine Helen "Carrie"</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">889</td>
<td>Behr</td>
<td>Mr. Karl Howell</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">890</td>
<td>Dooley</td>
<td>Mr. Patrick</td>
</tr>
</tbody>
</table>

<p>891 rows × 2 columns</p>
</div>
</div>
</div>
<div id="cell-30" class="cell" data-execution_count="33">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the last part of the split</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>titanic.Name.<span class="bu">str</span>.split(<span class="st">','</span>, expand<span class="op">=</span><span class="va">True</span>).get(<span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>0                                  Mr. Owen Harris
1       Mrs. John Bradley (Florence Briggs Thayer)
2                                      Miss. Laina
3               Mrs. Jacques Heath (Lily May Peel)
4                                Mr. William Henry
                          ...                     
886                                    Rev. Juozas
887                           Miss. Margaret Edith
888                 Miss. Catherine Helen "Carrie"
889                                Mr. Karl Howell
890                                    Mr. Patrick
Name: 1, Length: 891, dtype: object</code></pre>
</div>
</div>
<p>Create a new column <code>Title</code> that contains the title of the passengers</p>
<div id="cell-32" class="cell" data-execution_count="34">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># from the name, extract the title</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">'Title'</span>] <span class="op">=</span> titanic.Name.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.split(<span class="st">','</span>)[<span class="dv">1</span>].split(<span class="st">'.'</span>)[<span class="dv">0</span>].strip())</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">'Title'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>0        Mr
1       Mrs
2      Miss
3       Mrs
4        Mr
       ... 
886     Rev
887    Miss
888    Miss
889      Mr
890      Mr
Name: Title, Length: 891, dtype: object</code></pre>
</div>
</div>
<div id="cell-33" class="cell" data-execution_count="35">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the unique titles</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>titanic.Title.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array(['Mr', 'Mrs', 'Miss', 'Master', 'Don', 'Rev', 'Dr', 'Mme', 'Ms',
       'Major', 'Lady', 'Sir', 'Mlle', 'Col', 'Capt', 'the Countess',
       'Jonkheer'], dtype=object)</code></pre>
</div>
</div>
<p>Let’s create a mapping dictionary next</p>
<div id="cell-35" class="cell" data-execution_count="36">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>title_sex_mapping <span class="op">=</span> {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mr'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mrs'</span>: <span class="st">'Female'</span>,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Miss'</span>: <span class="st">'Female'</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Master'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Don'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Rev'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Dr'</span>: <span class="st">'Male'</span>,  <span class="co"># Assumed to be Male unless you have additional context</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mme'</span>: <span class="st">'Female'</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Ms'</span>: <span class="st">'Female'</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Major'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Lady'</span>: <span class="st">'Female'</span>,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Sir'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Mlle'</span>: <span class="st">'Female'</span>,</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Col'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Capt'</span>: <span class="st">'Male'</span>,</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">'the Countess'</span>: <span class="st">'Female'</span>,</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    <span class="st">'Jonkheer'</span>: <span class="st">'Male'</span></span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-36" class="cell" data-execution_count="38">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>titanic[<span class="st">'Sex'</span>] <span class="op">=</span> titanic[<span class="st">'Title'</span>].<span class="bu">map</span>(title_sex_mapping)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>titanic.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">PassengerId</th>
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th">Pclass</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Age</th>
<th data-quarto-table-cell-role="th">SibSp</th>
<th data-quarto-table-cell-role="th">Parch</th>
<th data-quarto-table-cell-role="th">Ticket</th>
<th data-quarto-table-cell-role="th">Fare</th>
<th data-quarto-table-cell-role="th">Cabin</th>
<th data-quarto-table-cell-role="th">Embarked</th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">Sex</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>0</td>
<td>3</td>
<td>Braund, Mr. Owen Harris</td>
<td>22.0</td>
<td>1</td>
<td>0</td>
<td>A/5 21171</td>
<td>7.2500</td>
<td>NaN</td>
<td>S</td>
<td>Mr</td>
<td>Male</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>Cumings, Mrs. John Bradley (Florence Briggs Th...</td>
<td>38.0</td>
<td>1</td>
<td>0</td>
<td>PC 17599</td>
<td>71.2833</td>
<td>C85</td>
<td>C</td>
<td>Mrs</td>
<td>Female</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>1</td>
<td>3</td>
<td>Heikkinen, Miss. Laina</td>
<td>26.0</td>
<td>0</td>
<td>0</td>
<td>STON/O2. 3101282</td>
<td>7.9250</td>
<td>NaN</td>
<td>S</td>
<td>Miss</td>
<td>Female</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>1</td>
<td>1</td>
<td>Futrelle, Mrs. Jacques Heath (Lily May Peel)</td>
<td>35.0</td>
<td>1</td>
<td>0</td>
<td>113803</td>
<td>53.1000</td>
<td>C123</td>
<td>S</td>
<td>Mrs</td>
<td>Female</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>0</td>
<td>3</td>
<td>Allen, Mr. William Henry</td>
<td>35.0</td>
<td>0</td>
<td>0</td>
<td>373450</td>
<td>8.0500</td>
<td>NaN</td>
<td>S</td>
<td>Mr</td>
<td>Male</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-37" class="cell" data-execution_count="39">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>titanic.Sex.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>Sex
Male      578
Female    313
Name: count, dtype: int64</code></pre>
</div>
</div>
<div id="cell-38" class="cell" data-execution_count="40">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cross tabulation</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>pd.crosstab(titanic.Survived, titanic.Sex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Sex</th>
<th data-quarto-table-cell-role="th">Female</th>
<th data-quarto-table-cell-role="th">Male</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Survived</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>81</td>
<td>468</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>232</td>
<td>110</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>In the Titanic disaster, more women survived than men due to the social norms and evacuation protocols followed during the sinking. The principle of “women and children first” was enforced when lifeboats were being loaded. Since there were not enough lifeboats for everyone on board, priority was given to women and children, which contributed to the higher survival rate among females compared to males.</p>
</section>
<section id="the-re-module-in-python-is-used-for-regular-expression" class="level4" data-number="8.1.5.2">
<h4 data-number="8.1.5.2" class="anchored" data-anchor-id="the-re-module-in-python-is-used-for-regular-expression"><span class="header-section-number">8.1.5.2</span> the <code>re</code> module in Python is used for regular expression</h4>
<p>The <code>re</code> module in Python is used for <strong>regular expressions</strong>, which are powerful tools for text analysis and manipulation. Regular expressions allow you to search, match, and manipulate strings based on specific patterns.</p>
<p>Common Use Cases of <code>re</code> in String Text Analysis</p>
<ul>
<li>Finding patterns in text: <code>re.search(r'\d{4}-\d{2}-\d{2}', text)</code> # searches for a date in the format YYYY-MM-DD</li>
<li>Extracting Specific parts of a string: <code>re.findall(r'\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b', text)</code> #extracts email addresses from the text.</li>
<li>Replacing Parts of a String: <code>re.sub(r'\$\d+', '[price]', text)</code> #replacing any price formatted as $<number> with [price].</number></li>
</ul>
<section id="commonly-used-patterns-in-re" class="level5" data-number="8.1.5.2.1">
<h5 data-number="8.1.5.2.1" class="anchored" data-anchor-id="commonly-used-patterns-in-re"><span class="header-section-number">8.1.5.2.1</span> Commonly Used Patterns in <code>re</code></h5>
<ul>
<li><strong><code>\d</code></strong>: Matches any digit (0-9).</li>
<li><strong><code>\w</code></strong>: Matches any alphanumeric character (letters and numbers).</li>
<li><strong><code>\s</code></strong>: Matches any whitespace character (spaces, tabs, newlines).</li>
<li><strong><code>[a-z]</code></strong>: Matches any lowercase letter from <code>a</code> to <code>z</code>.</li>
<li><strong><code>[A-Z]</code></strong>: Matches any uppercase letter from <code>A</code> to <code>Z</code>.</li>
<li><strong><code>*</code></strong>: Matches 0 or more occurrences of the preceding character.</li>
<li><strong><code>+</code></strong>: Matches 1 or more occurrences of the preceding character.</li>
<li><strong><code>?</code></strong>: Matches 0 or 1 occurrence of the preceding character.</li>
<li><strong><code>^</code></strong>: Matches the beginning of a string.</li>
<li><strong><code>$</code></strong>: Matches the end of a string.</li>
<li><strong><code>|</code></strong>: Acts as an OR operator.</li>
</ul>
<div id="cell-41" class="cell" data-execution_count="41">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_html(<span class="st">'https://en.wikipedia.org/wiki/List_of_Chicago_Bulls_seasons'</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>ChicagoBulls <span class="op">=</span> data[<span class="dv">2</span>]</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>ChicagoBulls.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">Team</th>
<th data-quarto-table-cell-role="th">Conference</th>
<th data-quarto-table-cell-role="th">Finish</th>
<th data-quarto-table-cell-role="th">Division</th>
<th data-quarto-table-cell-role="th">Finish.1</th>
<th data-quarto-table-cell-role="th">Wins</th>
<th data-quarto-table-cell-role="th">Losses</th>
<th data-quarto-table-cell-role="th">Win%</th>
<th data-quarto-table-cell-role="th">GB</th>
<th data-quarto-table-cell-role="th">Playoffs</th>
<th data-quarto-table-cell-role="th">Awards</th>
<th data-quarto-table-cell-role="th">Head coach</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1966–67</td>
<td>1966–67</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>4th</td>
<td>33</td>
<td>48</td>
<td>0.407</td>
<td>11</td>
<td>Lost Division semifinals (Hawks) 3–0[19]</td>
<td>Johnny Kerr (COY)[6]</td>
<td>Johnny Kerr</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1967–68</td>
<td>1967–68</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>4th</td>
<td>29</td>
<td>53</td>
<td>0.354</td>
<td>27</td>
<td>Lost Division semifinals (Lakers) 4–1[20]</td>
<td>—</td>
<td>Johnny Kerr</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1968–69</td>
<td>1968–69</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>5th</td>
<td>33</td>
<td>49</td>
<td>0.402</td>
<td>22</td>
<td>NaN</td>
<td>—</td>
<td>Dick Motta</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1969–70</td>
<td>1969–70</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>3rd[c]</td>
<td>39</td>
<td>43</td>
<td>0.476</td>
<td>9</td>
<td>Lost Division semifinals (Hawks) 4–1[22]</td>
<td>—</td>
<td>Dick Motta</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1970–71</td>
<td>1970–71</td>
<td>Western</td>
<td>3rd</td>
<td>Midwest[d]</td>
<td>2nd</td>
<td>51</td>
<td>31</td>
<td>0.622</td>
<td>2</td>
<td>Lost conference semifinals (Lakers) 4–3[23]</td>
<td>Dick Motta (COY)[6]</td>
<td>Dick Motta</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-42" class="cell" data-execution_count="42">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove all charaters between box brackets inluding the brackets themselves in the columns Division, Finish, Playoffs, Awards</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_brackets(x):</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> re.sub(<span class="vs">r'\[.*?\]'</span>, <span class="st">''</span>, x)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function to each column separately using map</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>ChicagoBulls[<span class="st">'Division'</span>] <span class="op">=</span> ChicagoBulls[<span class="st">'Division'</span>].<span class="bu">map</span>(remove_brackets)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>ChicagoBulls[<span class="st">'Finish'</span>] <span class="op">=</span> ChicagoBulls[<span class="st">'Finish'</span>].<span class="bu">map</span>(remove_brackets)</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>ChicagoBulls[<span class="st">'Finish.1'</span>] <span class="op">=</span> ChicagoBulls[<span class="st">'Finish.1'</span>].<span class="bu">map</span>(remove_brackets)</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>ChicagoBulls.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Season</th>
<th data-quarto-table-cell-role="th">Team</th>
<th data-quarto-table-cell-role="th">Conference</th>
<th data-quarto-table-cell-role="th">Finish</th>
<th data-quarto-table-cell-role="th">Division</th>
<th data-quarto-table-cell-role="th">Finish.1</th>
<th data-quarto-table-cell-role="th">Wins</th>
<th data-quarto-table-cell-role="th">Losses</th>
<th data-quarto-table-cell-role="th">Win%</th>
<th data-quarto-table-cell-role="th">GB</th>
<th data-quarto-table-cell-role="th">Playoffs</th>
<th data-quarto-table-cell-role="th">Awards</th>
<th data-quarto-table-cell-role="th">Head coach</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1966–67</td>
<td>1966–67</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>4th</td>
<td>33</td>
<td>48</td>
<td>0.407</td>
<td>11</td>
<td>Lost Division semifinals (Hawks) 3–0[19]</td>
<td>Johnny Kerr (COY)[6]</td>
<td>Johnny Kerr</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1967–68</td>
<td>1967–68</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>4th</td>
<td>29</td>
<td>53</td>
<td>0.354</td>
<td>27</td>
<td>Lost Division semifinals (Lakers) 4–1[20]</td>
<td>—</td>
<td>Johnny Kerr</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1968–69</td>
<td>1968–69</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>5th</td>
<td>33</td>
<td>49</td>
<td>0.402</td>
<td>22</td>
<td>NaN</td>
<td>—</td>
<td>Dick Motta</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1969–70</td>
<td>1969–70</td>
<td>—</td>
<td>—</td>
<td>Western</td>
<td>3rd</td>
<td>39</td>
<td>43</td>
<td>0.476</td>
<td>9</td>
<td>Lost Division semifinals (Hawks) 4–1[22]</td>
<td>—</td>
<td>Dick Motta</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1970–71</td>
<td>1970–71</td>
<td>Western</td>
<td>3rd</td>
<td>Midwest</td>
<td>2nd</td>
<td>51</td>
<td>31</td>
<td>0.622</td>
<td>2</td>
<td>Lost conference semifinals (Lakers) 4–3[23]</td>
<td>Dick Motta (COY)[6]</td>
<td>Dick Motta</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Another example</p>
<div id="cell-44" class="cell" data-execution_count="43">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>gdp_data <span class="op">=</span> pd.read_html(<span class="st">"https://en.wikipedia.org/wiki/List_of_countries_by_GDP_(nominal)_per_capita"</span>)[<span class="dv">1</span>]</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>gdp_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="43">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country/Territory</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">IMF[4][5]</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">World Bank[6]</th>
<th colspan="2" data-quarto-table-cell-role="th" data-halign="left">United Nations[7]</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country/Territory</th>
<th data-quarto-table-cell-role="th">Estimate</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Estimate</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Estimate</th>
<th data-quarto-table-cell-role="th">Year</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Monaco</td>
<td>—</td>
<td>—</td>
<td>240862</td>
<td>2022</td>
<td>240535</td>
<td>2022</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Liechtenstein</td>
<td>—</td>
<td>—</td>
<td>187267</td>
<td>2022</td>
<td>197268</td>
<td>2022</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Luxembourg</td>
<td>135321</td>
<td>2024</td>
<td>128259</td>
<td>2023</td>
<td>125897</td>
<td>2022</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Bermuda</td>
<td>—</td>
<td>—</td>
<td>123091</td>
<td>2022</td>
<td>117568</td>
<td>2022</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Switzerland</td>
<td>106098</td>
<td>2024</td>
<td>99995</td>
<td>2023</td>
<td>93636</td>
<td>2022</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-45" class="cell" data-execution_count="45">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the year column</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>gdp_data.drop(columns<span class="op">=</span>[<span class="st">"Year"</span>], level<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the level 1 column</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>gdp_data <span class="op">=</span> gdp_data.droplevel(<span class="dv">1</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="cell-46" class="cell" data-execution_count="46">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>column_name_cleaner <span class="op">=</span> <span class="kw">lambda</span> x:re.split(<span class="vs">r'\['</span>, x)[<span class="dv">0</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>gdp_data.columns <span class="op">=</span> gdp_data.columns.<span class="bu">map</span>(column_name_cleaner)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>gdp_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Country/Territory</th>
<th data-quarto-table-cell-role="th">IMF</th>
<th data-quarto-table-cell-role="th">World Bank</th>
<th data-quarto-table-cell-role="th">United Nations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Monaco</td>
<td>—</td>
<td>240862</td>
<td>240535</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Liechtenstein</td>
<td>—</td>
<td>187267</td>
<td>197268</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Luxembourg</td>
<td>135321</td>
<td>128259</td>
<td>125897</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Bermuda</td>
<td>—</td>
<td>123091</td>
<td>117568</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Switzerland</td>
<td>106098</td>
<td>99995</td>
<td>93636</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="the-nltk-library-for-nlp-skipped" class="level4" data-number="8.1.5.3">
<h4 data-number="8.1.5.3" class="anchored" data-anchor-id="the-nltk-library-for-nlp-skipped"><span class="header-section-number">8.1.5.3</span> the <code>NLTK</code> Library for NLP (skipped)</h4>
<p>NLTK (Natural Language Toolkit) is a popular Python library for natural language processing (NLP) and text analysis. It provides a wide range of tools and resources for processing and analyzing human language data. NLTK is widely used in research, education, and industry for various text analysis tasks.</p>
<section id="key-features-and-capabilities-of-nltk" class="level5" data-number="8.1.5.3.1">
<h5 data-number="8.1.5.3.1" class="anchored" data-anchor-id="key-features-and-capabilities-of-nltk"><span class="header-section-number">8.1.5.3.1</span> Key Features and Capabilities of NLTK</h5>
<ul>
<li><strong>Tokenization</strong>: Splits text into individual words (word tokenization) or sentences (sentence tokenization).</li>
<li><strong>Stop Word Removal</strong>: Provides lists of common words (like “and”, “the”, “is”) in various languages that can be removed from text to reduce noise.</li>
<li><strong>Stemming</strong>: Reduces words to their root form (e.g., “running” to “run”).</li>
<li><strong>Lemmatization</strong>: Similar to stemming, but more sophisticated. It reduces words to their dictionary form using vocabulary and morphological analysis (e.g., “better” to “good”).</li>
</ul>
</section>
</section>
</section>
<section id="working-with-numerical-data" class="level3" data-number="8.1.6">
<h3 data-number="8.1.6" class="anchored" data-anchor-id="working-with-numerical-data"><span class="header-section-number">8.1.6</span> Working with <code>numerical</code> Data</h3>
<section id="summary-statistics-across-rowscolumns-in-pandas" class="level4" data-number="8.1.6.1">
<h4 data-number="8.1.6.1" class="anchored" data-anchor-id="summary-statistics-across-rowscolumns-in-pandas"><span class="header-section-number">8.1.6.1</span> Summary statistics across rows/columns in Pandas</h4>
<p>The Pandas DataFrame class has functions such as <code>sum()</code> and <code>mean()</code> to compute sum over rows or columns of a DataFrame.</p>
<p>By default, functions like <code>mean()</code> and <code>sum()</code> compute the statistics for each column (i.e., all rows are aggregated) in the DataFrame. Let us compute the mean of all the numeric columns of the data:</p>
<div id="cell-49" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>movie_ratings.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">US Gross</th>
<th data-quarto-table-cell-role="th">Worldwide Gross</th>
<th data-quarto-table-cell-role="th">Production Budget</th>
<th data-quarto-table-cell-role="th">IMDB Rating</th>
<th data-quarto-table-cell-role="th">IMDB Votes</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>2.228000e+03</td>
<td>2.228000e+03</td>
<td>2.228000e+03</td>
<td>2228.000000</td>
<td>2228.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>5.076370e+07</td>
<td>1.019370e+08</td>
<td>3.816055e+07</td>
<td>6.239004</td>
<td>33585.154847</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>6.643081e+07</td>
<td>1.648589e+08</td>
<td>3.782604e+07</td>
<td>1.243285</td>
<td>47325.651561</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000e+00</td>
<td>8.840000e+02</td>
<td>2.180000e+02</td>
<td>1.400000</td>
<td>18.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>9.646188e+06</td>
<td>1.320737e+07</td>
<td>1.200000e+07</td>
<td>5.500000</td>
<td>6659.250000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>2.838649e+07</td>
<td>4.266892e+07</td>
<td>2.600000e+07</td>
<td>6.400000</td>
<td>18169.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>6.453140e+07</td>
<td>1.200000e+08</td>
<td>5.300000e+07</td>
<td>7.100000</td>
<td>40092.750000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>7.601676e+08</td>
<td>2.767891e+09</td>
<td>3.000000e+08</td>
<td>9.200000</td>
<td>519541.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-50" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select the numeric columns</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>movie_ratings.mean(numeric_only<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>US Gross                  5.076370e+07
Worldwide Gross           1.019370e+08
Production Budget         3.816055e+07
IMDB Rating               6.239004e+00
IMDB Votes                3.358515e+04
Release Year              2.002005e+03
ratio_wgross_by_budget    1.259483e+01
dtype: float64</code></pre>
</div>
</div>
<p><strong>Using the <code>axis</code> parameter</strong>:</p>
<p>The <code>axis</code> parameter controls whether to compute the statistic across rows or columns: * The argument <code>axis=0</code>(deafult) denotes that the mean is taken over all the rows of the DataFrame. * For computing a statistic across column the argument <code>axis=1</code> will be used.</p>
<p>If mean over a subset of columns is desired, then those column names can be subset from the data.</p>
<p>For example, let us compute the mean IMDB rating, and mean IMDB votes of all the movies:</p>
<div id="cell-52" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>movie_ratings[[<span class="st">'IMDB Rating'</span>,<span class="st">'IMDB Votes'</span>]].mean(axis <span class="op">=</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>IMDB Rating        6.239004
IMDB Votes     33585.154847
dtype: float64</code></pre>
</div>
</div>
<p><strong>Pandas <code>sum</code> function</strong></p>
<div id="cell-54" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> [[<span class="dv">10</span>, <span class="dv">18</span>, <span class="dv">11</span>], [<span class="dv">13</span>, <span class="dv">15</span>, <span class="dv">8</span>], [<span class="dv">9</span>, <span class="dv">20</span>, <span class="dv">3</span>]]</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data )</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">0</th>
<th data-quarto-table-cell-role="th">1</th>
<th data-quarto-table-cell-role="th">2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10</td>
<td>18</td>
<td>11</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>13</td>
<td>15</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>20</td>
<td>3</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-55" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By default, the sum method adds values accross rows and returns the sum for each column</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>0    32
1    53
2    22
dtype: int64</code></pre>
</div>
</div>
<div id="cell-56" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># By specifying the column axis (axis='columns'), the sum() method add values accross columns and returns the sum of each row.</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="st">'columns'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>0    39
1    36
2    32
dtype: int64</code></pre>
</div>
</div>
<div id="cell-57" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in python, axis=1 stands for column, while axis=0 stands for rows</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>0    39
1    36
2    32
dtype: int64</code></pre>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./Pandas.html" class="pagination-link" aria-label="Pandas">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Data visualization.html" class="pagination-link" aria-label="Introduction to Data Visualization">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>