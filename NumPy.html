<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6&nbsp; NumPy – Data Science I with python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Pandas.html" rel="next">
<link href="./data_structures.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./NumPy.html">Core library foundations</a></li><li class="breadcrumb-item"><a href="./NumPy.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="https://statistics.northwestern.edu/" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science I with python</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vscode_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Setting up your environment with VS Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_venv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python Environments and Package Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow_enhance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Enhancing Workflow in Jupyter Notebooks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Python refresher</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data structures</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Core library foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Reading Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_types_in_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Advanced_Data_Visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">From messy to insight</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Grouping and Aggregation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Reshaping and Enrichment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Datasets &amp; Templates</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">6.1</span> Learning Objectives</a></li>
  <li><a href="#getting-started" id="toc-getting-started" class="nav-link" data-scroll-target="#getting-started"><span class="header-section-number">6.2</span> Getting Started</a></li>
  <li><a href="#data-types-in-numpy" id="toc-data-types-in-numpy" class="nav-link" data-scroll-target="#data-types-in-numpy"><span class="header-section-number">6.3</span> Data Types in NumPy</a>
  <ul>
  <li><a href="#upcasting" id="toc-upcasting" class="nav-link" data-scroll-target="#upcasting"><span class="header-section-number">6.3.1</span> Upcasting</a></li>
  </ul></li>
  <li><a href="#why-do-we-need-numpy-arrays" id="toc-why-do-we-need-numpy-arrays" class="nav-link" data-scroll-target="#why-do-we-need-numpy-arrays"><span class="header-section-number">6.4</span> Why do we need NumPy arrays?</a>
  <ul>
  <li><a href="#numpy-arrays-are-memory-efficient-homogeneity-and-contiguous-memory-storage" id="toc-numpy-arrays-are-memory-efficient-homogeneity-and-contiguous-memory-storage" class="nav-link" data-scroll-target="#numpy-arrays-are-memory-efficient-homogeneity-and-contiguous-memory-storage"><span class="header-section-number">6.4.1</span> Numpy arrays are memory efficient: Homogeneity and Contiguous Memory Storage</a></li>
  <li><a href="#numpy-arrays-are-fast" id="toc-numpy-arrays-are-fast" class="nav-link" data-scroll-target="#numpy-arrays-are-fast"><span class="header-section-number">6.4.2</span> NumPy arrays are fast</a></li>
  </ul></li>
  <li><a href="#basics-of-numpy-arrays" id="toc-basics-of-numpy-arrays" class="nav-link" data-scroll-target="#basics-of-numpy-arrays"><span class="header-section-number">6.5</span> Basics of NumPy Arrays</a>
  <ul>
  <li><a href="#creating-numpy-arrays" id="toc-creating-numpy-arrays" class="nav-link" data-scroll-target="#creating-numpy-arrays"><span class="header-section-number">6.5.1</span> Creating NumPy Arrays</a>
  <ul class="collapse">
  <li><a href="#creating-arrays-for-specific-use-cases" id="toc-creating-arrays-for-specific-use-cases" class="nav-link" data-scroll-target="#creating-arrays-for-specific-use-cases"><span class="header-section-number">6.5.1.1</span> Creating Arrays for specific use cases:</a></li>
  <li><a href="#loading-data-from-file-into-a-numpy-array" id="toc-loading-data-from-file-into-a-numpy-array" class="nav-link" data-scroll-target="#loading-data-from-file-into-a-numpy-array"><span class="header-section-number">6.5.1.2</span> Loading data from file into a NumPy array</a></li>
  </ul></li>
  <li><a href="#array-attributes" id="toc-array-attributes" class="nav-link" data-scroll-target="#array-attributes"><span class="header-section-number">6.5.2</span> Array Attributes:</a>
  <ul class="collapse">
  <li><a href="#ndim" id="toc-ndim" class="nav-link" data-scroll-target="#ndim"><span class="header-section-number">6.5.2.1</span> <code>ndim</code></a></li>
  <li><a href="#shape" id="toc-shape" class="nav-link" data-scroll-target="#shape"><span class="header-section-number">6.5.2.2</span> <code>shape</code></a></li>
  <li><a href="#size" id="toc-size" class="nav-link" data-scroll-target="#size"><span class="header-section-number">6.5.2.3</span> <code>size</code></a></li>
  <li><a href="#dtype" id="toc-dtype" class="nav-link" data-scroll-target="#dtype"><span class="header-section-number">6.5.2.4</span> <code>dtype</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#array-indexing-and-slicing" id="toc-array-indexing-and-slicing" class="nav-link" data-scroll-target="#array-indexing-and-slicing"><span class="header-section-number">6.6</span> Array Indexing and Slicing</a>
  <ul>
  <li><a href="#array-indexing" id="toc-array-indexing" class="nav-link" data-scroll-target="#array-indexing"><span class="header-section-number">6.6.1</span> Array Indexing</a></li>
  <li><a href="#array-slicing" id="toc-array-slicing" class="nav-link" data-scroll-target="#array-slicing"><span class="header-section-number">6.6.2</span> Array Slicing</a></li>
  <li><a href="#modify-sub-arrays-through-slicing" id="toc-modify-sub-arrays-through-slicing" class="nav-link" data-scroll-target="#modify-sub-arrays-through-slicing"><span class="header-section-number">6.6.3</span> Modify Sub-Arrays through Slicing</a></li>
  <li><a href="#combining-indexing-and-slicing" id="toc-combining-indexing-and-slicing" class="nav-link" data-scroll-target="#combining-indexing-and-slicing"><span class="header-section-number">6.6.4</span> Combining Indexing and Slicing</a></li>
  <li><a href="#np.where-and-np.select" id="toc-np.where-and-np.select" class="nav-link" data-scroll-target="#np.where-and-np.select"><span class="header-section-number">6.6.5</span> <code>np.where()</code> and <code>np.select()</code></a></li>
  <li><a href="#np.argmin-and-np.argmax" id="toc-np.argmin-and-np.argmax" class="nav-link" data-scroll-target="#np.argmin-and-np.argmax"><span class="header-section-number">6.6.6</span> <code>np.argmin()</code> and <code>np.argmax()</code></a></li>
  </ul></li>
  <li><a href="#array-operations" id="toc-array-operations" class="nav-link" data-scroll-target="#array-operations"><span class="header-section-number">6.7</span> Array Operations</a>
  <ul>
  <li><a href="#arithmetic-operations" id="toc-arithmetic-operations" class="nav-link" data-scroll-target="#arithmetic-operations"><span class="header-section-number">6.7.1</span> Arithmetic operations</a></li>
  <li><a href="#comparison-and-logical-operation" id="toc-comparison-and-logical-operation" class="nav-link" data-scroll-target="#comparison-and-logical-operation"><span class="header-section-number">6.7.2</span> Comparison and Logical Operation</a></li>
  <li><a href="#aggregate-functions-np.sum-np.mean-np.min-np.max" id="toc-aggregate-functions-np.sum-np.mean-np.min-np.max" class="nav-link" data-scroll-target="#aggregate-functions-np.sum-np.mean-np.min-np.max"><span class="header-section-number">6.7.3</span> Aggregate Functions: <code>np.sum()</code>, <code>np.mean()</code>, <code>np.min()</code>, <code>np.max()</code></a>
  <ul class="collapse">
  <li><a href="#overall-aggregate-calculations" id="toc-overall-aggregate-calculations" class="nav-link" data-scroll-target="#overall-aggregate-calculations"><span class="header-section-number">6.7.3.1</span> Overall Aggregate Calculations:</a></li>
  <li><a href="#row-wise-calculations-axis1" id="toc-row-wise-calculations-axis1" class="nav-link" data-scroll-target="#row-wise-calculations-axis1"><span class="header-section-number">6.7.3.2</span> Row-Wise Calculations (axis=1):</a></li>
  <li><a href="#column-wise-calculations-axis0" id="toc-column-wise-calculations-axis0" class="nav-link" data-scroll-target="#column-wise-calculations-axis0"><span class="header-section-number">6.7.3.3</span> Column-Wise Calculations (axis=0):</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#array-reshaping" id="toc-array-reshaping" class="nav-link" data-scroll-target="#array-reshaping"><span class="header-section-number">6.8</span> Array Reshaping</a>
  <ul>
  <li><a href="#reshape" id="toc-reshape" class="nav-link" data-scroll-target="#reshape"><span class="header-section-number">6.8.1</span> <code>reshape()</code></a></li>
  <li><a href="#flatten-and-ravel" id="toc-flatten-and-ravel" class="nav-link" data-scroll-target="#flatten-and-ravel"><span class="header-section-number">6.8.2</span> <code>flatten()</code> and <code>ravel()</code></a></li>
  <li><a href="#resize" id="toc-resize" class="nav-link" data-scroll-target="#resize"><span class="header-section-number">6.8.3</span> <code>resize()</code></a></li>
  <li><a href="#tranpose-or-t" id="toc-tranpose-or-t" class="nav-link" data-scroll-target="#tranpose-or-t"><span class="header-section-number">6.8.4</span> <code>tranpose()</code> or <code>T</code></a></li>
  </ul></li>
  <li><a href="#arrays-concaternating" id="toc-arrays-concaternating" class="nav-link" data-scroll-target="#arrays-concaternating"><span class="header-section-number">6.9</span> Arrays Concaternating</a>
  <ul>
  <li><a href="#np.concatenate" id="toc-np.concatenate" class="nav-link" data-scroll-target="#np.concatenate"><span class="header-section-number">6.9.1</span> <code>np.concatenate()</code></a></li>
  <li><a href="#np.vstack-and-np.hstack" id="toc-np.vstack-and-np.hstack" class="nav-link" data-scroll-target="#np.vstack-and-np.hstack"><span class="header-section-number">6.9.2</span> <code>np.vstack()</code> and <code>np.hstack()</code></a></li>
  </ul></li>
  <li><a href="#vectorization-in-numpy" id="toc-vectorization-in-numpy" class="nav-link" data-scroll-target="#vectorization-in-numpy"><span class="header-section-number">6.10</span> Vectorization in NumPy</a>
  <ul>
  <li><a href="#introduction-to-vectorization" id="toc-introduction-to-vectorization" class="nav-link" data-scroll-target="#introduction-to-vectorization"><span class="header-section-number">6.10.1</span> Introduction to Vectorization</a></li>
  <li><a href="#understanding-vectorized-operations-with-examples" id="toc-understanding-vectorized-operations-with-examples" class="nav-link" data-scroll-target="#understanding-vectorized-operations-with-examples"><span class="header-section-number">6.10.2</span> Understanding Vectorized Operations with Examples</a></li>
  <li><a href="#numpy-vectorization-vs-python-for-loop" id="toc-numpy-vectorization-vs-python-for-loop" class="nav-link" data-scroll-target="#numpy-vectorization-vs-python-for-loop"><span class="header-section-number">6.10.3</span> NumPy Vectorization Vs Python for Loop</a></li>
  <li><a href="#broadcasting-and-its-role-in-vectorization" id="toc-broadcasting-and-its-role-in-vectorization" class="nav-link" data-scroll-target="#broadcasting-and-its-role-in-vectorization"><span class="header-section-number">6.10.4</span> Broadcasting and Its Role in Vectorization</a></li>
  <li><a href="#matrix-multiplication-in-numpy-with-vectorization" id="toc-matrix-multiplication-in-numpy-with-vectorization" class="nav-link" data-scroll-target="#matrix-multiplication-in-numpy-with-vectorization"><span class="header-section-number">6.10.5</span> Matrix Multiplication in NumPy with Vectorization</a>
  <ul class="collapse">
  <li><a href="#method-1-matrix-multiplication-using-np.dot" id="toc-method-1-matrix-multiplication-using-np.dot" class="nav-link" data-scroll-target="#method-1-matrix-multiplication-using-np.dot"><span class="header-section-number">6.10.5.1</span> Method 1: Matrix Multiplication Using <code>np.dot()</code></a></li>
  <li><a href="#method-2-matrix-multiplication-using-np.matmul-pr" id="toc-method-2-matrix-multiplication-using-np.matmul-pr" class="nav-link" data-scroll-target="#method-2-matrix-multiplication-using-np.matmul-pr"><span class="header-section-number">6.10.5.2</span> Method 2: Matrix Multiplication using <code>np.matmul()</code> pr <code>@</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#converting-between-numpy-arrays-and-pandas-dataframes" id="toc-converting-between-numpy-arrays-and-pandas-dataframes" class="nav-link" data-scroll-target="#converting-between-numpy-arrays-and-pandas-dataframes"><span class="header-section-number">6.11</span> Converting Between NumPy Arrays and pandas DataFrames</a>
  <ul>
  <li><a href="#why-conversion-matters" id="toc-why-conversion-matters" class="nav-link" data-scroll-target="#why-conversion-matters"><span class="header-section-number">6.11.1</span> Why Conversion Matters</a></li>
  <li><a href="#converting-a-numpy-array-to-a-pandas-dataframe" id="toc-converting-a-numpy-array-to-a-pandas-dataframe" class="nav-link" data-scroll-target="#converting-a-numpy-array-to-a-pandas-dataframe"><span class="header-section-number">6.11.2</span> Converting a NumPy Array to a pandas DataFrame</a></li>
  <li><a href="#converting-a-pandas-dataframe-to-a-numpy-array" id="toc-converting-a-pandas-dataframe-to-a-numpy-array" class="nav-link" data-scroll-target="#converting-a-pandas-dataframe-to-a-numpy-array"><span class="header-section-number">6.11.3</span> Converting a pandas DataFrame to a NumPy Array</a></li>
  <li><a href="#preserving-index-and-column-information" id="toc-preserving-index-and-column-information" class="nav-link" data-scroll-target="#preserving-index-and-column-information"><span class="header-section-number">6.11.4</span> Preserving Index and Column Information</a></li>
  <li><a href="#practice-user-cases" id="toc-practice-user-cases" class="nav-link" data-scroll-target="#practice-user-cases"><span class="header-section-number">6.11.5</span> Practice User Cases</a>
  <ul class="collapse">
  <li><a href="#case-1-adding-labels-to-a-numpy-array" id="toc-case-1-adding-labels-to-a-numpy-array" class="nav-link" data-scroll-target="#case-1-adding-labels-to-a-numpy-array"><span class="header-section-number">6.11.5.1</span> Case 1: Adding labels to a NumPy Array</a></li>
  <li><a href="#case-2-perform-numerical-computations" id="toc-case-2-perform-numerical-computations" class="nav-link" data-scroll-target="#case-2-perform-numerical-computations"><span class="header-section-number">6.11.5.2</span> Case 2: Perform Numerical Computations</a></li>
  </ul></li>
  <li><a href="#best-practices" id="toc-best-practices" class="nav-link" data-scroll-target="#best-practices"><span class="header-section-number">6.11.6</span> Best Practices</a></li>
  <li><a href="#comparison-table" id="toc-comparison-table" class="nav-link" data-scroll-target="#comparison-table"><span class="header-section-number">6.11.7</span> Comparison Table</a></li>
  </ul></li>
  <li><a href="#random-number-generation-in-numpy" id="toc-random-number-generation-in-numpy" class="nav-link" data-scroll-target="#random-number-generation-in-numpy"><span class="header-section-number">6.12</span> Random Number Generation in NumPy</a>
  <ul>
  <li><a href="#key-functions-for-random-number-generation-in-numpy" id="toc-key-functions-for-random-number-generation-in-numpy" class="nav-link" data-scroll-target="#key-functions-for-random-number-generation-in-numpy"><span class="header-section-number">6.12.1</span> Key Functions for Random Number Generation in NumPy</a></li>
  </ul></li>
  <li><a href="#independent-practice" id="toc-independent-practice" class="nav-link" data-scroll-target="#independent-practice"><span class="header-section-number">6.13</span> Independent Practice:</a>
  <ul>
  <li><a href="#practice-exercise-1" id="toc-practice-exercise-1" class="nav-link" data-scroll-target="#practice-exercise-1"><span class="header-section-number">6.13.1</span> Practice exercise 1</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">6.13.1.1</span> </a></li>
  </ul></li>
  <li><a href="#practice-exercise-2" id="toc-practice-exercise-2" class="nav-link" data-scroll-target="#practice-exercise-2"><span class="header-section-number">6.13.2</span> Practice exercise 2:</a></li>
  <li><a href="#practice-exercise-3" id="toc-practice-exercise-3" class="nav-link" data-scroll-target="#practice-exercise-3"><span class="header-section-number">6.13.3</span> Practice exercise 3</a></li>
  <li><a href="#practice-exercise-4" id="toc-practice-exercise-4" class="nav-link" data-scroll-target="#practice-exercise-4"><span class="header-section-number">6.13.4</span> Practice exercise 4:</a></li>
  <li><a href="#practice-exercise-5" id="toc-practice-exercise-5" class="nav-link" data-scroll-target="#practice-exercise-5"><span class="header-section-number">6.13.5</span> Practice exercise 5</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./NumPy.html">Core library foundations</a></li><li class="breadcrumb-item"><a href="./NumPy.html"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><img src="https://i.imgur.com/mg8O3kd.png" class="img-fluid"></p>
<p><strong>NumPy</strong> is a foundational library in Python, providing support for large, multi-dimensional arrays and matrices, along with a variety of mathematical functions. It’s a critical tool in data science and machine learning because it enables efficient numerical computations, data manipulation, and linear algebra operations. Many machine learning algorithms rely on these operations to process data and perform complex calculations quickly. Moreover, popular libraries like <code>Pandas</code>, <code>SciPy</code>, and <code>TensorFlow</code> are built on top of NumPy, making it essential to understand for implementing and optimizing machine learning models.</p>
<section id="learning-objectives" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">6.1</span> Learning Objectives</h2>
<p>By the end of this lecture, students should be able to:</p>
<ol type="1">
<li>Understand the basic structure and functionarlity of NumPy</li>
<li>Create and manipulate NumPy arrays.</li>
<li>Perform mathematical and statistical operations on arrays.</li>
<li>Utilize advanced concepts such as slicing, broadcasting, and vectorization.</li>
<li>Apply NumPy operations to real-world data science problems.</li>
</ol>
</section>
<section id="getting-started" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="getting-started"><span class="header-section-number">6.2</span> Getting Started</h2>
<div id="4e04b4cc" class="cell" data-execution_count="3">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>If you encounter a ‘ModuleNotFoundError’, please ensure that the module is installed in your current environment before attempting to import it</p>
<div id="ad531af3" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Using the NumPy function array() to define a NumPy array</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>numpy_array <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>numpy_array</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="4">
<pre><code>array([[1, 2],
       [3, 4]])</code></pre>
</div>
</div>
<div id="a9a58e87" class="cell" data-execution_count="5">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(numpy_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>numpy.ndarray</code></pre>
</div>
</div>
<p>Numpy arrays can have any number of dimensions and different lengths along each dimension. We can inspect the length along each dimension using the <code>.shape</code> property of an array.</p>
<p><img src="https://fgnt.github.io/python_crashkurs_doc/_images/numpy_array_t.png" width="420"></p>
<div id="51a81692" class="cell" data-execution_count="6">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>numpy_array.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>2</code></pre>
</div>
</div>
</section>
<section id="data-types-in-numpy" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="data-types-in-numpy"><span class="header-section-number">6.3</span> Data Types in NumPy</h2>
<p>Unlike lists and tuples, NumPy arrays are designed to store elements of the same type, enabling more efficient memory usage and faster computations. The data type of the elements in a NumPy array can be accessed using the <code>.dtype</code> attribute</p>
<div id="02e07c37" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>numpy_array.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
<p>NumPy supports a wide range of data types, each with a specific memory size. Here is a list of common NumPy data types and the memory they consume:</p>
<p>Note that: these data type correspond directly to C data types, since NumPy uses C for the core computational operations. This C implementation allows NumPy to perform array operations much faster and more efficiently than native Python data structures.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Data Type</th>
<th>Memory Size</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>np.int8</code></td>
<td>1 byte</td>
</tr>
<tr class="even">
<td><code>np.int16</code></td>
<td>2 bytes</td>
</tr>
<tr class="odd">
<td><code>np.int32</code></td>
<td>4 bytes</td>
</tr>
<tr class="even">
<td><code>np.int64</code></td>
<td>8 bytes</td>
</tr>
<tr class="odd">
<td><code>np.uint8</code></td>
<td>1 byte</td>
</tr>
<tr class="even">
<td><code>np.uint16</code></td>
<td>2 bytes</td>
</tr>
<tr class="odd">
<td><code>np.uint32</code></td>
<td>4 bytes</td>
</tr>
<tr class="even">
<td><code>np.uint64</code></td>
<td>8 bytes</td>
</tr>
<tr class="odd">
<td><code>np.float16</code></td>
<td>2 bytes</td>
</tr>
<tr class="even">
<td><code>np.float32</code></td>
<td>4 bytes</td>
</tr>
<tr class="odd">
<td><code>np.float64</code></td>
<td>8 bytes</td>
</tr>
<tr class="even">
<td><code>np.complex64</code></td>
<td>8 bytes</td>
</tr>
<tr class="odd">
<td><code>np.complex128</code></td>
<td>16 bytes</td>
</tr>
<tr class="even">
<td><code>np.bool_</code></td>
<td>1 byte</td>
</tr>
<tr class="odd">
<td><code>np.string_</code></td>
<td>1 byte per character</td>
</tr>
<tr class="even">
<td><code>np.unicode_</code></td>
<td>4 bytes per character</td>
</tr>
<tr class="odd">
<td><code>np.object_</code></td>
<td>Variable</td>
</tr>
<tr class="even">
<td><code>np.datetime64</code></td>
<td>8 bytes</td>
</tr>
<tr class="odd">
<td><code>np.timedelta64</code></td>
<td>8 bytes</td>
</tr>
</tbody>
</table>
<section id="upcasting" class="level3" data-number="6.3.1">
<h3 data-number="6.3.1" class="anchored" data-anchor-id="upcasting"><span class="header-section-number">6.3.1</span> Upcasting</h3>
<p>When creating a NumPy array with elements of different data types, NumPy automatically attempts to <strong>upcast</strong> the elements to a compatible data type that can accommodate all of them. This process is known as <strong>type coercion</strong> or <strong>type promotion</strong>. The rules for upcasting follow a hierarchy of data types to ensure no data is lost.</p>
<p>Below are two common types of upcasting with examples:</p>
<p><strong>Numeric Upcasting</strong>: If you mix integers and floats, NumPy will convert the entire array to floats.</p>
<div id="96bb9025" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="fl">2.5</span>, <span class="dv">3</span>])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr.dtype)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>float64</code></pre>
</div>
</div>
<p><strong>String Upcasting</strong>: If you mix numbers and strings, NumPy will upcast all elements to strings.</p>
<div id="45d83b74" class="cell" data-execution_count="9">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="st">'hello'</span>, <span class="fl">3.5</span>])</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr.dtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;U32</code></pre>
</div>
</div>
<p><code>&lt;U21</code> is a NumPy data type that stands for a Unicode string with a maximum length of 21 characters.</p>
</section>
</section>
<section id="why-do-we-need-numpy-arrays" class="level2" data-number="6.4">
<h2 data-number="6.4" class="anchored" data-anchor-id="why-do-we-need-numpy-arrays"><span class="header-section-number">6.4</span> Why do we need NumPy arrays?</h2>
<p>NumPy arrays can store data similarly to lists and tuples, and the same computations can be performed across these structures. However, NumPy is preferred because it is significantly more efficient, particularly when handling large datasets, due to its optimized memory usage and computational speed.</p>
<section id="numpy-arrays-are-memory-efficient-homogeneity-and-contiguous-memory-storage" class="level3" data-number="6.4.1">
<h3 data-number="6.4.1" class="anchored" data-anchor-id="numpy-arrays-are-memory-efficient-homogeneity-and-contiguous-memory-storage"><span class="header-section-number">6.4.1</span> Numpy arrays are memory efficient: Homogeneity and Contiguous Memory Storage</h3>
<p>A NumPy array is a collection of elements of the same data type, stored in contiguous memory locations. In contrast, data structures like lists can hold elements of different data types, stored in non-contiguous memory locations. This homogeneity and contiguous storage allow NumPy arrays to be densely packed, leading to lower memory consumption. The following example demonstrates how NumPy arrays are more memory-efficient compared to other data structures.</p>
<div id="0dfe5549" class="cell" data-execution_count="10">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a NumPy array, Python list, and tuple with the same elements</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.arange(<span class="dv">1000</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>py_list <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000</span>))</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>py_tuple <span class="op">=</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">1000</span>))</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate memory usage</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>array_memory <span class="op">=</span> array.nbytes</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>list_memory <span class="op">=</span> sys.getsizeof(py_list) <span class="op">+</span> <span class="bu">sum</span>(sys.getsizeof(item) <span class="cf">for</span> item <span class="kw">in</span> py_list)</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>tuple_memory <span class="op">=</span> sys.getsizeof(py_tuple) <span class="op">+</span> <span class="bu">sum</span>(sys.getsizeof(item) <span class="cf">for</span> item <span class="kw">in</span> py_tuple)</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the memory usage</span></span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>memory_usage <span class="op">=</span> {</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="st">"NumPy Array (in bytes)"</span>: array_memory,</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Python List (in bytes)"</span>: list_memory,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"Python Tuple (in bytes)"</span>: tuple_memory</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>memory_usage</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>{'NumPy Array (in bytes)': 8000,
 'Python List (in bytes)': 36056,
 'Python Tuple (in bytes)': 36040}</code></pre>
</div>
</div>
<div id="bf2e1d50" class="cell" data-execution_count="11">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># each element in the array is a 64-bit integer</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>array.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
</section>
<section id="numpy-arrays-are-fast" class="level3" data-number="6.4.2">
<h3 data-number="6.4.2" class="anchored" data-anchor-id="numpy-arrays-are-fast"><span class="header-section-number">6.4.2</span> NumPy arrays are fast</h3>
<p>With NumPy arrays, mathematical computations can be performed faster, as compared to other data structures, due to the following reasons:</p>
<ol type="1">
<li><p>As the NumPy array is <strong>densely packed</strong> with homogenous data, it helps retrieve the data faster as well, thereby making computations faster.</p></li>
<li><p>With NumPy, <strong>vectorized computations</strong> can replace the relatively more expensive python <code>for</code> loops. The NumPy package breaks down the vectorized computations into multiple fragments and then processes all the fragments parallelly. However, with a <code>for</code> loop, computations will be one at a time.</p></li>
<li><p>The NumPy package <strong>integrates C</strong>, and <strong>C++</strong> codes in Python. These programming languages have very little execution time as compared to Python.</p></li>
</ol>
<p>We’ll see the faster speed on NumPy computations in the example below.</p>
<p><strong>Example:</strong> This example shows that computations using NumPy arrays are typically much faster than computations with other data structures.</p>
<p><strong>Q:</strong> Multiply whole numbers up to 1 million by an integer, say 2. Compare the time taken for the computation if the numbers are stored in a NumPy array vs a list.</p>
<p>Use the numpy function <a href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html">arange()</a> to define a one-dimensional NumPy array.</p>
<div id="1dbde4fe" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Examples showing NumPy arrays are more efficient for numerical computation</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time <span class="im">as</span> tm</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># List comprehension to multiply each element by 2</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> tm.time()</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>list_ex <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1000000</span>))  <span class="co"># List containing whole numbers up to 1 million</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> [x <span class="op">*</span> <span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> list_ex]    <span class="co"># Multiply each element by 2</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken to multiply numbers in a list = "</span>, tm.time() <span class="op">-</span> start_time)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Tuple - converting to list for multiplication, then back to tuple</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> tm.time()</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>tuple_ex <span class="op">=</span> <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="dv">1000000</span>))  <span class="co"># Tuple containing whole numbers up to 1 million</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> <span class="bu">tuple</span>(x <span class="op">*</span> <span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> tuple_ex)  <span class="co"># Multiply each element by 2</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken to multiply numbers in a tuple = "</span>, tm.time() <span class="op">-</span> start_time)</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="co"># NumPy array element-wise multiplication</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> tm.time()</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>numpy_ex <span class="op">=</span> np.arange(<span class="dv">1000000</span>)  <span class="co"># NumPy array containing whole numbers up to 1 million</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> numpy_ex <span class="op">*</span> <span class="dv">2</span>               <span class="co"># Multiply each element by 2</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken to multiply numbers in a NumPy array = "</span>, tm.time() <span class="op">-</span> start_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Time taken to multiply numbers in a list =  0.049832820892333984
Time taken to multiply numbers in a tuple =  0.08172726631164551
Time taken to multiply numbers in a NumPy array =  0.010966300964355469</code></pre>
</div>
</div>
</section>
</section>
<section id="basics-of-numpy-arrays" class="level2" data-number="6.5">
<h2 data-number="6.5" class="anchored" data-anchor-id="basics-of-numpy-arrays"><span class="header-section-number">6.5</span> Basics of NumPy Arrays</h2>
<section id="creating-numpy-arrays" class="level3" data-number="6.5.1">
<h3 data-number="6.5.1" class="anchored" data-anchor-id="creating-numpy-arrays"><span class="header-section-number">6.5.1</span> Creating NumPy Arrays</h3>
<section id="creating-arrays-for-specific-use-cases" class="level4" data-number="6.5.1.1">
<h4 data-number="6.5.1.1" class="anchored" data-anchor-id="creating-arrays-for-specific-use-cases"><span class="header-section-number">6.5.1.1</span> Creating Arrays for specific use cases:</h4>
<p>You can create a NumPy array using various methods, such as:</p>
<ul>
<li><code>np.array()</code>: Creates an array from a list or iterable.</li>
<li><code>np.zeros()</code>, <code>np.ones()</code>: Creates arrays filled with zeros or ones.</li>
<li><code>np.arange()</code>, <code>np.linespace()</code>: Creates arrays with evenly spaced values.</li>
<li><code>np.random</code> module: Generates arrays with random values.</li>
</ul>
<p>Each method is designed for different use cases. I encourage you to explore and experiment with these functions to see the types of arrays they produce and how they can be used in different scenarios.</p>
</section>
<section id="loading-data-from-file-into-a-numpy-array" class="level4" data-number="6.5.1.2">
<h4 data-number="6.5.1.2" class="anchored" data-anchor-id="loading-data-from-file-into-a-numpy-array"><span class="header-section-number">6.5.1.2</span> Loading data from file into a NumPy array</h4>
<ul>
<li><code>numpy.loadtxt()</code>: Reading simple numerical text files</li>
<li><code>np.genfromtxt()</code>: Reading more complex text files</li>
<li><code>df.to_numpy()</code>: Reading tabular data into pandas dataframe, then using `to_numpy()’ convert it to NumPy array</li>
</ul>
</section>
</section>
<section id="array-attributes" class="level3" data-number="6.5.2">
<h3 data-number="6.5.2" class="anchored" data-anchor-id="array-attributes"><span class="header-section-number">6.5.2</span> Array Attributes:</h3>
<p>Let us define a NumPy array in order to access its attributes:</p>
<div id="96440e0a" class="cell" data-execution_count="13">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>numpy_ex <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>],[<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]])</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>numpy_ex</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([[1, 2, 3],
       [4, 5, 6]])</code></pre>
</div>
</div>
<p>The attributes of <code>numpy_ex</code> can be seen by typing <code>numpy_ex</code> followed by a <code>.</code>, and then pressing the <em>tab</em> key.</p>
<p>Some of the basic attributes of a NumPy array are the following:</p>
<section id="ndim" class="level4" data-number="6.5.2.1">
<h4 data-number="6.5.2.1" class="anchored" data-anchor-id="ndim"><span class="header-section-number">6.5.2.1</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.ndim.html"><code>ndim</code></a></h4>
<p>Shows the number of dimensions (or axes) of the array.</p>
<div id="c4905a86" class="cell" data-execution_count="14">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>numpy_ex.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>2</code></pre>
</div>
</div>
</section>
<section id="shape" class="level4" data-number="6.5.2.2">
<h4 data-number="6.5.2.2" class="anchored" data-anchor-id="shape"><span class="header-section-number">6.5.2.2</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.shape.html"><code>shape</code></a></h4>
<p>This is a tuple of integers indicating the size of the array in each dimension. For a matrix with <em>n</em> rows and <em>m</em> columns, the shape will be <em>(n,m)</em>. The length of the shape tuple is therefore the rank, or the number of dimensions, <code>ndim</code>.</p>
<div id="f5d86d6f" class="cell" data-execution_count="15">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>numpy_ex.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>(2, 3)</code></pre>
</div>
</div>
</section>
<section id="size" class="level4" data-number="6.5.2.3">
<h4 data-number="6.5.2.3" class="anchored" data-anchor-id="size"><span class="header-section-number">6.5.2.3</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.size.html"><code>size</code></a></h4>
<p>This is the total number of elements of the array, which is the product of the elements of shape.</p>
<div id="d53da60e" class="cell" data-execution_count="16">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>numpy_ex.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>6</code></pre>
</div>
</div>
</section>
<section id="dtype" class="level4" data-number="6.5.2.4">
<h4 data-number="6.5.2.4" class="anchored" data-anchor-id="dtype"><span class="header-section-number">6.5.2.4</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.dtype.html"><code>dtype</code></a></h4>
<p>This is an object describing the type of the elements in the array. One can create or specify dtype’s using standard Python types. NumPy provides many, for example bool_, character, int_, int8, int16, int32, int64, float_, float8, float16, float32, float64, complex_, complex64, object_.</p>
<div id="5fb52004" class="cell" data-execution_count="17">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>numpy_ex.dtype</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>dtype('int64')</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="array-indexing-and-slicing" class="level2" data-number="6.6">
<h2 data-number="6.6" class="anchored" data-anchor-id="array-indexing-and-slicing"><span class="header-section-number">6.6</span> Array Indexing and Slicing</h2>
<section id="array-indexing" class="level3" data-number="6.6.1">
<h3 data-number="6.6.1" class="anchored" data-anchor-id="array-indexing"><span class="header-section-number">6.6.1</span> Array Indexing</h3>
<p>Similar to Python lists, NumPy uses zero-based indexing, meaning the first element of an array is accessed using index <code>0</code>. You can use positive or negative indices to access elements</p>
<div id="d4fcc9b3" class="cell" data-execution_count="18">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>])</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[<span class="dv">0</span>])  </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[<span class="dv">4</span>]) </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[<span class="op">-</span><span class="dv">1</span>])  </span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[<span class="op">-</span><span class="dv">3</span>])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>10
50
50
30</code></pre>
</div>
</div>
<p>In multi-dimensional arrays, indices are separated by commas. The first index refers to the row, and the second index refers to the column in a 2D array.</p>
<div id="f784ea9f" class="cell" data-execution_count="19">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 2D array (3 rows, 3 columns)</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>array_2d <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array_2d)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array_2d[<span class="dv">0</span>, <span class="dv">1</span>])  </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array_2d[<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>]) </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array_2d[<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]
 [7 8 9]]
2
6
9</code></pre>
</div>
</div>
<p>You can use boolean arrays to filter or select elements based on a condition</p>
<div id="110d22de" class="cell" data-execution_count="20">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>])</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> array <span class="op">&gt;</span> <span class="dv">30</span>  <span class="co"># Boolean mask for elements greater than 30</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[mask])  <span class="co"># Output: [40 50]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[40 50]</code></pre>
</div>
</div>
</section>
<section id="array-slicing" class="level3" data-number="6.6.2">
<h3 data-number="6.6.2" class="anchored" data-anchor-id="array-slicing"><span class="header-section-number">6.6.2</span> Array Slicing</h3>
<p>Slicing is used to extract a sub-array from an existing array.</p>
<p>The Syntax for slicing is `array[start:stop:step]</p>
<div id="ea4ab967" class="cell" data-execution_count="21">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>])</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[<span class="dv">1</span>:<span class="dv">4</span>])  </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[:<span class="dv">3</span>])  </span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[<span class="dv">2</span>:])  </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[::<span class="dv">2</span>])  </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[::<span class="op">-</span><span class="dv">1</span>]) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[20 30 40]
[10 20 30]
[30 40 50]
[10 30 50]
[50 40 30 20 10]</code></pre>
</div>
</div>
<p>For slicing in Multi-Dimensional Arrays, use commas to separate slicing for different dimensions</p>
<div id="f92045e0" class="cell" data-execution_count="22">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>array_2d <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>], [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]])</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract a sub-array: elements from the first two rows and the first two columns</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>sub_array <span class="op">=</span> array_2d[:<span class="dv">2</span>, :<span class="dv">2</span>]</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sub_array)  </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract all rows for the second column</span></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> array_2d[:, <span class="dv">1</span>]</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(col) </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the last two rows and last two columns</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>sub_array <span class="op">=</span> array_2d[<span class="op">-</span><span class="dv">2</span>:, <span class="op">-</span><span class="dv">2</span>:]</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sub_array)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2]
 [4 5]]
[2 5 8]
[[5 6]
 [8 9]]</code></pre>
</div>
</div>
<p>The <code>step</code> parameter can be used to select elements at regular intervals.</p>
<div id="1d64c04f" class="cell" data-execution_count="23">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>])</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[<span class="dv">1</span>:<span class="dv">8</span>:<span class="dv">2</span>]) </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array[::<span class="op">-</span><span class="dv">2</span>])  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1 3 5 7]
[9 7 5 3 1]</code></pre>
</div>
</div>
</section>
<section id="modify-sub-arrays-through-slicing" class="level3" data-number="6.6.3">
<h3 data-number="6.6.3" class="anchored" data-anchor-id="modify-sub-arrays-through-slicing"><span class="header-section-number">6.6.3</span> Modify Sub-Arrays through Slicing</h3>
<p>Slices are views of the original array, not copies. Modifying a slice will change the original array.</p>
<div id="c686cfda" class="cell" data-execution_count="24">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>])</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>array[<span class="dv">1</span>:<span class="dv">4</span>] <span class="op">=</span> <span class="dv">100</span>  <span class="co"># Replace elements from index 1 to 3 with 100</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array)  <span class="co"># Output: [ 10 100 100 100  50]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[ 10 100 100 100  50]</code></pre>
</div>
</div>
</section>
<section id="combining-indexing-and-slicing" class="level3" data-number="6.6.4">
<h3 data-number="6.6.4" class="anchored" data-anchor-id="combining-indexing-and-slicing"><span class="header-section-number">6.6.4</span> Combining Indexing and Slicing</h3>
<p>You can combine indexing and slicing to extract specific elements or sub-arrays</p>
<div id="a37e7fe6" class="cell" data-execution_count="25">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 3D array</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>array_3d <span class="op">=</span> np.array([[[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]], [[<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>], [<span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">12</span>]]])</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select specific elements and slices</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array_3d[<span class="dv">0</span>, :, <span class="dv">1</span>])  <span class="co"># Output: [2 5] (second element from each row in the first sub-array)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array_3d[<span class="dv">1</span>, <span class="dv">1</span>, :<span class="dv">2</span>])  <span class="co"># Output: [10 11] (first two elements in the last row of the second sub-array)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[2 5]
[10 11]</code></pre>
</div>
</div>
</section>
<section id="np.where-and-np.select" class="level3" data-number="6.6.5">
<h3 data-number="6.6.5" class="anchored" data-anchor-id="np.where-and-np.select"><span class="header-section-number">6.6.5</span> <code>np.where()</code> and <code>np.select()</code></h3>
<p>You can also use <code>np.where</code> and <code>np.select</code> for array slicing and conditional selection.</p>
<div id="86abab77" class="cell" data-execution_count="26">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>array_3d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>array([[[ 1,  2,  3],
        [ 4,  5,  6]],

       [[ 7,  8,  9],
        [10, 11, 12]]])</code></pre>
</div>
</div>
<div id="35acd4e2" class="cell" data-execution_count="27">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using np.where to create a mask and select elements greater than 5</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>greater_than_5 <span class="op">=</span> np.where(array_3d <span class="op">&gt;</span> <span class="dv">5</span>, array_3d, <span class="dv">0</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Elements greater than 5:</span><span class="ch">\n</span><span class="st">"</span>, greater_than_5)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Using np.select to categorize elements into three categories</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>conditions <span class="op">=</span> [array_3d <span class="op">&lt;</span> <span class="dv">4</span>, (array_3d <span class="op">&gt;=</span> <span class="dv">4</span>) <span class="op">&amp;</span> (array_3d <span class="op">&lt;=</span> <span class="dv">8</span>), array_3d <span class="op">&gt;</span> <span class="dv">8</span>]</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>choices <span class="op">=</span> [<span class="st">'low'</span>, <span class="st">'medium'</span>, <span class="st">'high'</span>]</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>categorized_array <span class="op">=</span> np.select(conditions, choices, default<span class="op">=</span><span class="st">'unknown'</span>)</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Categorized array:</span><span class="ch">\n</span><span class="st">"</span>, categorized_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Elements greater than 5:
 [[[ 0  0  0]
  [ 0  0  6]]

 [[ 7  8  9]
  [10 11 12]]]

Categorized array:
 [[['low' 'low' 'low']
  ['medium' 'medium' 'medium']]

 [['medium' 'medium' 'high']
  ['high' 'high' 'high']]]</code></pre>
</div>
</div>
<p>This example shows how <code>np.where</code> and <code>np.select</code> can be used to filter, manipulate, and categorize elements within a 3D array based on specific conditions.</p>
</section>
<section id="np.argmin-and-np.argmax" class="level3" data-number="6.6.6">
<h3 data-number="6.6.6" class="anchored" data-anchor-id="np.argmin-and-np.argmax"><span class="header-section-number">6.6.6</span> <code>np.argmin()</code> and <code>np.argmax()</code></h3>
<p>You can use <code>np.argmin</code> and <code>np.argmax</code> to quickly find the index of the minimum or maximum value in an array along a specified axis. You’ll see their usage in the practice example below</p>
</section>
</section>
<section id="array-operations" class="level2" data-number="6.7">
<h2 data-number="6.7" class="anchored" data-anchor-id="array-operations"><span class="header-section-number">6.7</span> Array Operations</h2>
<section id="arithmetic-operations" class="level3" data-number="6.7.1">
<h3 data-number="6.7.1" class="anchored" data-anchor-id="arithmetic-operations"><span class="header-section-number">6.7.1</span> Arithmetic operations</h3>
<p>Numpy arrays support arithmetic operators like <code>+</code>, <code>-</code>, <code>*</code>, etc. We can perform an arithmetic operation on an array either with a single number (also called scalar) or with another array of the same shape. However, we cannot perform an arithmetic operation on an array with an array of a different shape.</p>
<p>Below are some examples of arithmetic operations on arrays.</p>
<div id="29d3ec75" class="cell" data-execution_count="28">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining two arrays of the same shape</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>], </span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]])</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">14</span>], </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">17</span>, <span class="dv">18</span>], </span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">19</span>, <span class="dv">11</span>, <span class="dv">12</span>, <span class="dv">13</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="35d9c9f8" class="cell" data-execution_count="29">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Element-wise summation of arrays</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">+</span> arr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>array([[12, 14, 16, 18],
       [20, 22, 24, 26],
       [28, 12, 14, 16]])</code></pre>
</div>
</div>
<div id="21986c83" class="cell" data-execution_count="30">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise subtraction</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">-</span> arr1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>array([[10, 10, 10, 10],
       [10, 10, 10, 10],
       [10, 10, 10, 10]])</code></pre>
</div>
</div>
<div id="39548bd4" class="cell" data-execution_count="31">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding a scalar to an array adds the scalar to each element of the array</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">+</span> <span class="dv">3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([[ 4,  5,  6,  7],
       [ 8,  9, 10, 11],
       [12,  4,  5,  6]])</code></pre>
</div>
</div>
<div id="49740c06" class="cell" data-execution_count="32">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dividing an array by a scalar divides all elements of the array by the scalar</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">/</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[0.5, 1. , 1.5, 2. ],
       [2.5, 3. , 3.5, 4. ],
       [4.5, 0.5, 1. , 1.5]])</code></pre>
</div>
</div>
<div id="99a18133" class="cell" data-execution_count="33">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise multiplication</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">*</span> arr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([[ 11,  24,  39,  56],
       [ 75,  96, 119, 144],
       [171,  11,  24,  39]])</code></pre>
</div>
</div>
<div id="ab118b9a" class="cell" data-execution_count="34">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modulus operator with scalar</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">%</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([[1, 2, 3, 0],
       [1, 2, 3, 0],
       [1, 1, 2, 3]])</code></pre>
</div>
</div>
</section>
<section id="comparison-and-logical-operation" class="level3" data-number="6.7.2">
<h3 data-number="6.7.2" class="anchored" data-anchor-id="comparison-and-logical-operation"><span class="header-section-number">6.7.2</span> Comparison and Logical Operation</h3>
<p>Numpy arrays support comparison operations like <code>==</code>, <code>!=</code>, <code>&gt;</code> etc. The result is an array of booleans.</p>
<div id="237ddd57" class="cell" data-execution_count="35">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]])</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e8716350" class="cell" data-execution_count="36">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">==</span> arr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>array([[False,  True,  True],
       [False, False,  True]])</code></pre>
</div>
</div>
<div id="dc097ecd" class="cell" data-execution_count="37">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">!=</span> arr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="37">
<pre><code>array([[ True, False, False],
       [ True,  True, False]])</code></pre>
</div>
</div>
<div id="2aadd953" class="cell" data-execution_count="38">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">&gt;=</span> arr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>array([[False,  True,  True],
       [ True,  True,  True]])</code></pre>
</div>
</div>
<div id="9476fd97" class="cell" data-execution_count="39">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">&lt;</span> arr2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>array([[ True, False, False],
       [False, False, False]])</code></pre>
</div>
</div>
<p>Array comparison is frequently used to count the number of equal elements in two arrays using the <code>sum</code> method. Remember that <code>True</code> evaluates to <code>1</code> and <code>False</code> evaluates to <code>0</code> when booleans are used in arithmetic operations.</p>
<div id="990a8429" class="cell" data-execution_count="40">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(arr1 <span class="op">==</span> arr2).<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>np.int64(3)</code></pre>
</div>
</div>
</section>
<section id="aggregate-functions-np.sum-np.mean-np.min-np.max" class="level3" data-number="6.7.3">
<h3 data-number="6.7.3" class="anchored" data-anchor-id="aggregate-functions-np.sum-np.mean-np.min-np.max"><span class="header-section-number">6.7.3</span> Aggregate Functions: <code>np.sum()</code>, <code>np.mean()</code>, <code>np.min()</code>, <code>np.max()</code></h3>
<section id="overall-aggregate-calculations" class="level4" data-number="6.7.3.1">
<h4 data-number="6.7.3.1" class="anchored" data-anchor-id="overall-aggregate-calculations"><span class="header-section-number">6.7.3.1</span> Overall Aggregate Calculations:</h4>
<ul>
<li><code>np.sum(array)</code>: Calculates the sum of all elements in the array.</li>
<li><code>np.mean(array)</code>: Calculates the mean of all elements in the array.</li>
<li><code>np.min(array)</code>: Finds the minimum value in the entire array.</li>
<li><code>np.max(array)</code>: Finds the maximum value in the entire array.</li>
</ul>
</section>
<section id="row-wise-calculations-axis1" class="level4" data-number="6.7.3.2">
<h4 data-number="6.7.3.2" class="anchored" data-anchor-id="row-wise-calculations-axis1"><span class="header-section-number">6.7.3.2</span> Row-Wise Calculations (axis=1):</h4>
<ul>
<li><code>np.sum(array, axis=1)</code>: Computes the sum of elements in each row.</li>
<li><code>np.mean(array, axis=1)</code>: Computes the mean of elements in each row.</li>
<li><code>np.min(array, axis=1)</code>: Finds the minimum value in each row.</li>
<li><code>np.max(array, axis=1)</code>: Finds the maximum value in each row.</li>
</ul>
</section>
<section id="column-wise-calculations-axis0" class="level4" data-number="6.7.3.3">
<h4 data-number="6.7.3.3" class="anchored" data-anchor-id="column-wise-calculations-axis0"><span class="header-section-number">6.7.3.3</span> Column-Wise Calculations (axis=0):</h4>
<ul>
<li><code>np.sum(array, axis=0)</code>: Computes the sum of elements in each column.</li>
<li><code>np.mean(array, axis=0)</code>: Computes the mean of elements in each column.</li>
<li><code>np.min(array, axis=0)</code>: Finds the minimum value in each column.</li>
<li><code>np.max(array, axis=0)</code>: Finds the maximum value in each column.</li>
</ul>
<div id="1dab499a" class="cell" data-execution_count="41">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a 3x4 array of integers</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> np.array([[<span class="dv">4</span>, <span class="dv">7</span>, <span class="dv">1</span>, <span class="dv">3</span>],</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">5</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">6</span>],</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>                  [<span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">2</span>]])</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the original array</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original Array:</span><span class="ch">\n</span><span class="st">"</span>, array)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum, mean, minimum, and maximum for the entire array</span></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>total_sum <span class="op">=</span> np.<span class="bu">sum</span>(array)</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>mean_value <span class="op">=</span> np.mean(array)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>min_value <span class="op">=</span> np.<span class="bu">min</span>(array)</span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>max_value <span class="op">=</span> np.<span class="bu">max</span>(array)</span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="ch">\n</span><span class="ss">Sum of all elements: </span><span class="sc">{</span>total_sum<span class="sc">}</span><span class="ss">"</span>)  </span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Mean of all elements: </span><span class="sc">{</span>mean_value<span class="sc">}</span><span class="ss">"</span>)  </span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Minimum value in the array: </span><span class="sc">{</span>min_value<span class="sc">}</span><span class="ss">"</span>)  </span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Maximum value in the array: </span><span class="sc">{</span>max_value<span class="sc">}</span><span class="ss">"</span>)  </span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum, mean, minimum, and maximum along each row (axis=1)</span></span>
<span id="cb74-21"><a href="#cb74-21" aria-hidden="true" tabindex="-1"></a>row_sum <span class="op">=</span> np.<span class="bu">sum</span>(array, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-22"><a href="#cb74-22" aria-hidden="true" tabindex="-1"></a>row_mean <span class="op">=</span> np.mean(array, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-23"><a href="#cb74-23" aria-hidden="true" tabindex="-1"></a>row_min <span class="op">=</span> np.<span class="bu">min</span>(array, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-24"><a href="#cb74-24" aria-hidden="true" tabindex="-1"></a>row_max <span class="op">=</span> np.<span class="bu">max</span>(array, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb74-25"><a href="#cb74-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-26"><a href="#cb74-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sum along each row:"</span>, row_sum)  </span>
<span id="cb74-27"><a href="#cb74-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean along each row:"</span>, row_mean)  </span>
<span id="cb74-28"><a href="#cb74-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Minimum value along each row:"</span>, row_min)  </span>
<span id="cb74-29"><a href="#cb74-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Maximum value along each row:"</span>, row_max)  </span>
<span id="cb74-30"><a href="#cb74-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-31"><a href="#cb74-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the sum, mean, minimum, and maximum along each column (axis=0)</span></span>
<span id="cb74-32"><a href="#cb74-32" aria-hidden="true" tabindex="-1"></a>col_sum <span class="op">=</span> np.<span class="bu">sum</span>(array, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb74-33"><a href="#cb74-33" aria-hidden="true" tabindex="-1"></a>col_mean <span class="op">=</span> np.mean(array, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb74-34"><a href="#cb74-34" aria-hidden="true" tabindex="-1"></a>col_min <span class="op">=</span> np.<span class="bu">min</span>(array, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb74-35"><a href="#cb74-35" aria-hidden="true" tabindex="-1"></a>col_max <span class="op">=</span> np.<span class="bu">max</span>(array, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb74-36"><a href="#cb74-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-37"><a href="#cb74-37" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Sum along each column:"</span>, col_sum)  </span>
<span id="cb74-38"><a href="#cb74-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Mean along each column:"</span>, col_mean)  </span>
<span id="cb74-39"><a href="#cb74-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Minimum value along each column:"</span>, col_min)  </span>
<span id="cb74-40"><a href="#cb74-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Maximum value along each column:"</span>, col_max)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Original Array:
 [[4 7 1 3]
 [5 8 2 6]
 [9 3 5 2]]

Sum of all elements: 55
Mean of all elements: 4.583333333333333
Minimum value in the array: 1
Maximum value in the array: 9

Sum along each row: [15 21 19]
Mean along each row: [3.75 5.25 4.75]
Minimum value along each row: [1 2 2]
Maximum value along each row: [7 8 9]

Sum along each column: [18 18  8 11]
Mean along each column: [6.         6.         2.66666667 3.66666667]
Minimum value along each column: [4 3 1 2]
Maximum value along each column: [9 8 5 6]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="array-reshaping" class="level2" data-number="6.8">
<h2 data-number="6.8" class="anchored" data-anchor-id="array-reshaping"><span class="header-section-number">6.8</span> Array Reshaping</h2>
<p>Certain functions and machine learning models require input data in a specific shape or format. For instance, operations like matrix multiplication and broadcasting depend on the alignment of array dimensions. Many deep learning models expect input data to be in a 4D array format (batch size, height, width, channels). Reshaping enables us to convert data into the necessary shape, ensuring compatibility without altering the underlying values.</p>
<p>Below are some methods to reshape NumPy arrays:</p>
<section id="reshape" class="level3" data-number="6.8.1">
<h3 data-number="6.8.1" class="anchored" data-anchor-id="reshape"><span class="header-section-number">6.8.1</span> <code>reshape()</code></h3>
<p>The <code>reshape</code> method in NumPy allows you to change the shape of an existing array without changing its data.</p>
<div id="67d065cb" class="cell" data-execution_count="42">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>])</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>reshaped_arr <span class="op">=</span> arr.reshape(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reshaped_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 5 6]]</code></pre>
</div>
</div>
<p>Using<code>-1</code> for automatic dimension inference</p>
<div id="b1531506" class="cell" data-execution_count="43">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.arange(<span class="dv">12</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>reshaped_arr <span class="op">=</span> arr.reshape(<span class="dv">3</span>, <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reshaped_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]]</code></pre>
</div>
</div>
<p>Here, -1 means “calculate this dimension based on the remaining dimensions and the total size of the array”. So, (3, -1) becomes (3, 4).</p>
</section>
<section id="flatten-and-ravel" class="level3" data-number="6.8.2">
<h3 data-number="6.8.2" class="anchored" data-anchor-id="flatten-and-ravel"><span class="header-section-number">6.8.2</span> <code>flatten()</code> and <code>ravel()</code></h3>
<p>The <code>flatten</code> method returns a copy of the array collapsed into one dimension. It is useful when you need to perform operations that require 1D input or need to pass the array data as a linear sequence. <code>order</code> specifies the order in which elements are read, options include but not limited to: * <code>C</code> (default): Row-major (C-style). * <code>F</code>: Column-major (Fortran-style).</p>
<p>In contrast, <code>ravel()</code> returns a flattened view of the original array whenever possible, without creating a copy.</p>
<div id="1bcd954e" class="cell" data-execution_count="44">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>flattened_arr <span class="op">=</span> arr.flatten()</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(flattened_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3 4 5 6]</code></pre>
</div>
</div>
<div id="6000c64e" class="cell" data-execution_count="45">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using ravel() to flatten the array</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>flattened_arr <span class="op">=</span> arr.ravel()</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(flattened_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1 2 3 4 5 6]</code></pre>
</div>
</div>
</section>
<section id="resize" class="level3" data-number="6.8.3">
<h3 data-number="6.8.3" class="anchored" data-anchor-id="resize"><span class="header-section-number">6.8.3</span> <code>resize()</code></h3>
<p>Changes the shape and size of an array in place. Unlike <code>reshape()</code>, it can modify the array and fill additional elements with zeros if necessary.</p>
<div id="727c9e51" class="cell" data-execution_count="46">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>arr.resize(<span class="dv">2</span>, <span class="dv">3</span>) </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 2 3]
 [4 0 0]]</code></pre>
</div>
</div>
</section>
<section id="tranpose-or-t" class="level3" data-number="6.8.4">
<h3 data-number="6.8.4" class="anchored" data-anchor-id="tranpose-or-t"><span class="header-section-number">6.8.4</span> <code>tranpose()</code> or <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.T.html"><code>T</code></a></h3>
<p>Both can be used to transpose the NumPy array. This is often used to make matrices (2-dimensional arrays) compatible for multiplication.</p>
<div id="6c80c489" class="cell" data-execution_count="47">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>transposed_arr <span class="op">=</span> arr.transpose()  <span class="co"># Output: [[1 4], [2 5], [3 6]]</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(transposed_arr)</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>T_arr <span class="op">=</span> arr.T  <span class="co"># Output: [[1 4], [2 5], [3 6]]</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(T_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[1 4]
 [2 5]
 [3 6]]
[[1 4]
 [2 5]
 [3 6]]</code></pre>
</div>
</div>
</section>
</section>
<section id="arrays-concaternating" class="level2" data-number="6.9">
<h2 data-number="6.9" class="anchored" data-anchor-id="arrays-concaternating"><span class="header-section-number">6.9</span> Arrays Concaternating</h2>
<p>NumPy provides several functions to concatenate arrays along different axes.</p>
<section id="np.concatenate" class="level3" data-number="6.9.1">
<h3 data-number="6.9.1" class="anchored" data-anchor-id="np.concatenate"><span class="header-section-number">6.9.1</span> <code>np.concatenate()</code></h3>
<p>Arrays can be concatenated along an axis with NumPy’s <a href="https://numpy.org/doc/stable/reference/generated/numpy.concatenate.html">concatenate</a> function. The <code>axis</code> argument specifies the dimension for concatenation. The arrays should have the same number of dimensions, and the same length along each axis except the axis used for concatenation.</p>
<p>The examples below show concatenation of arrays.</p>
<div id="bb77eff2" class="cell" data-execution_count="48">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]])</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>], [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>]])</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Array 1:</span><span class="ch">\n</span><span class="st">"</span>,arr1)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Array 2:</span><span class="ch">\n</span><span class="st">"</span>,arr2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Array 1:
 [[1 2 3]
 [3 4 5]]
Array 2:
 [[2 2 3]
 [1 2 5]]</code></pre>
</div>
</div>
<div id="bbe81e5d" class="cell" data-execution_count="49">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Concatenating the arrays along the default axis: axis=0</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>np.concatenate((arr1,arr2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>array([[1, 2, 3],
       [3, 4, 5],
       [2, 2, 3],
       [1, 2, 5]])</code></pre>
</div>
</div>
<div id="a538a500" class="cell" data-execution_count="50">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Concatenating the arrays along axis = 1</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>np.concatenate((arr1,arr2),axis<span class="op">=</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="50">
<pre><code>array([[1, 2, 3, 2, 2, 3],
       [3, 4, 5, 1, 2, 5]])</code></pre>
</div>
</div>
<p>Here’s a visual explanation of <code>np.concatenate</code> along <code>axis=1</code> (can you guess what <code>axis=0</code> results in?):</p>
<p><img src="https://www.w3resource.com/w3r_images/python-numpy-image-exercise-58.png" width="300"></p>
<p>Let us concatenate the array below (<code>arr3</code>) with <code>arr1</code>, along axis = 0.</p>
<div id="c57d00ac" class="cell" data-execution_count="51">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>arr3 <span class="op">=</span> np.array([<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="4e1bf7fc" class="cell" data-execution_count="52">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>np.concatenate((arr1,arr3),axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg ansi-bold">In[52], line 1</span>
<span class="ansi-green-fg ansi-bold">----&gt; 1</span> <span class="ansi-yellow-bg">np</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">.</span><span class="ansi-yellow-bg">concatenate</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">(</span><span class="ansi-yellow-bg">arr1</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">arr3</span><span class="ansi-yellow-bg">)</span><span class="ansi-yellow-bg">,</span><span class="ansi-yellow-bg">axis</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">=</span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">0</span><span class="ansi-yellow-bg">)</span>

<span class="ansi-red-fg ansi-bold">ValueError</span>: all the input arrays must have same number of dimensions, but the array at index 0 has 2 dimension(s) and the array at index 1 has 1 dimension(s)</pre>
</div>
</div>
</div>
<p>Note the above error, which indicates that <code>arr3</code> has only one dimension. Let us check the shape of <code>arr3</code>.</p>
<div id="fa845379" class="cell" data-execution_count="53">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>arr3.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>(3,)</code></pre>
</div>
</div>
<p>We can reshape <code>arr3</code> to a shape of (1,3) to make it compatible for concatenation with <code>arr1</code> along axis = 0.</p>
<div id="993124c4" class="cell" data-execution_count="54">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>arr3_reshaped <span class="op">=</span> arr3.reshape(<span class="dv">1</span>,<span class="dv">3</span>)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>arr3_reshaped</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="54">
<pre><code>array([[2, 2, 3]])</code></pre>
</div>
</div>
<p>Now we can concatenate the reshaped <code>arr3</code> with <code>arr1</code> along axis = 0.</p>
<div id="f3f76e26" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>np.concatenate((arr1,arr3_reshaped),axis<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>array([[1, 2, 3],
       [3, 4, 5],
       [2, 2, 3]])</code></pre>
</div>
</div>
</section>
<section id="np.vstack-and-np.hstack" class="level3" data-number="6.9.2">
<h3 data-number="6.9.2" class="anchored" data-anchor-id="np.vstack-and-np.hstack"><span class="header-section-number">6.9.2</span> <code>np.vstack()</code> and <code>np.hstack()</code></h3>
<ul>
<li><code>np.vstack()</code>: Stacks arrays vertically (along rows).</li>
<li><code>np.hstack()</code>: Stacks arrays horizontally (along columns).</li>
</ul>
<div id="20cd7b06" class="cell" data-execution_count="55">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Vertical stacking</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>vstack <span class="op">=</span> np.vstack((arr1, arr2))</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Vertical Stack:</span><span class="ch">\n</span><span class="st">"</span>, vstack)</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Horizontal stacking</span></span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>hstack <span class="op">=</span> np.hstack((arr1, arr2))</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Horizontal Stack:</span><span class="ch">\n</span><span class="st">"</span>, hstack)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Vertical Stack:
 [[1 2 3]
 [3 4 5]
 [2 2 3]
 [1 2 5]]

Horizontal Stack:
 [[1 2 3 2 2 3]
 [3 4 5 1 2 5]]</code></pre>
</div>
</div>
</section>
</section>
<section id="vectorization-in-numpy" class="level2" data-number="6.10">
<h2 data-number="6.10" class="anchored" data-anchor-id="vectorization-in-numpy"><span class="header-section-number">6.10</span> Vectorization in NumPy</h2>
<section id="introduction-to-vectorization" class="level3" data-number="6.10.1">
<h3 data-number="6.10.1" class="anchored" data-anchor-id="introduction-to-vectorization"><span class="header-section-number">6.10.1</span> Introduction to Vectorization</h3>
<p>Vectorization is the process of applying operations to entire arrays or matrices simultaneously rather than iterating over individual elements using loops. This approach allows NumPy to utilize highly optimized C libraries for faster computation.</p>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTQ_9hGutgPqNO9OCLy-vDyJub4iLpgThGZ9A&amp;s.png" class="img-fluid"></p>
<p>Benefits of Vectorization:</p>
<ul>
<li>Performance: Significantly faster than using for-loops in Python.</li>
<li>Conciseness: Shorter and more readable code.</li>
<li>Efficiency: Reduces the overhead of Python loops and leverages lower-level optimizations.</li>
</ul>
</section>
<section id="understanding-vectorized-operations-with-examples" class="level3" data-number="6.10.2">
<h3 data-number="6.10.2" class="anchored" data-anchor-id="understanding-vectorized-operations-with-examples"><span class="header-section-number">6.10.2</span> Understanding Vectorized Operations with Examples</h3>
<div id="4aa4018c" class="cell" data-execution_count="56">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create two arrays</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.array([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>])</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">50</span>])</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-wise addition (vectorized operation)</span></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>sum_arr <span class="op">=</span> arr1 <span class="op">+</span> arr2</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Sum Array:"</span>, sum_arr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Sum Array: [11 22 33 44 55]</code></pre>
</div>
</div>
</section>
<section id="numpy-vectorization-vs-python-for-loop" class="level3" data-number="6.10.3">
<h3 data-number="6.10.3" class="anchored" data-anchor-id="numpy-vectorization-vs-python-for-loop"><span class="header-section-number">6.10.3</span> NumPy Vectorization Vs Python for Loop</h3>
<p><code>np.dot</code> is a vectorized operation in NumPy that performs matrix multiplication or dot product between arrays. It efficiently computes the element-wise multiplications and then sums them up. To better understand its efficiency, let’s first implement the dot product using for loops, and then compare its performance with <code>np.dot</code> to see the benefits of vectorization.</p>
<div id="64cf89f1" class="cell" data-execution_count="57">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to calculate dot product using for loops</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dot_product_loops(arr1, arr2):</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(arr1)):</span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> arr1[i] <span class="op">*</span> arr2[i]</span>
<span id="cb106-8"><a href="#cb106-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb106-9"><a href="#cb106-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-10"><a href="#cb106-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Create sample arrays</span></span>
<span id="cb106-11"><a href="#cb106-11" aria-hidden="true" tabindex="-1"></a>arr1 <span class="op">=</span> np.random.rand(<span class="dv">1000000</span>)</span>
<span id="cb106-12"><a href="#cb106-12" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.random.rand(<span class="dv">1000000</span>)</span>
<span id="cb106-13"><a href="#cb106-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-14"><a href="#cb106-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure time for the loop-based implementation</span></span>
<span id="cb106-15"><a href="#cb106-15" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb106-16"><a href="#cb106-16" aria-hidden="true" tabindex="-1"></a>loop_result <span class="op">=</span> dot_product_loops(arr1, arr2)</span>
<span id="cb106-17"><a href="#cb106-17" aria-hidden="true" tabindex="-1"></a>loop_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb106-18"><a href="#cb106-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-19"><a href="#cb106-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Measure time for np.dot</span></span>
<span id="cb106-20"><a href="#cb106-20" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> time.time()</span>
<span id="cb106-21"><a href="#cb106-21" aria-hidden="true" tabindex="-1"></a>numpy_result <span class="op">=</span> np.dot(arr1, arr2)</span>
<span id="cb106-22"><a href="#cb106-22" aria-hidden="true" tabindex="-1"></a>numpy_time <span class="op">=</span> time.time() <span class="op">-</span> start_time</span>
<span id="cb106-23"><a href="#cb106-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-24"><a href="#cb106-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Display results</span></span>
<span id="cb106-25"><a href="#cb106-25" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"Loop-based implementation result: </span><span class="sc">{</span>loop_result<span class="sc">:.5f}</span><span class="ss">, Time: </span><span class="sc">{</span>loop_time<span class="sc">:.5f}</span><span class="ss"> seconds"</span>)</span>
<span id="cb106-26"><a href="#cb106-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"NumPy np.dot result: </span><span class="sc">{</span>numpy_result<span class="sc">:.5f}</span><span class="ss">, Time: </span><span class="sc">{</span>numpy_time<span class="sc">:.5f}</span><span class="ss"> seconds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Loop-based implementation result: 250068.46992, Time: 0.19136 seconds
NumPy np.dot result: 250068.46992, Time: 0.00199 seconds</code></pre>
</div>
</div>
<p>The <code>np.dot</code> function significantly outperforms the manual loop-based implementation because it leverages NumPy’s vectorized operations, which is written in highly efficient C code. This example highlights why vectorized operations like <code>np.dot</code> are preferred for large-scale numerical computations in NumPy.</p>
</section>
<section id="broadcasting-and-its-role-in-vectorization" class="level3" data-number="6.10.4">
<h3 data-number="6.10.4" class="anchored" data-anchor-id="broadcasting-and-its-role-in-vectorization"><span class="header-section-number">6.10.4</span> Broadcasting and Its Role in Vectorization</h3>
<p>Broadcasting allows NumPy to perform operations between arrays of different shapes by automatically expanding their dimensions. This is essential for vectorized operations involving arrays with varying shapes.</p>
<p>Let’s look at an example to see how it works</p>
<div id="a1e4238a" class="cell" data-execution_count="58">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>], </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>                 [<span class="dv">9</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="5605234b" class="cell" data-execution_count="59">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>arr4 <span class="op">=</span> np.array([<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="856277ae" class="cell" data-execution_count="60">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">+</span> arr4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>array([[ 5,  7,  9, 11],
       [ 9, 11, 13, 15],
       [13,  6,  8, 10]])</code></pre>
</div>
</div>
<p>When the expression <code>arr2 + arr4</code> is evaluated, <code>arr4</code> (which has the shape <code>(4,)</code>) is replicated three times to match the shape <code>(3, 4)</code> of <code>arr2</code>. Numpy performs the replication without actually creating three copies of the smaller dimension array, thus improving performance and using lower memory.</p>
<p><img src="https://jakevdp.github.io/PythonDataScienceHandbook/figures/02.05-broadcasting.png" width="360"></p>
<p>Broadcasting only works if one of the arrays can be replicated to match the other array’s shape.</p>
<ul>
<li>Dimensions of size 1 will broadcast (as if the value was repeated).</li>
<li>Otherwise, the dimension must have the same shape.</li>
</ul>
<div id="863cee97" class="cell" data-execution_count="61">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>arr5 <span class="op">=</span> np.array([<span class="dv">7</span>, <span class="dv">8</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="f46f60d7" class="cell" data-execution_count="62">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>arr2 <span class="op">+</span> arr5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg ansi-bold">ValueError</span>                                Traceback (most recent call last)
Cell <span class="ansi-green-fg ansi-bold">In[62], line 1</span>
<span class="ansi-green-fg ansi-bold">----&gt; 1</span> <span class="ansi-yellow-bg">arr2</span><span class="ansi-yellow-bg"> </span><span style="color:rgb(98,98,98)" class="ansi-yellow-bg">+</span><span class="ansi-yellow-bg"> </span><span class="ansi-yellow-bg">arr5</span>

<span class="ansi-red-fg ansi-bold">ValueError</span>: operands could not be broadcast together with shapes (3,4) (2,) </pre>
</div>
</div>
</div>
<p>In the above example, even if <code>arr5</code> is replicated three times, it will not match the shape of <code>arr2</code>. Hence <code>arr2 + arr5</code> cannot be evaluated successfully. See the <a href="https://numpy.org/doc/stable/user/basics.broadcasting.html">broadcasting documentation</a> to learn more about it.</p>
</section>
<section id="matrix-multiplication-in-numpy-with-vectorization" class="level3" data-number="6.10.5">
<h3 data-number="6.10.5" class="anchored" data-anchor-id="matrix-multiplication-in-numpy-with-vectorization"><span class="header-section-number">6.10.5</span> Matrix Multiplication in NumPy with Vectorization</h3>
<p>Matrix multiplication is one of the most common and computationally intensive operations in numerical computing and deep learning. NumPy offers efficient and highly optimized methods for performing matrix multiplication, which leverage vectorization to handle large matrices quickly and accurately.</p>
<p><strong>Note that</strong>: NumPy matrix operations follow the standard rules of linear algebra, so it’s important to ensure that the shapes of the matrices are compatible. If they are not, consider reshaping the matrices before performing multiplication</p>
<p>There are two commonly methods for matrix multiplication</p>
<section id="method-1-matrix-multiplication-using-np.dot" class="level4" data-number="6.10.5.1">
<h4 data-number="6.10.5.1" class="anchored" data-anchor-id="method-1-matrix-multiplication-using-np.dot"><span class="header-section-number">6.10.5.1</span> Method 1: Matrix Multiplication Using <code>np.dot()</code></h4>
<div id="f03800da" class="cell" data-execution_count="63">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define two 2D arrays (matrices)</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>matrix1 <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>matrix2 <span class="op">=</span> np.array([[<span class="dv">7</span>, <span class="dv">8</span>], </span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">9</span>, <span class="dv">10</span>], </span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>                    [<span class="dv">11</span>, <span class="dv">12</span>]])</span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix multiplication using np.dot</span></span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a>result_dot <span class="op">=</span> np.dot(matrix1, matrix2)</span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix Multiplication using np.dot:</span><span class="ch">\n</span><span class="st">"</span>, result_dot)</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Another way to perform np.dot for matrix multiplication</span></span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>result_dot2 <span class="op">=</span> matrix1.dot(matrix2)</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Matrix Multiplication using dot method:</span><span class="ch">\n</span><span class="st">"</span>, result_dot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix Multiplication using np.dot:
 [[ 58  64]
 [139 154]]

Matrix Multiplication using dot method:
 [[ 58  64]
 [139 154]]</code></pre>
</div>
</div>
</section>
<section id="method-2-matrix-multiplication-using-np.matmul-pr" class="level4" data-number="6.10.5.2">
<h4 data-number="6.10.5.2" class="anchored" data-anchor-id="method-2-matrix-multiplication-using-np.matmul-pr"><span class="header-section-number">6.10.5.2</span> Method 2: Matrix Multiplication using <code>np.matmul()</code> pr <code>@</code></h4>
<div id="9c866daf" class="cell" data-execution_count="64">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Matrix multiplication using np.matmul or @ operator</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>result_matmul <span class="op">=</span> np.matmul(matrix1, matrix2)</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>result_operator <span class="op">=</span> matrix1 <span class="op">@</span> matrix2</span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Matrix Multiplication using np.matmul:</span><span class="ch">\n</span><span class="st">"</span>, result_matmul)</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Matrix Multiplication using @ operator:</span><span class="ch">\n</span><span class="st">"</span>, result_operator)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Matrix Multiplication using np.matmul:
 [[ 58  64]
 [139 154]]

Matrix Multiplication using @ operator:
 [[ 58  64]
 [139 154]]</code></pre>
</div>
</div>
<p>Note that <code>*</code> operator in numpy is element-wise multiplication</p>
<div id="2f186fb8" class="cell" data-execution_count="1">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using * operator for element-wise multiplication, please uncomment the code below to run</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="co"># element_wise = matrix1 * matrix2</span></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="co"># print("\nElement-wise Multiplication:\n", element_wise)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="c129c96b" class="cell" data-execution_count="66">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape the array for element-wise multiplication</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>matrix2_reshaped <span class="op">=</span> matrix2.reshape(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>element_wise <span class="op">=</span> matrix1 <span class="op">*</span> matrix2_reshaped</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">Element-wise Multiplication after reshaping:</span><span class="ch">\n</span><span class="st">"</span>, element_wise)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Element-wise Multiplication after reshaping:
 [[ 7 16 27]
 [40 55 72]]</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="converting-between-numpy-arrays-and-pandas-dataframes" class="level2" data-number="6.11">
<h2 data-number="6.11" class="anchored" data-anchor-id="converting-between-numpy-arrays-and-pandas-dataframes"><span class="header-section-number">6.11</span> Converting Between NumPy Arrays and pandas DataFrames</h2>
<section id="why-conversion-matters" class="level3" data-number="6.11.1">
<h3 data-number="6.11.1" class="anchored" data-anchor-id="why-conversion-matters"><span class="header-section-number">6.11.1</span> Why Conversion Matters</h3>
<p>While both pandas and NumPy are integral to data science, they serve different purposes:</p>
<ol type="1">
<li>pandas:
<ul>
<li>Foucses on <strong>data manipulation</strong> and analysis</li>
<li>Provided intuitive tools to work with <strong>tabular data</strong>(e.g., labeled rows and columns).</li>
</ul></li>
<li>NumPy:
<ul>
<li>Optimized for <strong>numerical computations</strong>.</li>
<li>Offers mathematical functions like matrix multiplication, matrix decomposition, and eigenvalue computations, which pandas does not directly support.</li>
</ul></li>
</ol>
</section>
<section id="converting-a-numpy-array-to-a-pandas-dataframe" class="level3" data-number="6.11.2">
<h3 data-number="6.11.2" class="anchored" data-anchor-id="converting-a-numpy-array-to-a-pandas-dataframe"><span class="header-section-number">6.11.2</span> Converting a NumPy Array to a pandas DataFrame</h3>
<p>You have numerical data stored in a NumPy array and want to apply pandas functionalities like labeling rows/columns or analyzing tabular data.</p>
<div id="e0ec8320" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a NumPy array</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array([[<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>], [<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>], [<span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>]])</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to a DataFrame</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'A'</span>, <span class="st">'B'</span>, <span class="st">'C'</span>])</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the DataFrame</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B   C
0  10  20  30
1  40  50  60
2  70  80  90</code></pre>
</div>
</div>
<p><strong>Key Points</strong></p>
<ul>
<li>Use the <code>pd.DataFrame()</code> constructor to create a DataFrame from a NumPy array.</li>
<li>You can specify:
<ul>
<li><strong>Column names</strong> using the <code>columns</code> parameter.</li>
<li><strong>Row labels</strong> using the <code>index</code> parameter.</li>
</ul></li>
<li>If <code>columns</code> or <code>index</code> are not specified, pandas assigns default labels:
<ul>
<li>Columns: <code>0, 1, 2, ...</code></li>
<li>Rows: <code>0, 1, 2, ...</code></li>
</ul></li>
</ul>
</section>
<section id="converting-a-pandas-dataframe-to-a-numpy-array" class="level3" data-number="6.11.3">
<h3 data-number="6.11.3" class="anchored" data-anchor-id="converting-a-pandas-dataframe-to-a-numpy-array"><span class="header-section-number">6.11.3</span> Converting a pandas DataFrame to a NumPy Array</h3>
<p>You have a pandas DataFrame and want to perform NumPy operations for optimized numerical processing.</p>
<div id="02b8b164" class="cell" data-execution_count="2">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert DataFrame to NumPy array</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> df.to_numpy()</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the NumPy array</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[10 20 30]
 [40 50 60]
 [70 80 90]]</code></pre>
</div>
</div>
<p><strong>Key Points</strong> * Use <code>.to_numpy()</code> for conversion. * <code>.values</code> is an older method but still works (not recommended for newer code).</p>
</section>
<section id="preserving-index-and-column-information" class="level3" data-number="6.11.4">
<h3 data-number="6.11.4" class="anchored" data-anchor-id="preserving-index-and-column-information"><span class="header-section-number">6.11.4</span> Preserving Index and Column Information</h3>
<p>When converting a DataFrame to an array and back, ensure row/column labels are retained.</p>
<div id="8cec2321" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert DataFrame to NumPy array</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>array_with_labels <span class="op">=</span> df.to_numpy()</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert back to a DataFrame</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>df_restored <span class="op">=</span> pd.DataFrame(array_with_labels, columns<span class="op">=</span>df.columns, index<span class="op">=</span>df.index)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the restored DataFrame</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_restored)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>    A   B   C
0  10  20  30
1  40  50  60
2  70  80  90</code></pre>
</div>
</div>
<p>Note that you need to manually pass <code>columns</code> and <code>index</code> back when re-creating the DataFrame.</p>
</section>
<section id="practice-user-cases" class="level3" data-number="6.11.5">
<h3 data-number="6.11.5" class="anchored" data-anchor-id="practice-user-cases"><span class="header-section-number">6.11.5</span> Practice User Cases</h3>
<section id="case-1-adding-labels-to-a-numpy-array" class="level4" data-number="6.11.5.1">
<h4 data-number="6.11.5.1" class="anchored" data-anchor-id="case-1-adding-labels-to-a-numpy-array"><span class="header-section-number">6.11.5.1</span> Case 1: Adding labels to a NumPy Array</h4>
<div id="0c7759ba" class="cell" data-execution_count="4">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co"># NumPy array without labels</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.random.rand(<span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add labels by converting to a DataFrame</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>df_with_labels <span class="op">=</span> pd.DataFrame(data, columns<span class="op">=</span>[<span class="st">'Feature1'</span>, <span class="st">'Feature2'</span>, <span class="st">'Feature3'</span>])</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_with_labels)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Feature1  Feature2  Feature3
0  0.867644  0.478449  0.684584
1  0.378309  0.860889  0.096055
2  0.168311  0.981326  0.685720
3  0.459235  0.340368  0.396904</code></pre>
</div>
</div>
</section>
<section id="case-2-perform-numerical-computations" class="level4" data-number="6.11.5.2">
<h4 data-number="6.11.5.2" class="anchored" data-anchor-id="case-2-perform-numerical-computations"><span class="header-section-number">6.11.5.2</span> Case 2: Perform Numerical Computations</h4>
<div id="91c76d9b" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># DataFrame for tabular manipulation</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({<span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], <span class="st">'B'</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]})</span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert to NumPy for computations</span></span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>array <span class="op">=</span> df.to_numpy()</span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a NumPy operation</span></span>
<span id="cb129-8"><a href="#cb129-8" aria-hidden="true" tabindex="-1"></a>array_squared <span class="op">=</span> np.square(array)</span>
<span id="cb129-9"><a href="#cb129-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-10"><a href="#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert back to a DataFrame</span></span>
<span id="cb129-11"><a href="#cb129-11" aria-hidden="true" tabindex="-1"></a>df_squared <span class="op">=</span> pd.DataFrame(array_squared, columns<span class="op">=</span>df.columns)</span>
<span id="cb129-12"><a href="#cb129-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   A   B
0  1  16
1  4  25
2  9  36</code></pre>
</div>
</div>
</section>
</section>
<section id="best-practices" class="level3" data-number="6.11.6">
<h3 data-number="6.11.6" class="anchored" data-anchor-id="best-practices"><span class="header-section-number">6.11.6</span> Best Practices</h3>
<ul>
<li><strong>Check Data Types</strong>: Ensure the data in your DataFrame is numerical before converting to NumPy for computations.</li>
</ul>
<div id="7334c88b" class="cell" data-execution_count="7">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.dtypes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>A    int64
B    int64
dtype: object</code></pre>
</div>
</div>
<ul>
<li><strong>Handle Missing Values</strong>: Fill or drop missing values (NaN) in DataFrames before conversion to avoid errors in NumPy.</li>
</ul>
<div id="69623061" class="cell" data-execution_count="8">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.fillna(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li><p><strong>Optimize for Performance</strong>: Use NumPy for heavy numerical computations and pandas for data manipulation.</p></li>
<li><p><strong>Convert Back to pandas for Analysis</strong>: After computations, convert the NumPy array back to pandas if you need labeled data for further analysis or visualization.</p></li>
</ul>
</section>
<section id="comparison-table" class="level3" data-number="6.11.7">
<h3 data-number="6.11.7" class="anchored" data-anchor-id="comparison-table"><span class="header-section-number">6.11.7</span> Comparison Table</h3>
<table class="caption-top table">
<colgroup>
<col style="width: 28%">
<col style="width: 38%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th><strong>Operation</strong></th>
<th><strong>pandas DataFrame</strong></th>
<th><strong>NumPy Array</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Row/Column Labels</strong></td>
<td>Yes</td>
<td>No</td>
</tr>
<tr class="even">
<td><strong>Indexing</strong></td>
<td>Label-based (<code>loc</code>, <code>iloc</code>)</td>
<td>Integer-based only</td>
</tr>
<tr class="odd">
<td><strong>Mathematical Ops</strong></td>
<td>Slower (handles metadata)</td>
<td>Faster</td>
</tr>
<tr class="even">
<td><strong>Missing Data</strong></td>
<td>Supports (<code>NaN</code>)</td>
<td>Does not support (<code>NaN</code>)</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="random-number-generation-in-numpy" class="level2" data-number="6.12">
<h2 data-number="6.12" class="anchored" data-anchor-id="random-number-generation-in-numpy"><span class="header-section-number">6.12</span> Random Number Generation in NumPy</h2>
<p>NumPy provides a variety of functions for generating random numbers through its numpy.random module. These functions can generate random numbers for different distributions and array shapes, making them essential for simulations, statistical sampling, and machine learning applications.</p>
<section id="key-functions-for-random-number-generation-in-numpy" class="level3" data-number="6.12.1">
<h3 data-number="6.12.1" class="anchored" data-anchor-id="key-functions-for-random-number-generation-in-numpy"><span class="header-section-number">6.12.1</span> Key Functions for Random Number Generation in NumPy</h3>
<ol type="1">
<li><code>np.random.rand()</code>: Generates random numbers from a uniform distribution between 0 and 1.</li>
</ol>
<div id="57fc7f08" class="cell" data-execution_count="67">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a 2x3 array of random values between 0 and 1</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>rand_array <span class="op">=</span> np.random.rand(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(rand_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.59160333 0.1864713  0.70446818]
 [0.46476414 0.75172527 0.2225734 ]]</code></pre>
</div>
</div>
<ol start="2" type="1">
<li><code>np.random.randn()</code>: Generates random numbers from a standard normal distribution (mean = 0, standard deviation = 1). It is useful for simulating Gaussian distributed data</li>
</ol>
<div id="342e2991" class="cell" data-execution_count="68">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>normal_array <span class="op">=</span> np.random.randn(<span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(normal_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 0.96287539 -0.57932461 -0.25728454]
 [ 0.33379165  0.01331971 -0.19328112]
 [-0.79966965 -1.20325527  1.50081961]]</code></pre>
</div>
</div>
<p>NumPy’s <a href="https://numpy.org/doc/stable/reference/random/index.html">random</a> module can be used to generate arrays of random numbers from several different probability distributions. For example, a <code>3x5</code> array of uniformly distributed random numbers can be generated using the <code>uniform</code> function of the <code>random</code> module.</p>
<ol start="3" type="1">
<li><code>np.random.randint()</code>: Generate random integers within a specific range, you can specify <code>low</code> and <code>high</code> values and the shape of the output array</li>
</ol>
<div id="4c5a2497" class="cell" data-execution_count="69">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a 4x4 matrix of random integers between 10 and 20</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>int_array <span class="op">=</span> np.random.randint(<span class="dv">10</span>, <span class="dv">20</span>, (<span class="dv">4</span>, <span class="dv">4</span>))</span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(int_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[[13 17 15 18]
 [10 11 13 15]
 [13 12 12 13]
 [17 14 11 16]]</code></pre>
</div>
</div>
<ol start="4" type="1">
<li><code>np.random.choice()</code>: Random selects elements from an input array</li>
</ol>
<div id="0577f9dc" class="cell" data-execution_count="70">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Select 5 random elements from the array [1, 2, 3, 4, 5] with replacement</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>choice_array <span class="op">=</span> np.random.choice([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], size<span class="op">=</span><span class="dv">5</span>, replace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(choice_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[4 3 5 2 2]</code></pre>
</div>
</div>
<ol start="5" type="1">
<li><code>np.random.uniform()</code>: Generates random floating-point numbers between a specified range (low, high) that follow uniform distribution</li>
</ol>
<div id="40c55cd9" class="cell" data-execution_count="71">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate 6 random numbers from a normal distribution with mean=10 and std=2</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>custom_normal <span class="op">=</span> np.random.normal(<span class="dv">10</span>, <span class="dv">2</span>, size<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(custom_normal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[ 8.96337061  9.80411528  7.1623284   9.58883996 11.82330829 10.53508984]</code></pre>
</div>
</div>
<div id="5398c485" class="cell" data-execution_count="72">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate a 1D array of 5 random numbers between -5 and 5</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>uniform_array <span class="op">=</span> np.random.uniform(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, size<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(uniform_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[-4.76424391 -2.90776829  4.56871733  2.3230159  -4.72083461]</code></pre>
</div>
</div>
<ol start="6" type="1">
<li><code>np.random.normal()</code>: Generates random numbers from a normal distribution with a specified mean and standard deviation.</li>
</ol>
<div id="cff1bf6d" class="cell" data-execution_count="73">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>np.random.uniform(size <span class="op">=</span> (<span class="dv">3</span>,<span class="dv">5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="73">
<pre><code>array([[0.66198756, 0.76365694, 0.79924355, 0.80723229, 0.0661366 ],
       [0.5777333 , 0.49288606, 0.02914087, 0.61883579, 0.04236321],
       [0.2049758 , 0.9819383 , 0.65983787, 0.87025466, 0.39354816]])</code></pre>
</div>
</div>
<p>For a full list, please check the <a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.randint.html">offcial website</a></p>
<p>Random numbers can also be generated by Python’s built-in <a href="https://docs.python.org/3/library/random.html">random</a> module. However, it generates one random number at a time, which makes it much slower than NumPy’s random module.</p>
</section>
</section>
<section id="independent-practice" class="level2" data-number="6.13">
<h2 data-number="6.13" class="anchored" data-anchor-id="independent-practice"><span class="header-section-number">6.13</span> Independent Practice:</h2>
<section id="practice-exercise-1" class="level3" data-number="6.13.1">
<h3 data-number="6.13.1" class="anchored" data-anchor-id="practice-exercise-1"><span class="header-section-number">6.13.1</span> Practice exercise 1</h3>
<section id="section" class="level4" data-number="6.13.1.1">
<h4 data-number="6.13.1.1" class="anchored" data-anchor-id="section"><span class="header-section-number">6.13.1.1</span> </h4>
<p>Read the coordinates of the capital cities of the world from https://gist.github.com/ofou/df09a6834a8421b4f376c875194915c9 .</p>
<p>Task 1: Use NumPy to print the name and coordinates of the capital city closest to the US capital - Washington DC.</p>
<p>Note that:</p>
<ol type="1">
<li>The <em>Country Name</em> for US is given as <em>United States of America</em> in the data.</li>
<li>The ‘closeness’ of capital cities from the US capital is based on the Euclidean distance of their coordinates to those of the US capital.</li>
</ol>
<p><strong>Hints:</strong></p>
<ol type="1">
<li>Use the <em>to_numpy()</em> function of the <em>Pandas DataFrame</em> class to convert a DataFrame to a Numpy array</li>
<li>Use <em>broadcasting</em> to compute the euclidean distance of capital cities from Washington DC.</li>
<li>Use <code>np.argmin</code> to locate the index of the minimum value in an array</li>
<li>Exclude the capital itself to avoid trivial zero values in the results.</li>
</ol>
<p><strong>Solution:</strong></p>
<div id="48813071" class="cell" data-execution_count="77">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>capital_cities <span class="op">=</span> pd.read_csv(<span class="st">'./datasets/country-capital-lat-long-population.csv'</span>)</span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>coordinates_capital_cities <span class="op">=</span> capital_cities[[<span class="st">'Latitude'</span>, <span class="st">'Longitude'</span>]].to_numpy()</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>us_coordinates <span class="op">=</span> capital_cities.loc[capital_cities[<span class="st">'Country'</span>]<span class="op">==</span><span class="st">'United States of America'</span>,[<span class="st">'Latitude'</span>,<span class="st">'Longitude'</span>]].to_numpy()</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Broadcasting</span></span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>distance_from_DC <span class="op">=</span> np.sqrt(np.<span class="bu">sum</span>((us_coordinates<span class="op">-</span>coordinates_capital_cities)<span class="op">**</span><span class="dv">2</span>,axis<span class="op">=</span><span class="dv">1</span>))</span>
<span id="cb148-8"><a href="#cb148-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-9"><a href="#cb148-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Assigning a high value of distance to DC, otherwise it will itself be selected as being closest to DC</span></span>
<span id="cb148-10"><a href="#cb148-10" aria-hidden="true" tabindex="-1"></a>distance_from_DC[distance_from_DC<span class="op">==</span><span class="dv">0</span>]<span class="op">=</span><span class="dv">9999</span></span>
<span id="cb148-11"><a href="#cb148-11" aria-hidden="true" tabindex="-1"></a>closest_capital_index <span class="op">=</span> np.argmin(distance_from_DC)</span>
<span id="cb148-12"><a href="#cb148-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Closest capital city is:"</span> ,capital_cities.loc[closest_capital_index,<span class="st">'Capital City'</span>])</span>
<span id="cb148-13"><a href="#cb148-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coordinates of the closest capital city are:"</span>,coordinates_capital_cities[closest_capital_index,:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Closest capital city is: Ottawa-Gatineau
Coordinates of the closest capital city are: [ 45.4166 -75.698 ]</code></pre>
</div>
</div>
<p>Task 2: Use NumPy to:</p>
<ol type="1">
<li><p>Print the names of the countries of the top 10 capital cities closest to the US capital - Washington DC.</p></li>
<li><p>Create and print a NumPy array containing the coordinates of the top 10 cities.</p></li>
</ol>
<p><strong>Hint:</strong> Use the <em>concatenate()</em> function from the <em>NumPy</em> library to stack the coordinates of the top 10 cities.</p>
<div id="3af344b1" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>top10_cities_coordinates <span class="op">=</span> coordinates_capital_cities[closest_capital_index,:].reshape(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Top 10 countries closest to Washington DC are:</span><span class="ch">\n</span><span class="st"> Canada"</span>)</span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">9</span>):</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a>    distance_from_DC[closest_capital_index]<span class="op">=</span><span class="dv">9999</span></span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>    closest_capital_index <span class="op">=</span> np.argmin(distance_from_DC)</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(capital_cities.loc[closest_capital_index,<span class="st">'Country'</span>])</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>    top10_cities_coordinates<span class="op">=</span>np.concatenate((top10_cities_coordinates,coordinates_capital_cities[closest_capital_index,:].reshape(<span class="dv">1</span>,<span class="dv">2</span>)))</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Coordinates of the top 10 cities closest to US are: </span><span class="ch">\n</span><span class="st">"</span>,top10_cities_coordinates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Top 10 countries closest to Washington DC are:
 Canada
Cuba
Turks and Caicos Islands
Cayman Islands
Haiti
Jamaica
Dominican Republic
Saint Pierre and Miquelon
Puerto Rico
United States Virgin Islands
Coordinates of the top 10 cities closest to US are: 
 [[ 32.2915 -64.778 ]
 [ 23.1195 -82.3785]
 [ 21.4612 -71.1419]
 [ 19.2866 -81.3744]
 [ 18.5392 -72.335 ]
 [ 17.997  -76.7936]
 [ 18.4896 -69.9018]
 [ 46.7738 -56.1815]
 [ 18.4663 -66.1057]
 [ 18.3419 -64.9307]]</code></pre>
</div>
</div>
</section>
</section>
<section id="practice-exercise-2" class="level3" data-number="6.13.2">
<h3 data-number="6.13.2" class="anchored" data-anchor-id="practice-exercise-2"><span class="header-section-number">6.13.2</span> Practice exercise 2:</h3>
<p>This exercise will show vectorized computations with NumPy. Vectorized computations help perform computations more efficiently, and also make the code concise.</p>
<p><strong>Q:</strong> Read the (1) quantities of roll, bun, cake and bread required by 3 people - Ben, Barbara &amp; Beth, from <em>food_quantity.csv</em>, (2) price of these food items in two shops - Target and Kroger, from <em>price.csv</em>. Find out which shop should each person go to minimize their expenses.</p>
<div id="3d74d0b1" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading the datasets on food quantity and price</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>food_qty <span class="op">=</span> pd.read_csv(<span class="st">'../data/food_quantity.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> pd.read_csv(<span class="st">'../data/price.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="b32dd9f9" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a>food_qty</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">roll</th>
<th data-quarto-table-cell-role="th">bun</th>
<th data-quarto-table-cell-role="th">cake</th>
<th data-quarto-table-cell-role="th">bread</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Person</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ben</td>
<td>6</td>
<td>5</td>
<td>3</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Barbara</td>
<td>3</td>
<td>6</td>
<td>2</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Beth</td>
<td>3</td>
<td>4</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="0804222b" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>price</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Target</th>
<th data-quarto-table-cell-role="th">Kroger</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Item</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">roll</td>
<td>1.5</td>
<td>1.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bun</td>
<td>2.0</td>
<td>2.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">cake</td>
<td>5.0</td>
<td>4.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">bread</td>
<td>16.0</td>
<td>17.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>First, let’s start from a simple problem. We’ll compute the expenses of Ben if he prefers to buy all food items from Target</p>
<div id="54998b3d" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write a for loop to calculate the total cost of Ben's food if he shops at the Target store</span></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>total_cost <span class="op">=</span> <span class="dv">0</span> </span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> food <span class="kw">in</span> food_qty.columns:</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>    total_cost <span class="op">+=</span> food_qty.loc[<span class="st">'Ben'</span>,food]<span class="op">*</span>price.loc[food,<span class="st">'Target'</span>]</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>total_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 0 ns
Wall time: 0 ns</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(50.0)</code></pre>
</div>
</div>
<div id="799d2503" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using numpy </span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>total_cost <span class="op">=</span> np.<span class="bu">sum</span>(food_qty.loc[<span class="st">'Ben'</span>,]<span class="op">*</span>price.loc[:,<span class="st">'Target'</span>])</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>total_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 0 ns
Wall time: 1 ms</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>np.float64(50.0)</code></pre>
</div>
</div>
<p>Ben will spend $50 if he goes to Target</p>
<p>Now, let’s add another layer of complication. We’ll compute Ben’s expenses for both stores - Target and Kroger</p>
<div id="66675a35" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using loops to calculate the total cost of food for Ben for all stores</span></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>total_cost <span class="op">=</span> {}</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> store <span class="kw">in</span> price.columns:</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>    total_cost[store] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> food <span class="kw">in</span> food_qty.columns:</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>        total_cost[store] <span class="op">+=</span> food_qty.loc[<span class="st">'Ben'</span>,food]<span class="op">*</span>price.loc[food,store]</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>total_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 0 ns
Wall time: 1 ms</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>{'Target': np.float64(50.0), 'Kroger': np.float64(49.0)}</code></pre>
</div>
</div>
<div id="8c385089" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using numpy</span></span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>total_cost <span class="op">=</span> np.dot(food_qty.loc[<span class="st">'Ben'</span>,],price.loc[:,:])</span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>total_cost</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 0 ns
Wall time: 0 ns</code></pre>
</div>
<div class="cell-output cell-output-display">
<pre><code>array([50., 49.])</code></pre>
</div>
</div>
<p>Ben will spend $50 if he goes to Target, and $49 if he goes to Kroger. Thus, he should choose Kroger.</p>
<p>Now, let’s add the final layer of complication, and solve the problem. We’ll compute everyone’s expenses for both stores - Target and Kroger</p>
<div id="cb8e936a" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a>store_expense <span class="op">=</span> pd.DataFrame(<span class="fl">0.0</span>, columns<span class="op">=</span>price.columns, index <span class="op">=</span> food_qty.index)</span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> person <span class="kw">in</span> store_expense.index:</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> store <span class="kw">in</span> store_expense.columns:</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> food <span class="kw">in</span> food_qty.columns:</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>            store_expense.loc[person, store] <span class="op">+=</span> food_qty.loc[person, food]<span class="op">*</span>price.loc[food, store]</span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>store_expense</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>1.51 ms ± 15.3 μs per loop (mean ± std. dev. of 7 runs, 1,000 loops each)</code></pre>
</div>
</div>
<div id="db6f3c2e" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>timeit</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using matrix multiplication in numpy</span></span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(np.dot(food_qty.values, price.values), columns<span class="op">=</span>price.columns, index<span class="op">=</span>food_qty.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>11 μs ± 102 ns per loop (mean ± std. dev. of 7 runs, 100,000 loops each)</code></pre>
</div>
</div>
<p>Based on the above table, Ben should go to Kroger, Barbara to Target and Beth can go to either store.</p>
<p>As the complexity of operations increases, the number of nested for-loops tends to grow, making the code more cumbersome and difficult to manage. In contrast, leveraging NumPy arrays allows for concise and straightforward implementation, regardless of the complexity. Vectorized computations are not only cleaner but also significantly faster, offering a more efficient solution. To take advantage of this, you first need to convert a pandas DataFrame to a NumPy array for matrix multiplication. Once the computation is complete, you can convert the results back to a pandas DataFrame for further analysis or display</p>
</section>
<section id="practice-exercise-3" class="level3" data-number="6.13.3">
<h3 data-number="6.13.3" class="anchored" data-anchor-id="practice-exercise-3"><span class="header-section-number">6.13.3</span> Practice exercise 3</h3>
<p>Use matrix multiplication to find the average IMDB rating and average Rotten tomatoes rating for each genre - comedy, action, drama and horror. Use the data: <em>movies_cleaned.csv</em>. Which is the most preferred genre for IMDB users, and which is the least preferred genre for Rotten Tomatoes users?</p>
<p><strong>Hint:</strong> 1. Create two matrices - one containing the IMDB and Rotten Tomatoes ratings, and the other containing the genre flags (comedy/action/drama/horror).</p>
<ol start="2" type="1">
<li><p>Multiply the two matrices created in 1.</p></li>
<li><p>Divide each row/column of the resulting matrix by a vector having the number of ratings in each genre to get the average rating for the genre.</p></li>
</ol>
<p><strong>Solution:</strong></p>
<div id="29d9e74a" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> pd.read_csv(<span class="st">'../Data/movies_cleaned.csv'</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a>data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Title</th>
<th data-quarto-table-cell-role="th">IMDB Rating</th>
<th data-quarto-table-cell-role="th">Rotten Tomatoes Rating</th>
<th data-quarto-table-cell-role="th">Running Time min</th>
<th data-quarto-table-cell-role="th">Release Date</th>
<th data-quarto-table-cell-role="th">US Gross</th>
<th data-quarto-table-cell-role="th">Worldwide Gross</th>
<th data-quarto-table-cell-role="th">Production Budget</th>
<th data-quarto-table-cell-role="th">comedy</th>
<th data-quarto-table-cell-role="th">Action</th>
<th data-quarto-table-cell-role="th">drama</th>
<th data-quarto-table-cell-role="th">horror</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>Broken Arrow</td>
<td>5.8</td>
<td>55</td>
<td>108</td>
<td>Feb 09 1996</td>
<td>70645997</td>
<td>148345997</td>
<td>65000000</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Brazil</td>
<td>8.0</td>
<td>98</td>
<td>136</td>
<td>Dec 18 1985</td>
<td>9929135</td>
<td>9929135</td>
<td>15000000</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>The Cable Guy</td>
<td>5.8</td>
<td>52</td>
<td>95</td>
<td>Jun 14 1996</td>
<td>60240295</td>
<td>102825796</td>
<td>47000000</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>Chain Reaction</td>
<td>5.2</td>
<td>13</td>
<td>106</td>
<td>Aug 02 1996</td>
<td>21226204</td>
<td>60209334</td>
<td>55000000</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>Clash of the Titans</td>
<td>5.9</td>
<td>65</td>
<td>108</td>
<td>Jun 12 1981</td>
<td>30000000</td>
<td>30000000</td>
<td>15000000</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="fc1148a2" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting ratings of all movies</span></span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a>drating <span class="op">=</span> data[[<span class="st">'IMDB Rating'</span>,<span class="st">'Rotten Tomatoes Rating'</span>]]</span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>drating_num <span class="op">=</span> drating.to_numpy() <span class="co">#Converting the data to NumPy array</span></span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>drating_num</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>array([[ 5.8, 55. ],
       [ 8. , 98. ],
       [ 5.8, 52. ],
       ...,
       [ 7. , 65. ],
       [ 5.7, 26. ],
       [ 6.7, 82. ]])</code></pre>
</div>
</div>
<div id="e1d22e46" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Getting the matrix indicating the genre of all movies</span></span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a>dgenre <span class="op">=</span> data.iloc[:,<span class="dv">8</span>:<span class="dv">12</span>]</span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>dgenre_num <span class="op">=</span> dgenre.to_numpy() <span class="co">#Converting the data to NumPy array</span></span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>dgenre_num</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>array([[0, 1, 0, 0],
       [1, 0, 0, 0],
       [1, 0, 0, 0],
       ...,
       [1, 0, 0, 0],
       [0, 1, 0, 0],
       [0, 1, 0, 0]])</code></pre>
</div>
</div>
<p>We’ll first find the total IMDB and Rotten tomatoes ratings for all movies of each genre, and then divide them by the number of movies of the corresponding genre to find the average rating for the genre.</p>
<p>For finding the total IMDB and Rotten tomatoes ratings, we’ll multiply <code>drating_num</code> with <code>dgenre_num</code>. However, before multiplying, we’ll check if their shapes are compatible for matrix multiplication.</p>
<div id="d62bf976" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Shape of drating_num</span></span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a>drating_num.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>(980, 2)</code></pre>
</div>
</div>
<div id="f80cba5f" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Shape of dgenre_num</span></span>
<span id="cb178-2"><a href="#cb178-2" aria-hidden="true" tabindex="-1"></a>dgenre_num.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>(980, 4)</code></pre>
</div>
</div>
<p>Note that the above shapes are not compatible for matrix multiplication. We’ll transpose <code>dgenre_num</code> to make the shapes compatible.</p>
<div id="73ddbf46" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Total IMDB and Rotten tomatoes ratings for each genre</span></span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>ratings_sum_genre <span class="op">=</span> drating_num.T.dot(dgenre_num)</span>
<span id="cb180-3"><a href="#cb180-3" aria-hidden="true" tabindex="-1"></a>ratings_sum_genre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>array([[ 1785.6,  1673.1,  1630.3,   946.2],
       [14119. , 13725. , 14535. ,  6533. ]])</code></pre>
</div>
</div>
<div id="c3c2342e" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of movies in the data will be stored in 'rows', and number of columns stored in 'cols'</span></span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a>rows, cols <span class="op">=</span> data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="777d260b" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb183"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Getting number of movies in each genre</span></span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>movies_count_genre <span class="op">=</span> dgenre_num.T.dot(np.ones(rows))</span>
<span id="cb183-3"><a href="#cb183-3" aria-hidden="true" tabindex="-1"></a>movies_count_genre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>array([302., 264., 239., 154.])</code></pre>
</div>
</div>
<div id="4a7c4ed6" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Finding the average IMDB and average Rotten tomatoes ratings for each genre</span></span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>ratings_sum_genre<span class="op">/</span>movies_count_genre</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<pre><code>array([[ 5.91258278,  6.3375    ,  6.82133891,  6.14415584],
       [46.75165563, 51.98863636, 60.81589958, 42.42207792]])</code></pre>
</div>
</div>
<div id="28b514ac" class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(ratings_sum_genre<span class="op">/</span>movies_count_genre,columns <span class="op">=</span> [<span class="st">'comedy'</span>,<span class="st">'Action'</span>,<span class="st">'drama'</span>,<span class="st">'horror'</span>],</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a>             index <span class="op">=</span> [<span class="st">'IMDB Rating'</span>,<span class="st">'Rotten Tomatoes Rating'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">comedy</th>
<th data-quarto-table-cell-role="th">Action</th>
<th data-quarto-table-cell-role="th">drama</th>
<th data-quarto-table-cell-role="th">horror</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">IMDB Rating</td>
<td>5.912583</td>
<td>6.337500</td>
<td>6.821339</td>
<td>6.144156</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Rotten Tomatoes Rating</td>
<td>46.751656</td>
<td>51.988636</td>
<td>60.815900</td>
<td>42.422078</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>IMDB users prefer <em>drama</em>, and are amused the least by <em>comedy</em> movies, on an average. However, Rotten tomatoes critics would rather watch <em>comedy</em> than <em>horror</em> movies, on an average.</p>
</section>
<section id="practice-exercise-4" class="level3" data-number="6.13.4">
<h3 data-number="6.13.4" class="anchored" data-anchor-id="practice-exercise-4"><span class="header-section-number">6.13.4</span> Practice exercise 4:</h3>
<p><strong>Random number generation using NumPy</strong></p>
<p>Suppose 500 people eat at Food cart 1, and another 500 eat at Food cart 2, everyday.</p>
<p>The waiting time at Food cart 2 has a normal distribution with mean 8 minutes and standard deviation 3 minutes, while the waiting time at Food cart 1 has a uniform distribution with minimum 5 minutes and maximum 25 minutes.</p>
<p>Simulate a dataset containing waiting times for 500 ppl for 30 days in each of the food joints. Assume that the waiting times are measured simultaneously at a certain time in both places, i.e., the observations are paired.</p>
<p><strong>On how many days is the average waiting time at Food cart 2 higher than that at Food cart 1?</strong></p>
<p><strong>What percentage of times the waiting time at Food cart 2 was higher than the waiting time at Food cart 1?</strong></p>
<p>Try both approaches: (1) Using loops to generate data, (2) numpy array to generate data. Compare the time taken in both approaches.</p>
<div id="ac8f7a1a" class="cell" data-execution_count="49">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> time <span class="im">as</span> tm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div id="e49ca4cc" class="cell" data-execution_count="52">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb189"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Method 1: Using loops</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> tm.time() <span class="co">#Current system time</span></span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Initializing waiting times for 500 ppl over 30 days</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>waiting_times_FoodCart1 <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>,index<span class="op">=</span><span class="bu">range</span>(<span class="dv">500</span>),columns<span class="op">=</span><span class="bu">range</span>(<span class="dv">30</span>)) <span class="co">#FoodCart1</span></span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a>waiting_times_FoodCart2 <span class="op">=</span> pd.DataFrame(<span class="dv">0</span>,index<span class="op">=</span><span class="bu">range</span>(<span class="dv">500</span>),columns<span class="op">=</span><span class="bu">range</span>(<span class="dv">30</span>)) <span class="co">#FoodCart2</span></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random <span class="im">as</span> rm</span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">500</span>):  <span class="co">#Iterating over 500 ppl</span></span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">30</span>): <span class="co">#Iterating over 30 days</span></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a>        waiting_times_FoodCart2.iloc[i,j] <span class="op">=</span> rm.gauss(<span class="dv">8</span>,<span class="dv">3</span>) <span class="co">#Simulating waiting time in FoodCart2 for the ith person on jth day</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>        waiting_times_FoodCart1.iloc[i,j] <span class="op">=</span> rm.uniform(<span class="dv">5</span>,<span class="dv">25</span>) <span class="co">#Simulating waiting time in FoodCart1 for the ith person on jth day</span></span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a>time_diff <span class="op">=</span> waiting_times_FoodCart2<span class="op">-</span>waiting_times_FoodCart1</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"On "</span>,<span class="bu">sum</span>(time_diff.mean()<span class="op">&gt;</span><span class="dv">0</span>),<span class="st">" days, the average waiting time at FoodCart2 higher than that at FoodCart1"</span>)</span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Percentage of times waiting time at FoodCart2 was greater than that at FoodCart1 = "</span>,<span class="dv">100</span><span class="op">*</span>(time_diff<span class="op">&gt;</span><span class="dv">0</span>).<span class="bu">sum</span>().<span class="bu">sum</span>()<span class="op">/</span>(<span class="dv">30</span><span class="op">*</span><span class="dv">500</span>),<span class="st">"%"</span>)</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> tm.time() <span class="co">#Current system time</span></span>
<span id="cb189-17"><a href="#cb189-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken = "</span>, end_time<span class="op">-</span>start_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>On  0  days, the average waiting time at FoodCart2 higher than that at FoodCart1
Percentage of times waiting time at FoodCart2 was greater than that at FoodCart1 =  16.226666666666667 %
Time taken =  4.521248817443848</code></pre>
</div>
</div>
<div id="2308730c" class="cell" data-execution_count="53">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Method 2: Using NumPy arrays</span></span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a>start_time <span class="op">=</span> tm.time()</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a>waiting_time_FoodCart2 <span class="op">=</span> np.random.normal(<span class="dv">8</span>,<span class="dv">3</span>,size <span class="op">=</span> (<span class="dv">500</span>,<span class="dv">30</span>)) <span class="co">#Simultaneously generating the waiting times of 500 ppl over 30 days in FoodCart2</span></span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>waiting_time_FoodCart1 <span class="op">=</span> np.random.uniform(<span class="dv">5</span>,<span class="dv">25</span>,size <span class="op">=</span> (<span class="dv">500</span>,<span class="dv">30</span>)) <span class="co">#Simultaneously generating the waiting times of 500 ppl over 30 days in FoodCart1</span></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>time_diff <span class="op">=</span> waiting_time_FoodCart2<span class="op">-</span>waiting_time_FoodCart1</span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"On "</span>,(time_diff.mean()<span class="op">&gt;</span><span class="dv">0</span>).<span class="bu">sum</span>(),<span class="st">" days, the average waiting time at FoodCart2 higher than that at FoodCart1"</span>)</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Percentage of times waiting time at FoodCart2 was greater than that at FoodCart1 = "</span>,<span class="dv">100</span><span class="op">*</span>(time_diff<span class="op">&gt;</span><span class="dv">0</span>).<span class="bu">sum</span>()<span class="op">/</span><span class="dv">15000</span>,<span class="st">"%"</span>)</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>end_time <span class="op">=</span> tm.time()</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Time taken = "</span>, end_time<span class="op">-</span>start_time)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>On  0  days, the average waiting time at FoodCart2 higher than that at FoodCart1
Percentage of times waiting time at FoodCart2 was greater than that at FoodCart1 =  16.52 %
Time taken =  0.008000850677490234</code></pre>
</div>
</div>
<p>The approach with NumPy is much faster than the one with loops.</p>
</section>
<section id="practice-exercise-5" class="level3" data-number="6.13.5">
<h3 data-number="6.13.5" class="anchored" data-anchor-id="practice-exercise-5"><span class="header-section-number">6.13.5</span> Practice exercise 5</h3>
<p><strong>Bootstrapping:</strong> Find the 95% confidence interval of mean profit for ‘Action’ movies, using Bootstrapping.</p>
<p>Bootstrapping is a non-parametric method for obtaining confidence interval. Use the algorithm below to find the confidence interval:</p>
<ol type="1">
<li>Find the profit for each of the ‘Action’ movies. Suppose there are <em>N</em> such movies. We will have a <em>Profit</em> column with <em>N</em> values.<br>
</li>
<li>Randomly sample <em>N</em> values with replacement from the <em>Profit</em> column<br>
</li>
<li>Find the mean of the <em>N</em> values obtained in (b)<br>
</li>
<li>Repeat steps (b) and (c) <em>M=1000</em> times<br>
</li>
<li>The 95% Confidence interval is the range between the 2.5% and 97.5% percentile values of the 1000 means obtained in (c)<br>
Use the <em>movies_cleaned.csv</em> dataset.</li>
</ol>
<p><strong>Solution:</strong></p>
<div id="0422d661" class="cell" data-execution_count="44">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Reading data</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a>movies <span class="op">=</span> pd.read_csv(<span class="st">'./Datasets/movies_cleaned.csv'</span>)</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Filtering action movies</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a>movies_action <span class="op">=</span> movies.loc[movies[<span class="st">'Action'</span>]<span class="op">==</span><span class="dv">1</span>,:]</span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Computing profit of movies</span></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a>movies_action.loc[:,<span class="st">'Profit'</span>] <span class="op">=</span> movies_action.loc[:,<span class="st">'Worldwide Gross'</span>] <span class="op">-</span> movies_action.loc[:,<span class="st">'Production Budget'</span>]</span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-10"><a href="#cb193-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Subsetting the profit column</span></span>
<span id="cb193-11"><a href="#cb193-11" aria-hidden="true" tabindex="-1"></a>profit_vec <span class="op">=</span> movies_action[<span class="st">'Profit'</span>]</span>
<span id="cb193-12"><a href="#cb193-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-13"><a href="#cb193-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating a matrix of 1000 samples with replacement from the profit column</span></span>
<span id="cb193-14"><a href="#cb193-14" aria-hidden="true" tabindex="-1"></a>bootstrap_samples<span class="op">=</span>np.random.choice(profit_vec,size <span class="op">=</span> (<span class="dv">1000</span>,<span class="bu">len</span>(profit_vec)))</span>
<span id="cb193-15"><a href="#cb193-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-16"><a href="#cb193-16" aria-hidden="true" tabindex="-1"></a><span class="co">#Computing the mean of each of the 1000 samples</span></span>
<span id="cb193-17"><a href="#cb193-17" aria-hidden="true" tabindex="-1"></a>bootstrap_sample_means <span class="op">=</span> bootstrap_samples.mean(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb193-18"><a href="#cb193-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-19"><a href="#cb193-19" aria-hidden="true" tabindex="-1"></a><span class="co">#The confidence interval is the 2.5th and 97.5th percentile of the mean of the 1000 samples</span></span>
<span id="cb193-20"><a href="#cb193-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Confidence interval = [$"</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(np.percentile(bootstrap_sample_means,<span class="fl">2.5</span>)<span class="op">/</span><span class="fl">1e6</span>,<span class="dv">2</span>))<span class="op">+</span><span class="st">" million, $"</span><span class="op">+</span><span class="bu">str</span>(np.<span class="bu">round</span>(np.percentile(bootstrap_sample_means,<span class="fl">97.5</span>)<span class="op">/</span><span class="fl">1e6</span>,<span class="dv">2</span>))<span class="op">+</span><span class="st">" million]"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Confidence interval = [$132.53 million, $182.69 million]</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./data_structures.html" class="pagination-link" aria-label="Data structures">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data structures</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Pandas.html" class="pagination-link" aria-label="Pandas">
        <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>