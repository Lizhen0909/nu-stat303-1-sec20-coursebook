<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Pandas – Data Science I with python</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Reading data.html" rel="next">
<link href="./NumPy.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./NumPy.html">Core library foundations</a></li><li class="breadcrumb-item"><a href="./Pandas.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="https://statistics.northwestern.edu/" class="sidebar-logo-link">
      <img src="./NU_Stat_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Data Science I with python</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vscode_setup.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Setting up your environment with VS Code</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_venv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Python Environments and Package Management</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./workflow_enhance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Enhancing Workflow in Jupyter Notebooks</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Python refresher</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./python_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Python Basics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_structures.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Data structures</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Core library foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NumPy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Pandas.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Reading data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Reading Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./data_types_in_pandas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">More on Pandas</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introduction to Data Visualization</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Advanced_Data_Visualization.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Advanced Data Visualization</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">From messy to insight</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data cleaning and preparation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Data Cleaning and Preparation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data aggregation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Data Grouping and Aggregation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Data wrangling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Data Reshaping and Enrichment</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Assignment A.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Assignment A</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Datasets &amp; Templates</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">7.1</span> Introduction</a></li>
  <li><a href="#pandas-data-structures---series-and-dataframe" id="toc-pandas-data-structures---series-and-dataframe" class="nav-link" data-scroll-target="#pandas-data-structures---series-and-dataframe"><span class="header-section-number">7.2</span> Pandas data structures - Series and DataFrame</a></li>
  <li><a href="#creating-a-pandas-series-dataframe" id="toc-creating-a-pandas-series-dataframe" class="nav-link" data-scroll-target="#creating-a-pandas-series-dataframe"><span class="header-section-number">7.3</span> Creating a Pandas Series / DataFrame</a>
  <ul>
  <li><a href="#creating-a-seriesdataframe-from-python-list-or-dictionary" id="toc-creating-a-seriesdataframe-from-python-list-or-dictionary" class="nav-link" data-scroll-target="#creating-a-seriesdataframe-from-python-list-or-dictionary"><span class="header-section-number">7.3.1</span> Creating a Series/DataFrame from Python List or Dictionary</a>
  <ul class="collapse">
  <li><a href="#creating-a-series" id="toc-creating-a-series" class="nav-link" data-scroll-target="#creating-a-series"><span class="header-section-number">7.3.1.1</span> Creating a series:</a></li>
  <li><a href="#creating-a-dataframe" id="toc-creating-a-dataframe" class="nav-link" data-scroll-target="#creating-a-dataframe"><span class="header-section-number">7.3.1.2</span> Creating a DataFrame</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#creating-a-seriesdataframe-by-reading-data-from-a-file" id="toc-creating-a-seriesdataframe-by-reading-data-from-a-file" class="nav-link" data-scroll-target="#creating-a-seriesdataframe-by-reading-data-from-a-file"><span class="header-section-number">7.4</span> Creating a Series/DataFrame by Reading Data from a File</a></li>
  <li><a href="#attributes-and-methods-of-a-pandas-dataframe" id="toc-attributes-and-methods-of-a-pandas-dataframe" class="nav-link" data-scroll-target="#attributes-and-methods-of-a-pandas-dataframe"><span class="header-section-number">7.5</span> Attributes and Methods of a Pandas DataFrame</a>
  <ul>
  <li><a href="#attributes-of-a-pandas-dataframe" id="toc-attributes-of-a-pandas-dataframe" class="nav-link" data-scroll-target="#attributes-of-a-pandas-dataframe"><span class="header-section-number">7.5.1</span> Attributes of a Pandas DataFrame</a>
  <ul class="collapse">
  <li><a href="#dtypes" id="toc-dtypes" class="nav-link" data-scroll-target="#dtypes"><span class="header-section-number">7.5.1.1</span> <code>dtypes</code></a></li>
  <li><a href="#columns" id="toc-columns" class="nav-link" data-scroll-target="#columns"><span class="header-section-number">7.5.1.2</span> <code>columns</code></a></li>
  <li><a href="#index" id="toc-index" class="nav-link" data-scroll-target="#index"><span class="header-section-number">7.5.1.3</span> <code>index</code></a></li>
  <li><a href="#axes" id="toc-axes" class="nav-link" data-scroll-target="#axes"><span class="header-section-number">7.5.1.4</span> <code>axes</code></a></li>
  <li><a href="#ndim" id="toc-ndim" class="nav-link" data-scroll-target="#ndim"><span class="header-section-number">7.5.1.5</span> <code>ndim</code></a></li>
  <li><a href="#size" id="toc-size" class="nav-link" data-scroll-target="#size"><span class="header-section-number">7.5.1.6</span> <code>size</code></a></li>
  <li><a href="#shape" id="toc-shape" class="nav-link" data-scroll-target="#shape"><span class="header-section-number">7.5.1.7</span> <code>shape</code></a></li>
  <li><a href="#values" id="toc-values" class="nav-link" data-scroll-target="#values"><span class="header-section-number">7.5.1.8</span> <code>values</code></a></li>
  </ul></li>
  <li><a href="#methods-of-a-pandas-dataframe" id="toc-methods-of-a-pandas-dataframe" class="nav-link" data-scroll-target="#methods-of-a-pandas-dataframe"><span class="header-section-number">7.5.2</span> Methods of a Pandas DataFrame</a>
  <ul class="collapse">
  <li><a href="#head" id="toc-head" class="nav-link" data-scroll-target="#head"><span class="header-section-number">7.5.2.1</span> <code>head()</code></a></li>
  <li><a href="#tail" id="toc-tail" class="nav-link" data-scroll-target="#tail"><span class="header-section-number">7.5.2.2</span> <code>tail()</code></a></li>
  <li><a href="#describe" id="toc-describe" class="nav-link" data-scroll-target="#describe"><span class="header-section-number">7.5.2.3</span> <code>describe()</code></a></li>
  <li><a href="#maxmin" id="toc-maxmin" class="nav-link" data-scroll-target="#maxmin"><span class="header-section-number">7.5.2.4</span> <code>max()</code>/<code>min()</code></a></li>
  <li><a href="#meanmedian" id="toc-meanmedian" class="nav-link" data-scroll-target="#meanmedian"><span class="header-section-number">7.5.2.5</span> <code>mean()</code>/<code>median()</code></a></li>
  <li><a href="#std" id="toc-std" class="nav-link" data-scroll-target="#std"><span class="header-section-number">7.5.2.6</span> <code>std()</code></a></li>
  <li><a href="#samplen" id="toc-samplen" class="nav-link" data-scroll-target="#samplen"><span class="header-section-number">7.5.2.7</span> <code>sample(n)</code></a></li>
  <li><a href="#dropna" id="toc-dropna" class="nav-link" data-scroll-target="#dropna"><span class="header-section-number">7.5.2.8</span> <code>dropna()</code></a></li>
  <li><a href="#unique" id="toc-unique" class="nav-link" data-scroll-target="#unique"><span class="header-section-number">7.5.2.9</span> <code>unique()</code></a></li>
  <li><a href="#value_counts" id="toc-value_counts" class="nav-link" data-scroll-target="#value_counts"><span class="header-section-number">7.5.2.10</span> <code>value_counts()</code></a></li>
  <li><a href="#isin" id="toc-isin" class="nav-link" data-scroll-target="#isin"><span class="header-section-number">7.5.2.11</span> <code>isin()</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-manipulations-with-pandas" id="toc-data-manipulations-with-pandas" class="nav-link" data-scroll-target="#data-manipulations-with-pandas"><span class="header-section-number">7.6</span> Data manipulations with Pandas</a>
  <ul>
  <li><a href="#sub-setting-data" id="toc-sub-setting-data" class="nav-link" data-scroll-target="#sub-setting-data"><span class="header-section-number">7.6.1</span> Sub-setting data</a></li>
  <li><a href="#setting-and-resetting-indices" id="toc-setting-and-resetting-indices" class="nav-link" data-scroll-target="#setting-and-resetting-indices"><span class="header-section-number">7.6.2</span> Setting and Resetting indices</a></li>
  <li><a href="#dropping-a-column" id="toc-dropping-a-column" class="nav-link" data-scroll-target="#dropping-a-column"><span class="header-section-number">7.6.3</span> Dropping a column</a></li>
  <li><a href="#adding-a-column" id="toc-adding-a-column" class="nav-link" data-scroll-target="#adding-a-column"><span class="header-section-number">7.6.4</span> Adding a column</a></li>
  <li><a href="#renaming-a-column" id="toc-renaming-a-column" class="nav-link" data-scroll-target="#renaming-a-column"><span class="header-section-number">7.6.5</span> Renaming a column</a></li>
  <li><a href="#sorting-data" id="toc-sorting-data" class="nav-link" data-scroll-target="#sorting-data"><span class="header-section-number">7.6.6</span> Sorting data</a></li>
  <li><a href="#ranking-data" id="toc-ranking-data" class="nav-link" data-scroll-target="#ranking-data"><span class="header-section-number">7.6.7</span> Ranking data</a></li>
  </ul></li>
  <li><a href="#arithematic-operations-within-and-between-dataframes" id="toc-arithematic-operations-within-and-between-dataframes" class="nav-link" data-scroll-target="#arithematic-operations-within-and-between-dataframes"><span class="header-section-number">7.7</span> Arithematic operations within and between DataFrames</a>
  <ul>
  <li><a href="#arithematic-operations-within-a-dataframe" id="toc-arithematic-operations-within-a-dataframe" class="nav-link" data-scroll-target="#arithematic-operations-within-a-dataframe"><span class="header-section-number">7.7.1</span> Arithematic operations within a DataFrame</a></li>
  <li><a href="#arithematic-operations-between-dataframes" id="toc-arithematic-operations-between-dataframes" class="nav-link" data-scroll-target="#arithematic-operations-between-dataframes"><span class="header-section-number">7.7.2</span> Arithematic operations between DataFrames</a></li>
  <li><a href="#arithmetic-between-dataframe-and-series-broadcasting" id="toc-arithmetic-between-dataframe-and-series-broadcasting" class="nav-link" data-scroll-target="#arithmetic-between-dataframe-and-series-broadcasting"><span class="header-section-number">7.7.3</span> Arithmetic Between DataFrame and Series (Broadcasting)</a></li>
  <li><a href="#converting-a-dataframe-to-a-numpy-array" id="toc-converting-a-dataframe-to-a-numpy-array" class="nav-link" data-scroll-target="#converting-a-dataframe-to-a-numpy-array"><span class="header-section-number">7.7.4</span> Converting a DataFrame to a NumPy Array</a>
  <ul class="collapse">
  <li><a href="#using-.values" id="toc-using-.values" class="nav-link" data-scroll-target="#using-.values"><span class="header-section-number">7.7.4.1</span> Using <code>.values</code></a></li>
  <li><a href="#using-.to_numpy" id="toc-using-.to_numpy" class="nav-link" data-scroll-target="#using-.to_numpy"><span class="header-section-number">7.7.4.2</span> Using <code>.to_numpy()</code></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#advanced-dataframe-operations" id="toc-advanced-dataframe-operations" class="nav-link" data-scroll-target="#advanced-dataframe-operations"><span class="header-section-number">7.8</span> Advanced DataFrame Operations</a>
  <ul>
  <li><a href="#apply-row-wise-or-column-wise" id="toc-apply-row-wise-or-column-wise" class="nav-link" data-scroll-target="#apply-row-wise-or-column-wise"><span class="header-section-number">7.8.1</span> <code>apply()</code>: Row-wise, or Column-wise</a></li>
  <li><a href="#map-element-wise" id="toc-map-element-wise" class="nav-link" data-scroll-target="#map-element-wise"><span class="header-section-number">7.8.2</span> <code>map()</code>: Element-wise</a></li>
  <li><a href="#key-differences-between-map-and-apply" id="toc-key-differences-between-map-and-apply" class="nav-link" data-scroll-target="#key-differences-between-map-and-apply"><span class="header-section-number">7.8.3</span> Key Differences Between <code>map()</code> and <code>apply()</code></a>
  <ul class="collapse">
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">7.8.3.1</span> Summary:</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#introduction-to-lambda-functions-in-pandas" id="toc-introduction-to-lambda-functions-in-pandas" class="nav-link" data-scroll-target="#introduction-to-lambda-functions-in-pandas"><span class="header-section-number">7.9</span> Introduction to Lambda Functions in Pandas</a>
  <ul>
  <li><a href="#syntax-of-lambda-functions" id="toc-syntax-of-lambda-functions" class="nav-link" data-scroll-target="#syntax-of-lambda-functions"><span class="header-section-number">7.9.1</span> Syntax of Lambda Functions:</a></li>
  <li><a href="#key-features" id="toc-key-features" class="nav-link" data-scroll-target="#key-features"><span class="header-section-number">7.9.2</span> Key Features</a></li>
  </ul></li>
  <li><a href="#understanding-inplacetrue-and-inplacefalse" id="toc-understanding-inplacetrue-and-inplacefalse" class="nav-link" data-scroll-target="#understanding-inplacetrue-and-inplacefalse"><span class="header-section-number">7.10</span> Understanding <code>inplace=True</code> and <code>inplace=False</code></a></li>
  <li><a href="#case-study" id="toc-case-study" class="nav-link" data-scroll-target="#case-study"><span class="header-section-number">7.11</span> Case study</a></li>
  <li><a href="#independent-practice" id="toc-independent-practice" class="nav-link" data-scroll-target="#independent-practice"><span class="header-section-number">7.12</span> Independent Practice:</a>
  <ul>
  <li><a href="#practice-exercise-1" id="toc-practice-exercise-1" class="nav-link" data-scroll-target="#practice-exercise-1"><span class="header-section-number">7.12.1</span> Practice exercise 1</a>
  <ul class="collapse">
  <li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section"><span class="header-section-number">7.12.1.1</span> </a></li>
  <li><a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1"><span class="header-section-number">7.12.1.2</span> </a></li>
  <li><a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2"><span class="header-section-number">7.12.1.3</span> </a></li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3"><span class="header-section-number">7.12.1.4</span> </a></li>
  <li><a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4"><span class="header-section-number">7.12.1.5</span> </a></li>
  <li><a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5"><span class="header-section-number">7.12.1.6</span> </a></li>
  <li><a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6"><span class="header-section-number">7.12.1.7</span> </a></li>
  <li><a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7"><span class="header-section-number">7.12.1.8</span> </a></li>
  </ul></li>
  <li><a href="#practice-exercise-2" id="toc-practice-exercise-2" class="nav-link" data-scroll-target="#practice-exercise-2"><span class="header-section-number">7.12.2</span> Practice exercise 2</a>
  <ul class="collapse">
  <li><a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8"><span class="header-section-number">7.12.2.1</span> </a></li>
  <li><a href="#section-9" id="toc-section-9" class="nav-link" data-scroll-target="#section-9"><span class="header-section-number">7.12.2.2</span> </a></li>
  <li><a href="#section-10" id="toc-section-10" class="nav-link" data-scroll-target="#section-10"><span class="header-section-number">7.12.2.3</span> </a></li>
  <li><a href="#section-11" id="toc-section-11" class="nav-link" data-scroll-target="#section-11"><span class="header-section-number">7.12.2.4</span> </a></li>
  <li><a href="#section-12" id="toc-section-12" class="nav-link" data-scroll-target="#section-12"><span class="header-section-number">7.12.2.5</span> </a></li>
  <li><a href="#section-13" id="toc-section-13" class="nav-link" data-scroll-target="#section-13"><span class="header-section-number">7.12.2.6</span> </a></li>
  <li><a href="#section-14" id="toc-section-14" class="nav-link" data-scroll-target="#section-14"><span class="header-section-number">7.12.2.7</span> </a></li>
  <li><a href="#section-15" id="toc-section-15" class="nav-link" data-scroll-target="#section-15"><span class="header-section-number">7.12.2.8</span> </a></li>
  <li><a href="#section-16" id="toc-section-16" class="nav-link" data-scroll-target="#section-16"><span class="header-section-number">7.12.2.9</span> </a></li>
  <li><a href="#section-17" id="toc-section-17" class="nav-link" data-scroll-target="#section-17"><span class="header-section-number">7.12.2.10</span> </a></li>
  <li><a href="#section-18" id="toc-section-18" class="nav-link" data-scroll-target="#section-18"><span class="header-section-number">7.12.2.11</span> </a></li>
  <li><a href="#section-19" id="toc-section-19" class="nav-link" data-scroll-target="#section-19"><span class="header-section-number">7.12.2.12</span> </a></li>
  </ul></li>
  <li><a href="#practice-exercise-3" id="toc-practice-exercise-3" class="nav-link" data-scroll-target="#practice-exercise-3"><span class="header-section-number">7.12.3</span> Practice exercise 3</a>
  <ul class="collapse">
  <li><a href="#section-20" id="toc-section-20" class="nav-link" data-scroll-target="#section-20"><span class="header-section-number">7.12.3.1</span> </a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./NumPy.html">Core library foundations</a></li><li class="breadcrumb-item"><a href="./Pandas.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Pandas</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">7.1</span> Introduction</h2>
<p>Pandas is an essential tool in the data scientist or data analyst’s toolkit due to its ability to handle and transform data with ease and efficiency.</p>
<p><img src="https://i.imgur.com/zfxLzEv.png" alt="example image" style="width: 750px;"></p>
<p>Built on top of the NumPy package, Pandas extends the capabilities of NumPy by offering support for working with tabular or heterogeneous data. While NumPy is optimized for working with homogeneous numerical arrays, Pandas is specifically designed for handling structured, labeled data, commonly represented in two-dimensional tables known as DataFrames. There are some similarities between the two libraries. Like NumPy, Pandas provides basic mathematical functionalities such as addition, subtraction, conditional operations, and broadcasting. However, while NumPy focuses on multi-dimensional arrays, Pandas excels in offering the powerful 2D <code>DataFrame</code> object for data manipulation.</p>
<p>Data in Pandas is often used to feed statistical analyses in SciPy, visualization functions in Matplotlib, and machine learning algorithms in Scikit-learn.</p>
<p>Typically, the Pandas library is used for:</p>
<ul>
<li>Data reading/writing from different sources (CSV, Excel, SQL, etc.).</li>
<li>Data manipulation, cleaning, and transformation.</li>
<li>Computing data distribution and summary statistics</li>
<li>Grouping, aggregation, and pivoting for advanced data analysis.</li>
<li>Merging, concatenating, and reshaping data.</li>
<li>Handling time series and datetime data.</li>
<li>Data visualization and plotting.</li>
</ul>
<p>Let’s import the Pandas library to use its methods and functions.</p>
<div id="3311c8d5" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pandas-data-structures---series-and-dataframe" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="pandas-data-structures---series-and-dataframe"><span class="header-section-number">7.2</span> Pandas data structures - Series and DataFrame</h2>
<p>There are two core components of the Pandas library - Series and DataFrame.</p>
<p>A DataFrame is a two-dimensional object - comprising of tabular data organized in rows and columns, where individual columns can be of different value types (numeric / string / boolean etc.). A DataFrame has row labels (also called row indices) which refer to individual rows, and column labels (also called column names) that refer to individual columns. By default, the row indices are integers starting from zero. However, both the row indices and column names can be customized by the user.</p>
<p>Let us read the spotify data - <em>spotify_data.csv</em>, using the Pandas function <code>read_csv()</code>.</p>
<div id="85fd4b86" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>spotify_data <span class="op">=</span> pd.read_csv(<span class="st">'../Data/spotify_data.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>spotify_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">artist_name</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>All Girls Are The Same</td>
<td>0</td>
<td>165820</td>
<td>1</td>
<td>2021</td>
<td>0.673</td>
<td>...</td>
<td>0</td>
<td>-7.226</td>
<td>1</td>
<td>0.3060</td>
<td>0.0769</td>
<td>0.000338</td>
<td>0.0856</td>
<td>0.203</td>
<td>161.991</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Lucid Dreams</td>
<td>0</td>
<td>239836</td>
<td>1</td>
<td>2021</td>
<td>0.511</td>
<td>...</td>
<td>6</td>
<td>-7.230</td>
<td>0</td>
<td>0.2000</td>
<td>0.3490</td>
<td>0.000000</td>
<td>0.3400</td>
<td>0.218</td>
<td>83.903</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Hear Me Calling</td>
<td>0</td>
<td>189977</td>
<td>1</td>
<td>2021</td>
<td>0.699</td>
<td>...</td>
<td>7</td>
<td>-3.997</td>
<td>0</td>
<td>0.1060</td>
<td>0.3080</td>
<td>0.000036</td>
<td>0.1210</td>
<td>0.499</td>
<td>88.933</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Robbery</td>
<td>0</td>
<td>240527</td>
<td>1</td>
<td>2021</td>
<td>0.708</td>
<td>...</td>
<td>2</td>
<td>-5.181</td>
<td>1</td>
<td>0.0442</td>
<td>0.3480</td>
<td>0.000000</td>
<td>0.2220</td>
<td>0.543</td>
<td>79.993</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5988689</td>
<td>rap</td>
<td>Roddy Ricch</td>
<td>88</td>
<td>Big Stepper</td>
<td>0</td>
<td>175170</td>
<td>0</td>
<td>2021</td>
<td>0.753</td>
<td>...</td>
<td>8</td>
<td>-8.469</td>
<td>1</td>
<td>0.2920</td>
<td>0.0477</td>
<td>0.000000</td>
<td>0.1970</td>
<td>0.616</td>
<td>76.997</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
<p>The object <code>spotify_data</code> is a pandas DataFrame:</p>
<div id="bcd871db" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(spotify_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>pandas.core.frame.DataFrame</code></pre>
</div>
</div>
<p>A Series is a one-dimensional array-like object in pandas that contains a sequence of values, where each value is associated with an index. All the values in a Series must have the same data type. Each column of a DataFrame is Series as shown in the example below.</p>
<div id="11971bce" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Extracting song titles from the spotify_songs DataFrame</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>spotify_songs <span class="op">=</span> spotify_data[<span class="st">'track_name'</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>spotify_songs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>0                           All Girls Are The Same
1                                     Lucid Dreams
2                                  Hear Me Calling
3                                          Robbery
4                                      Big Stepper
                            ...                   
243185                                    Stardust
243186             Knockin' A Jug - 78 rpm Version
243187            When It's Sleepy Time Down South
243188    On The Sunny Side Of The Street - Part 2
243189                                    My Sweet
Name: track_name, Length: 243190, dtype: object</code></pre>
</div>
</div>
<div id="18b17621" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The object spotify_songs is a Series</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(spotify_songs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<pre><code>pandas.core.series.Series</code></pre>
</div>
</div>
<p>A&nbsp;Series&nbsp;is essentially a column, and a&nbsp;DataFrame&nbsp;is a two-dimensional table made up of a collection of Series</p>
<p><img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQFmjpTWPpi4cZBAuL7W5H1LvGetG_MwnmvGQ&amp;s" alt="example image" style="width: 300px;"></p>
</section>
<section id="creating-a-pandas-series-dataframe" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="creating-a-pandas-series-dataframe"><span class="header-section-number">7.3</span> Creating a Pandas Series / DataFrame</h2>
<ul>
<li>From a Python List or Dictionary</li>
<li>By Reading Data from a file</li>
</ul>
<section id="creating-a-seriesdataframe-from-python-list-or-dictionary" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="creating-a-seriesdataframe-from-python-list-or-dictionary"><span class="header-section-number">7.3.1</span> Creating a Series/DataFrame from Python List or Dictionary</h3>
<section id="creating-a-series" class="level4" data-number="7.3.1.1">
<h4 data-number="7.3.1.1" class="anchored" data-anchor-id="creating-a-series"><span class="header-section-number">7.3.1.1</span> Creating a series:</h4>
<ul>
<li><strong>From a Python List</strong>: You can create a pandas Series by passing a list of values.</li>
</ul>
<div id="ed4d01be" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining a Pandas Series</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>series_example <span class="op">=</span> pd.Series([<span class="st">'these'</span>,<span class="st">'are'</span>,<span class="st">'english'</span>,<span class="st">'words'</span>])</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>series_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>0      these
1        are
2    english
3      words
dtype: object</code></pre>
</div>
</div>
<p>Note that the default row indices are integers starting from 0. However, the index can be specified with the <code>index</code> argument if desired by the user:</p>
<div id="da2eee62" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Defining a Pandas Series with custom row labels</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>series_example <span class="op">=</span> pd.Series([<span class="st">'these'</span>,<span class="st">'are'</span>,<span class="st">'english'</span>,<span class="st">'words'</span>], index <span class="op">=</span> <span class="bu">range</span>(<span class="dv">101</span>,<span class="dv">105</span>))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>series_example</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>101      these
102        are
103    english
104      words
dtype: object</code></pre>
</div>
</div>
<ul>
<li><strong>From a Dictionary</strong>: A dictionary can also be used to create a Series, where keys become index labels.</li>
</ul>
<div id="43196db5" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dictionary consisting of the GDP per capita of the US from 1960 to 2021 with some missing values</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>GDP_per_capita_dict <span class="op">=</span> {<span class="st">'1960'</span>:<span class="dv">3007</span>,<span class="st">'1961'</span>:<span class="dv">3067</span>,<span class="st">'1962'</span>:<span class="dv">3244</span>,<span class="st">'1963'</span>:<span class="dv">3375</span>,<span class="st">'1964'</span>:<span class="dv">3574</span>,<span class="st">'1965'</span>:<span class="dv">3828</span>,<span class="st">'1966'</span>:<span class="dv">4146</span>,<span class="st">'1967'</span>:<span class="dv">4336</span>,<span class="st">'1968'</span>:<span class="dv">4696</span>,<span class="st">'1970'</span>:<span class="dv">5234</span>,<span class="st">'1971'</span>:<span class="dv">5609</span>,<span class="st">'1972'</span>:<span class="dv">6094</span>,<span class="st">'1973'</span>:<span class="dv">6726</span>,<span class="st">'1974'</span>:<span class="dv">7226</span>,<span class="st">'1975'</span>:<span class="dv">7801</span>,<span class="st">'1976'</span>:<span class="dv">8592</span>,<span class="st">'1978'</span>:<span class="dv">10565</span>,<span class="st">'1979'</span>:<span class="dv">11674</span>, <span class="st">'1980'</span>:<span class="dv">12575</span>,<span class="st">'1981'</span>:<span class="dv">13976</span>,<span class="st">'1982'</span>:<span class="dv">14434</span>,<span class="st">'1983'</span>:<span class="dv">15544</span>,<span class="st">'1984'</span>:<span class="dv">17121</span>,<span class="st">'1985'</span>:<span class="dv">18237</span>,  <span class="st">'1986'</span>:<span class="dv">19071</span>,<span class="st">'1987'</span>:<span class="dv">20039</span>,<span class="st">'1988'</span>:<span class="dv">21417</span>,<span class="st">'1989'</span>:<span class="dv">22857</span>,<span class="st">'1990'</span>:<span class="dv">23889</span>,<span class="st">'1991'</span>:<span class="dv">24342</span>,  <span class="st">'1992'</span>:<span class="dv">25419</span>,<span class="st">'1993'</span>:<span class="dv">26387</span>,<span class="st">'1994'</span>:<span class="dv">27695</span>,<span class="st">'1995'</span>:<span class="dv">28691</span>,<span class="st">'1996'</span>:<span class="dv">29968</span>,<span class="st">'1997'</span>:<span class="dv">31459</span>,  <span class="st">'1998'</span>:<span class="dv">32854</span>,<span class="st">'2000'</span>:<span class="dv">36330</span>,<span class="st">'2001'</span>:<span class="dv">37134</span>,<span class="st">'2002'</span>:<span class="dv">37998</span>,<span class="st">'2003'</span>:<span class="dv">39490</span>,<span class="st">'2004'</span>:<span class="dv">41725</span>,  <span class="st">'2005'</span>:<span class="dv">44123</span>,<span class="st">'2006'</span>:<span class="dv">46302</span>,<span class="st">'2007'</span>:<span class="dv">48050</span>,<span class="st">'2008'</span>:<span class="dv">48570</span>,<span class="st">'2009'</span>:<span class="dv">47195</span>,<span class="st">'2010'</span>:<span class="dv">48651</span>,  <span class="st">'2011'</span>:<span class="dv">50066</span>,<span class="st">'2012'</span>:<span class="dv">51784</span>,<span class="st">'2013'</span>:<span class="dv">53291</span>,<span class="st">'2015'</span>:<span class="dv">56763</span>,<span class="st">'2016'</span>:<span class="dv">57867</span>,<span class="st">'2017'</span>:<span class="dv">59915</span>,<span class="st">'2018'</span>:<span class="dv">62805</span>, <span class="st">'2019'</span>:<span class="dv">65095</span>,<span class="st">'2020'</span>:<span class="dv">63028</span>,<span class="st">'2021'</span>:<span class="dv">69288</span>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="102ca1b6" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example 2: Creating a Pandas Series from a Dictionary</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>GDP_per_capita_series <span class="op">=</span> pd.Series(GDP_per_capita_dict)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>GDP_per_capita_series.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>1960    3007
1961    3067
1962    3244
1963    3375
1964    3574
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="creating-a-dataframe" class="level4" data-number="7.3.1.2">
<h4 data-number="7.3.1.2" class="anchored" data-anchor-id="creating-a-dataframe"><span class="header-section-number">7.3.1.2</span> Creating a DataFrame</h4>
<ul>
<li><strong>From a list of Python Dictionary</strong>: You can create a DataFrame where keys are column names and values are lists representing column data.</li>
</ul>
<div id="ccc6954d" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#List of dictionary consisting of 52 playing cards of the deck</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>deck_list_of_dictionaries <span class="op">=</span> [{<span class="st">'value'</span>:i, <span class="st">'suit'</span>:c}</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> c <span class="kw">in</span> [<span class="st">'spades'</span>, <span class="st">'clubs'</span>, <span class="st">'hearts'</span>, <span class="st">'diamonds'</span>]</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>,<span class="dv">15</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e6e0a8ab" class="cell" data-scrolled="true" data-execution_count="13">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example 3: Creating a Pandas DataFrame from a List of dictionaries</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>deck_df <span class="op">=</span> pd.DataFrame(deck_list_of_dictionaries)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>deck_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">value</th>
<th data-quarto-table-cell-role="th">suit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2</td>
<td>spades</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>spades</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>4</td>
<td>spades</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>5</td>
<td>spades</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>6</td>
<td>spades</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li><strong>From a Python Dictionary</strong>: You can create a DataFrame where keys are column names and values are lists representing column data.</li>
</ul>
<div id="59279dc1" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Example 4: Creating a Pandas DataFrame from a Dictionary</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dict_data <span class="op">=</span> {<span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>],</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'B'</span>: [<span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">50</span>, <span class="dv">40</span>, <span class="dv">30</span>],</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'C'</span>: [<span class="dv">100</span>, <span class="dv">200</span>, <span class="dv">300</span>, <span class="dv">400</span>, <span class="dv">500</span>]}</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>dict_df <span class="op">=</span> pd.DataFrame(dict_data)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>dict_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>20</td>
<td>100</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>10</td>
<td>200</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>50</td>
<td>300</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>4</td>
<td>40</td>
<td>400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5</td>
<td>30</td>
<td>500</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>
<section id="creating-a-seriesdataframe-by-reading-data-from-a-file" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="creating-a-seriesdataframe-by-reading-data-from-a-file"><span class="header-section-number">7.4</span> Creating a Series/DataFrame by Reading Data from a File</h2>
<p>In the real world, a Pandas DataFrame will typically be created by loading the datasets from existing storage such as SQL Database, CSV file, Excel file, text files, HTML files, etc., as we learned in the perious chapter of the book on Reading data.</p>
<ul>
<li><strong>Using <code>read_csv()</code></strong>: This is one of the most common methods to read data from a CSV file into a pandas DataFrame.</li>
<li><strong>Using <code>read_excel()</code></strong>: You can also read data from Excel files.</li>
<li><strong>Using <code>read_json()</code></strong>: You can also read data from json files.</li>
</ul>
</section>
<section id="attributes-and-methods-of-a-pandas-dataframe" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="attributes-and-methods-of-a-pandas-dataframe"><span class="header-section-number">7.5</span> Attributes and Methods of a Pandas DataFrame</h2>
<p>All attributes and methods of a Pandas DataFrame object can be viewed with the python’s built-in <a href="https://docs.python.org/3/library/functions.html#dir">dir()</a> function.</p>
<div id="47410eca" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#List of attributes and methods of a Pandas DataFrame</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#This code is not executed as the list is too long</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># dir(spotify_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Although we’ll see examples of attributes and methods of a Pandas DataFrame, please note that most of these attributes and methods are also applicable to the Pandas Series object.</p>
<section id="attributes-of-a-pandas-dataframe" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="attributes-of-a-pandas-dataframe"><span class="header-section-number">7.5.1</span> Attributes of a Pandas DataFrame</h3>
<p>Some of the attributes of the Pandas DataFrame class are the following.</p>
<section id="dtypes" class="level4" data-number="7.5.1.1">
<h4 data-number="7.5.1.1" class="anchored" data-anchor-id="dtypes"><span class="header-section-number">7.5.1.1</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dtypes.html"><code>dtypes</code></a></h4>
<p>This attribute is a Series consisting the datatypes of columns of a Pandas DataFrame.</p>
<div id="febb554f" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>spotify_data.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>artist_followers       int64
genres                object
artist_name           object
artist_popularity      int64
track_name            object
track_popularity       int64
duration_ms            int64
explicit               int64
release_year           int64
danceability         float64
energy               float64
key                    int64
loudness             float64
mode                   int64
speechiness          float64
acousticness         float64
instrumentalness     float64
liveness             float64
valence              float64
tempo                float64
time_signature         int64
dtype: object</code></pre>
</div>
</div>
<p>The table below describes the datatypes of columns in a Pandas DataFrame.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Pandas Type</th>
<th>Native Python Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>object</td>
<td>string</td>
<td>The most general dtype. This datatype is assigned to a column if the column has mixed types (numbers and strings)</td>
</tr>
<tr class="even">
<td>int64</td>
<td>int</td>
<td>This datatype is for integers from -9,223,372,036,854,775,808 to 9,223,372,036,854,775,807 or for integers having a maximum size of 64 bits</td>
</tr>
<tr class="odd">
<td>float64</td>
<td>float</td>
<td>This datatype is for real numbers. If a column contains integers and NaNs, Pandas will default to float64. This is because the missing values may be a real number</td>
</tr>
<tr class="even">
<td>datetime64, timedelta[ns]</td>
<td>N/A (but see the&nbsp;<a href="https://docs.python.org/2/library/datetime.html">datetime</a>&nbsp;module in Python’s standard library)</td>
<td>Values meant to hold time data. This datatype is useful for time series analysis</td>
</tr>
</tbody>
</table>
</section>
<section id="columns" class="level4" data-number="7.5.1.2">
<h4 data-number="7.5.1.2" class="anchored" data-anchor-id="columns"><span class="header-section-number">7.5.1.2</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.columns.html"><code>columns</code></a></h4>
<p>This attribute consists of the column labels (or column names) of a Pandas DataFrame.</p>
<div id="9efb8a3c" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>spotify_data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Index(['artist_followers', 'genres', 'artist_name', 'artist_popularity',
       'track_name', 'track_popularity', 'duration_ms', 'explicit',
       'release_year', 'danceability', 'energy', 'key', 'loudness', 'mode',
       'speechiness', 'acousticness', 'instrumentalness', 'liveness',
       'valence', 'tempo', 'time_signature'],
      dtype='object')</code></pre>
</div>
</div>
</section>
<section id="index" class="level4" data-number="7.5.1.3">
<h4 data-number="7.5.1.3" class="anchored" data-anchor-id="index"><span class="header-section-number">7.5.1.3</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.Index.html"><code>index</code></a></h4>
<p>This attribute consists of the row lables (or row indices) of a Pandas DataFrame.</p>
<div id="9f273f47" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>spotify_data.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>RangeIndex(start=0, stop=243190, step=1)</code></pre>
</div>
</div>
</section>
<section id="axes" class="level4" data-number="7.5.1.4">
<h4 data-number="7.5.1.4" class="anchored" data-anchor-id="axes"><span class="header-section-number">7.5.1.4</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.axes.html"><code>axes</code></a></h4>
<p>This is a list of length two, where the first element is the row labels, and the second element is the columns labels. In other words, this attribute combines the information in the attributes - <code>index</code> and <code>columns</code>.</p>
<div id="fd0cf2d9" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>spotify_data.axes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="20">
<pre><code>[RangeIndex(start=0, stop=243190, step=1),
 Index(['artist_followers', 'genres', 'artist_name', 'artist_popularity',
        'track_name', 'track_popularity', 'duration_ms', 'explicit',
        'release_year', 'danceability', 'energy', 'key', 'loudness', 'mode',
        'speechiness', 'acousticness', 'instrumentalness', 'liveness',
        'valence', 'tempo', 'time_signature'],
       dtype='object')]</code></pre>
</div>
</div>
</section>
<section id="ndim" class="level4" data-number="7.5.1.5">
<h4 data-number="7.5.1.5" class="anchored" data-anchor-id="ndim"><span class="header-section-number">7.5.1.5</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.ndim.html"><code>ndim</code></a></h4>
<p>As in NumPy, this attribute specifies the number of dimensions. However, unlike NumPy, a Pandas DataFrame has a fixed dimenstion of 2, and a Pandas Series has a fixed dimesion of 1.</p>
<div id="49ebc684" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>spotify_data.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="21">
<pre><code>2</code></pre>
</div>
</div>
</section>
<section id="size" class="level4" data-number="7.5.1.6">
<h4 data-number="7.5.1.6" class="anchored" data-anchor-id="size"><span class="header-section-number">7.5.1.6</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.size.html"><code>size</code></a></h4>
<p>This attribute specifies the number of elements in a DataFrame. Its value is the product of the number of rows and columns.</p>
<div id="a83710f5" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>spotify_data.size</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="22">
<pre><code>5106990</code></pre>
</div>
</div>
</section>
<section id="shape" class="level4" data-number="7.5.1.7">
<h4 data-number="7.5.1.7" class="anchored" data-anchor-id="shape"><span class="header-section-number">7.5.1.7</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.shape.html"><code>shape</code></a></h4>
<p>This is a tuple consisting of the number of rows and columns in a Pandas DataFrame.</p>
<div id="37453cbc" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>spotify_data.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>(243190, 21)</code></pre>
</div>
</div>
</section>
<section id="values" class="level4" data-number="7.5.1.8">
<h4 data-number="7.5.1.8" class="anchored" data-anchor-id="values"><span class="header-section-number">7.5.1.8</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.values.html"><code>values</code></a></h4>
<p>This provides a NumPy representation of a Pandas DataFrame.</p>
<div id="7647ec9b" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>spotify_data.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="24">
<pre><code>array([[16996777, 'rap', 'Juice WRLD', ..., 0.203, 161.991, 4],
       [16996777, 'rap', 'Juice WRLD', ..., 0.218, 83.903, 4],
       [16996777, 'rap', 'Juice WRLD', ..., 0.499, 88.933, 4],
       ...,
       [2256652, 'jazz', 'Louis Armstrong', ..., 0.37, 105.093, 4],
       [2256652, 'jazz', 'Louis Armstrong', ..., 0.576, 101.279, 4],
       [2256652, 'jazz', 'Louis Armstrong', ..., 0.816, 105.84, 4]],
      dtype=object)</code></pre>
</div>
</div>
</section>
</section>
<section id="methods-of-a-pandas-dataframe" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="methods-of-a-pandas-dataframe"><span class="header-section-number">7.5.2</span> Methods of a Pandas DataFrame</h3>
<p>Some of the commonly used methods of the Pandas DataFrame class are the following.</p>
<section id="head" class="level4" data-number="7.5.2.1">
<h4 data-number="7.5.2.1" class="anchored" data-anchor-id="head"><span class="header-section-number">7.5.2.1</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.head.html"><code>head()</code></a></h4>
<p>Prints the first <em>n</em> rows of a DataFrame.</p>
<div id="265d4198" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>spotify_data.head(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="25">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">artist_name</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>All Girls Are The Same</td>
<td>0</td>
<td>165820</td>
<td>1</td>
<td>2021</td>
<td>0.673</td>
<td>...</td>
<td>0</td>
<td>-7.226</td>
<td>1</td>
<td>0.306</td>
<td>0.0769</td>
<td>0.000338</td>
<td>0.0856</td>
<td>0.203</td>
<td>161.991</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Lucid Dreams</td>
<td>0</td>
<td>239836</td>
<td>1</td>
<td>2021</td>
<td>0.511</td>
<td>...</td>
<td>6</td>
<td>-7.230</td>
<td>0</td>
<td>0.200</td>
<td>0.3490</td>
<td>0.000000</td>
<td>0.3400</td>
<td>0.218</td>
<td>83.903</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>2 rows × 21 columns</p>
</div>
</div>
</div>
</section>
<section id="tail" class="level4" data-number="7.5.2.2">
<h4 data-number="7.5.2.2" class="anchored" data-anchor-id="tail"><span class="header-section-number">7.5.2.2</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.tail.html"><code>tail()</code></a></h4>
<p>Prints the last <em>n</em> rows of a DataFrame.</p>
<div id="0e1bf4f9" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>spotify_data.tail(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">artist_name</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">243187</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>When It's Sleepy Time Down South</td>
<td>4</td>
<td>200200</td>
<td>0</td>
<td>1923</td>
<td>0.527</td>
<td>...</td>
<td>3</td>
<td>-14.814</td>
<td>1</td>
<td>0.0793</td>
<td>0.989</td>
<td>0.00001</td>
<td>0.1040</td>
<td>0.370</td>
<td>105.093</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">243188</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>On The Sunny Side Of The Street - Part 2</td>
<td>4</td>
<td>185973</td>
<td>0</td>
<td>1923</td>
<td>0.559</td>
<td>...</td>
<td>0</td>
<td>-9.804</td>
<td>1</td>
<td>0.0512</td>
<td>0.989</td>
<td>0.84700</td>
<td>0.4480</td>
<td>0.576</td>
<td>101.279</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243189</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>My Sweet</td>
<td>4</td>
<td>195960</td>
<td>0</td>
<td>1923</td>
<td>0.741</td>
<td>...</td>
<td>3</td>
<td>-10.406</td>
<td>1</td>
<td>0.0505</td>
<td>0.927</td>
<td>0.07880</td>
<td>0.0633</td>
<td>0.816</td>
<td>105.840</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>3 rows × 21 columns</p>
</div>
</div>
</div>
</section>
<section id="describe" class="level4" data-number="7.5.2.3">
<h4 data-number="7.5.2.3" class="anchored" data-anchor-id="describe"><span class="header-section-number">7.5.2.3</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.describe.html"><code>describe()</code></a></h4>
<p>Print summary statistics of a Pandas DataFrame, as seen in chapter 3 on Reading Data.</p>
<div id="e1868353" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>spotify_data.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="27">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>2.431900e+05</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>2.431900e+05</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>1.960931e+06</td>
<td>65.342633</td>
<td>36.080772</td>
<td>2.263209e+05</td>
<td>0.050039</td>
<td>1992.475258</td>
<td>0.568357</td>
<td>0.580633</td>
<td>5.240326</td>
<td>-9.432548</td>
<td>0.670928</td>
<td>0.111984</td>
<td>0.383938</td>
<td>0.071169</td>
<td>0.223756</td>
<td>0.552302</td>
<td>119.335060</td>
<td>3.884177</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>5.028746e+06</td>
<td>10.289182</td>
<td>16.476836</td>
<td>9.973214e+04</td>
<td>0.218026</td>
<td>18.481463</td>
<td>0.159444</td>
<td>0.236631</td>
<td>3.532546</td>
<td>4.449731</td>
<td>0.469877</td>
<td>0.198068</td>
<td>0.321142</td>
<td>0.209555</td>
<td>0.198076</td>
<td>0.250017</td>
<td>29.864219</td>
<td>0.458082</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>2.300000e+01</td>
<td>51.000000</td>
<td>0.000000</td>
<td>3.344000e+03</td>
<td>0.000000</td>
<td>1923.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-60.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>1.832620e+05</td>
<td>57.000000</td>
<td>25.000000</td>
<td>1.776670e+05</td>
<td>0.000000</td>
<td>1980.000000</td>
<td>0.462000</td>
<td>0.405000</td>
<td>2.000000</td>
<td>-11.990000</td>
<td>0.000000</td>
<td>0.033200</td>
<td>0.070000</td>
<td>0.000000</td>
<td>0.098100</td>
<td>0.353000</td>
<td>96.099250</td>
<td>4.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>5.352520e+05</td>
<td>64.000000</td>
<td>36.000000</td>
<td>2.188670e+05</td>
<td>0.000000</td>
<td>1994.000000</td>
<td>0.579000</td>
<td>0.591000</td>
<td>5.000000</td>
<td>-8.645000</td>
<td>1.000000</td>
<td>0.043100</td>
<td>0.325000</td>
<td>0.000011</td>
<td>0.141000</td>
<td>0.560000</td>
<td>118.002000</td>
<td>4.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>1.587332e+06</td>
<td>72.000000</td>
<td>48.000000</td>
<td>2.645465e+05</td>
<td>0.000000</td>
<td>2008.000000</td>
<td>0.685000</td>
<td>0.776000</td>
<td>8.000000</td>
<td>-6.131000</td>
<td>1.000000</td>
<td>0.075300</td>
<td>0.671000</td>
<td>0.002220</td>
<td>0.292000</td>
<td>0.760000</td>
<td>137.929000</td>
<td>4.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>7.890023e+07</td>
<td>100.000000</td>
<td>99.000000</td>
<td>4.995083e+06</td>
<td>1.000000</td>
<td>2021.000000</td>
<td>0.988000</td>
<td>1.000000</td>
<td>11.000000</td>
<td>3.744000</td>
<td>1.000000</td>
<td>0.969000</td>
<td>0.996000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>243.507000</td>
<td>5.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="maxmin" class="level4" data-number="7.5.2.4">
<h4 data-number="7.5.2.4" class="anchored" data-anchor-id="maxmin"><span class="header-section-number">7.5.2.4</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.max.html"><code>max()</code></a>/<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.min.html"><code>min()</code></a></h4>
<p>Returns the max/min values of numeric columns. If the function is applied on non-numeric columns, it will return the maximum/minimum value based on the order of the alphabet.</p>
<div id="d674fec5" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The max() method applied on a Series</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>spotify_data[<span class="st">'artist_popularity'</span>].<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="28">
<pre><code>np.int64(100)</code></pre>
</div>
</div>
<div id="2d7f240e" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The max() method applied on a DataFrame</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>spotify_data.<span class="bu">max</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>artist_followers                    78900234
genres                                  rock
artist_name                          高爾宣 OSN
artist_popularity                        100
track_name           행복했던 날들이었다 days gone by
track_popularity                          99
duration_ms                          4995083
explicit                                   1
release_year                            2021
danceability                           0.988
energy                                   1.0
key                                       11
loudness                               3.744
mode                                       1
speechiness                            0.969
acousticness                           0.996
instrumentalness                         1.0
liveness                                 1.0
valence                                  1.0
tempo                                243.507
time_signature                             5
dtype: object</code></pre>
</div>
</div>
</section>
<section id="meanmedian" class="level4" data-number="7.5.2.5">
<h4 data-number="7.5.2.5" class="anchored" data-anchor-id="meanmedian"><span class="header-section-number">7.5.2.5</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.mean.html"><code>mean()</code></a>/<a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.median.html"><code>median()</code></a></h4>
<p>Returns the mean/median values of numeric columns.</p>
<div id="4a2d6b6c" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># apply median to the numeric columns</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>spotify_data.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).median()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>artist_followers     535252.000000
artist_popularity        64.000000
track_popularity         36.000000
duration_ms          218867.000000
explicit                  0.000000
release_year           1994.000000
danceability              0.579000
energy                    0.591000
key                       5.000000
loudness                 -8.645000
mode                      1.000000
speechiness               0.043100
acousticness              0.325000
instrumentalness          0.000011
liveness                  0.141000
valence                   0.560000
tempo                   118.002000
time_signature            4.000000
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="std" class="level4" data-number="7.5.2.6">
<h4 data-number="7.5.2.6" class="anchored" data-anchor-id="std"><span class="header-section-number">7.5.2.6</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.std.html"><code>std()</code></a></h4>
<p>Returns the standard deviation of numeric columns.</p>
<div id="a2a59f8b" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>spotify_data.select_dtypes(include<span class="op">=</span><span class="st">'number'</span>).std()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>artist_followers     5.028746e+06
artist_popularity    1.028918e+01
track_popularity     1.647684e+01
duration_ms          9.973214e+04
explicit             2.180260e-01
release_year         1.848146e+01
danceability         1.594436e-01
energy               2.366309e-01
key                  3.532546e+00
loudness             4.449731e+00
mode                 4.698771e-01
speechiness          1.980684e-01
acousticness         3.211417e-01
instrumentalness     2.095551e-01
liveness             1.980759e-01
valence              2.500172e-01
tempo                2.986422e+01
time_signature       4.580822e-01
dtype: float64</code></pre>
</div>
</div>
</section>
<section id="samplen" class="level4" data-number="7.5.2.7">
<h4 data-number="7.5.2.7" class="anchored" data-anchor-id="samplen"><span class="header-section-number">7.5.2.7</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sample.html"><code>sample(n)</code></a></h4>
<p>Returns <em>n</em> random observations from a Pandas DataFrame.</p>
<div id="b74493d6" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>spotify_data.sample(<span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">artist_name</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">95984</td>
<td>1179716</td>
<td>pop &amp; rock</td>
<td>mor ve ötesi</td>
<td>65</td>
<td>Yalnız Şarkı</td>
<td>36</td>
<td>286440</td>
<td>0</td>
<td>1997</td>
<td>0.441</td>
<td>...</td>
<td>9</td>
<td>-9.126</td>
<td>1</td>
<td>0.0305</td>
<td>0.000003</td>
<td>0.000000</td>
<td>0.0698</td>
<td>0.282</td>
<td>89.998</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">201066</td>
<td>1582426</td>
<td>pop &amp; rock</td>
<td>Andrés Calamaro</td>
<td>73</td>
<td>Clonazepán y circo</td>
<td>36</td>
<td>179093</td>
<td>0</td>
<td>1999</td>
<td>0.381</td>
<td>...</td>
<td>9</td>
<td>-7.031</td>
<td>1</td>
<td>0.0326</td>
<td>0.153000</td>
<td>0.000000</td>
<td>0.0892</td>
<td>0.409</td>
<td>77.131</td>
<td>3</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15002</td>
<td>666680</td>
<td>rock</td>
<td>Indio Solari y los Fundamentalistas del Aire A...</td>
<td>61</td>
<td>El Ruiseñor, el Amor y la Muerte</td>
<td>45</td>
<td>310173</td>
<td>0</td>
<td>2018</td>
<td>0.583</td>
<td>...</td>
<td>0</td>
<td>-6.853</td>
<td>1</td>
<td>0.0251</td>
<td>0.087700</td>
<td>0.008010</td>
<td>0.0830</td>
<td>0.446</td>
<td>80.001</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">186925</td>
<td>295211</td>
<td>jazz</td>
<td>Stan Getz</td>
<td>68</td>
<td>In Your Own Sweet Way - Live In Kildevælds Chu...</td>
<td>6</td>
<td>365493</td>
<td>0</td>
<td>1960</td>
<td>0.448</td>
<td>...</td>
<td>10</td>
<td>-19.986</td>
<td>0</td>
<td>0.0431</td>
<td>0.901000</td>
<td>0.000008</td>
<td>0.1290</td>
<td>0.482</td>
<td>140.798</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>4 rows × 21 columns</p>
</div>
</div>
</div>
</section>
<section id="dropna" class="level4" data-number="7.5.2.8">
<h4 data-number="7.5.2.8" class="anchored" data-anchor-id="dropna"><span class="header-section-number">7.5.2.8</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.dropna.html"><code>dropna()</code></a></h4>
<p>Drops all observations with at least one missing value.</p>
<div id="30a46a29" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code is not executed to avoid prining a large table</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>spotify_data.dropna()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="37">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">artist_name</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>All Girls Are The Same</td>
<td>0</td>
<td>165820</td>
<td>1</td>
<td>2021</td>
<td>0.673</td>
<td>...</td>
<td>0</td>
<td>-7.226</td>
<td>1</td>
<td>0.3060</td>
<td>0.0769</td>
<td>0.000338</td>
<td>0.0856</td>
<td>0.203</td>
<td>161.991</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Lucid Dreams</td>
<td>0</td>
<td>239836</td>
<td>1</td>
<td>2021</td>
<td>0.511</td>
<td>...</td>
<td>6</td>
<td>-7.230</td>
<td>0</td>
<td>0.2000</td>
<td>0.3490</td>
<td>0.000000</td>
<td>0.3400</td>
<td>0.218</td>
<td>83.903</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Hear Me Calling</td>
<td>0</td>
<td>189977</td>
<td>1</td>
<td>2021</td>
<td>0.699</td>
<td>...</td>
<td>7</td>
<td>-3.997</td>
<td>0</td>
<td>0.1060</td>
<td>0.3080</td>
<td>0.000036</td>
<td>0.1210</td>
<td>0.499</td>
<td>88.933</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Robbery</td>
<td>0</td>
<td>240527</td>
<td>1</td>
<td>2021</td>
<td>0.708</td>
<td>...</td>
<td>2</td>
<td>-5.181</td>
<td>1</td>
<td>0.0442</td>
<td>0.3480</td>
<td>0.000000</td>
<td>0.2220</td>
<td>0.543</td>
<td>79.993</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5988689</td>
<td>rap</td>
<td>Roddy Ricch</td>
<td>88</td>
<td>Big Stepper</td>
<td>0</td>
<td>175170</td>
<td>0</td>
<td>2021</td>
<td>0.753</td>
<td>...</td>
<td>8</td>
<td>-8.469</td>
<td>1</td>
<td>0.2920</td>
<td>0.0477</td>
<td>0.000000</td>
<td>0.1970</td>
<td>0.616</td>
<td>76.997</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243185</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>Stardust</td>
<td>5</td>
<td>213667</td>
<td>0</td>
<td>1923</td>
<td>0.614</td>
<td>...</td>
<td>3</td>
<td>-11.004</td>
<td>0</td>
<td>0.0541</td>
<td>0.9700</td>
<td>0.646000</td>
<td>0.0514</td>
<td>0.772</td>
<td>122.319</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">243186</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>Knockin' A Jug - 78 rpm Version</td>
<td>6</td>
<td>193760</td>
<td>0</td>
<td>1923</td>
<td>0.788</td>
<td>...</td>
<td>10</td>
<td>-14.032</td>
<td>1</td>
<td>0.3010</td>
<td>0.8820</td>
<td>0.844000</td>
<td>0.1240</td>
<td>0.676</td>
<td>113.336</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243187</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>When It's Sleepy Time Down South</td>
<td>4</td>
<td>200200</td>
<td>0</td>
<td>1923</td>
<td>0.527</td>
<td>...</td>
<td>3</td>
<td>-14.814</td>
<td>1</td>
<td>0.0793</td>
<td>0.9890</td>
<td>0.000010</td>
<td>0.1040</td>
<td>0.370</td>
<td>105.093</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">243188</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>On The Sunny Side Of The Street - Part 2</td>
<td>4</td>
<td>185973</td>
<td>0</td>
<td>1923</td>
<td>0.559</td>
<td>...</td>
<td>0</td>
<td>-9.804</td>
<td>1</td>
<td>0.0512</td>
<td>0.9890</td>
<td>0.847000</td>
<td>0.4480</td>
<td>0.576</td>
<td>101.279</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">243189</td>
<td>2256652</td>
<td>jazz</td>
<td>Louis Armstrong</td>
<td>74</td>
<td>My Sweet</td>
<td>4</td>
<td>195960</td>
<td>0</td>
<td>1923</td>
<td>0.741</td>
<td>...</td>
<td>3</td>
<td>-10.406</td>
<td>1</td>
<td>0.0505</td>
<td>0.9270</td>
<td>0.078800</td>
<td>0.0633</td>
<td>0.816</td>
<td>105.840</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>243190 rows × 21 columns</p>
</div>
</div>
</div>
</section>
<section id="unique" class="level4" data-number="7.5.2.9">
<h4 data-number="7.5.2.9" class="anchored" data-anchor-id="unique"><span class="header-section-number">7.5.2.9</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.unique.html"><code>unique()</code></a></h4>
<p>This functions provides the unique values of a Series. For example, let us find the number of unique genres of songs in the spotify dataset:</p>
<div id="7d94de0f" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>spotify_data.genres.unique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>array(['rap', 'pop', 'miscellaneous', 'metal', 'hip hop', 'rock',
       'pop &amp; rock', 'hoerspiel', 'folk', 'electronic', 'jazz', 'country',
       'latin'], dtype=object)</code></pre>
</div>
</div>
</section>
<section id="value_counts" class="level4" data-number="7.5.2.10">
<h4 data-number="7.5.2.10" class="anchored" data-anchor-id="value_counts"><span class="header-section-number">7.5.2.10</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.value_counts.html"><code>value_counts()</code></a></h4>
<p>This function provides the number of observations of each value of a Series. For example, let us find the number of songs of each genre in the spotify dataset:</p>
<div id="8f55b314" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>spotify_data.genres.value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>genres
pop              70441
rock             49785
pop &amp; rock       43437
miscellaneous    35848
jazz             13363
hoerspiel        12514
hip hop           7373
folk              2821
latin             2125
rap               1798
metal             1659
country           1236
electronic         790
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>More than half the songs in the dataset are <em>pop, rock</em> or <em>pop &amp; rock</em>.</p>
</section>
<section id="isin" class="level4" data-number="7.5.2.11">
<h4 data-number="7.5.2.11" class="anchored" data-anchor-id="isin"><span class="header-section-number">7.5.2.11</span> <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.isin.html"><code>isin()</code></a></h4>
<p>This function provides a boolean Series indicating the position of certain values in a Series. The function is helpful in sub-setting data. For example, let us subset the songs that are either <em>latin, rap,</em> or <em>metal</em>:</p>
<div id="2eb06f55" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>latin_rap_metal_songs <span class="op">=</span> spotify_data.loc[spotify_data.genres.isin([<span class="st">'latin'</span>,<span class="st">'rap'</span>,<span class="st">'metal'</span>]),:]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>latin_rap_metal_songs.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">artist_name</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>All Girls Are The Same</td>
<td>0</td>
<td>165820</td>
<td>1</td>
<td>2021</td>
<td>0.673</td>
<td>...</td>
<td>0</td>
<td>-7.226</td>
<td>1</td>
<td>0.3060</td>
<td>0.0769</td>
<td>0.000338</td>
<td>0.0856</td>
<td>0.203</td>
<td>161.991</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Lucid Dreams</td>
<td>0</td>
<td>239836</td>
<td>1</td>
<td>2021</td>
<td>0.511</td>
<td>...</td>
<td>6</td>
<td>-7.230</td>
<td>0</td>
<td>0.2000</td>
<td>0.3490</td>
<td>0.000000</td>
<td>0.3400</td>
<td>0.218</td>
<td>83.903</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Hear Me Calling</td>
<td>0</td>
<td>189977</td>
<td>1</td>
<td>2021</td>
<td>0.699</td>
<td>...</td>
<td>7</td>
<td>-3.997</td>
<td>0</td>
<td>0.1060</td>
<td>0.3080</td>
<td>0.000036</td>
<td>0.1210</td>
<td>0.499</td>
<td>88.933</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>16996777</td>
<td>rap</td>
<td>Juice WRLD</td>
<td>96</td>
<td>Robbery</td>
<td>0</td>
<td>240527</td>
<td>1</td>
<td>2021</td>
<td>0.708</td>
<td>...</td>
<td>2</td>
<td>-5.181</td>
<td>1</td>
<td>0.0442</td>
<td>0.3480</td>
<td>0.000000</td>
<td>0.2220</td>
<td>0.543</td>
<td>79.993</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5988689</td>
<td>rap</td>
<td>Roddy Ricch</td>
<td>88</td>
<td>Big Stepper</td>
<td>0</td>
<td>175170</td>
<td>0</td>
<td>2021</td>
<td>0.753</td>
<td>...</td>
<td>8</td>
<td>-8.469</td>
<td>1</td>
<td>0.2920</td>
<td>0.0477</td>
<td>0.000000</td>
<td>0.1970</td>
<td>0.616</td>
<td>76.997</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>5 rows × 21 columns</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="data-manipulations-with-pandas" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="data-manipulations-with-pandas"><span class="header-section-number">7.6</span> Data manipulations with Pandas</h2>
<section id="sub-setting-data" class="level3" data-number="7.6.1">
<h3 data-number="7.6.1" class="anchored" data-anchor-id="sub-setting-data"><span class="header-section-number">7.6.1</span> Sub-setting data</h3>
<p>In the chapter on reading data, we learned about different ways for subsetting data, specifically:</p>
<ul>
<li>Selecting columns: <code>df['column_name']</code>, <code>df[['col1', 'col2']]</code></li>
<li>Selecting rows by label: <code>df.loc[]</code></li>
<li>Selecting rows by integer position: <code>df.iloc[]</code></li>
<li>Selecting by condition (Boolean indexing): <code>df[df['column_name'] &gt; value]</code></li>
<li>Selecting by multiple conditions: <code>df[(df['column_name'] &gt; value) &amp; (df['other_column'] == another_value)]</code></li>
</ul>
</section>
<section id="setting-and-resetting-indices" class="level3" data-number="7.6.2">
<h3 data-number="7.6.2" class="anchored" data-anchor-id="setting-and-resetting-indices"><span class="header-section-number">7.6.2</span> Setting and Resetting indices</h3>
<p>In pandas, the <code>index</code> of a dataframe can be accessed by using <code>index</code> attribute, it represents the row labels of a DataFrame. When you create a DataFrame without specifying an index, pandas automatically assigns a RangeIndex, which is a sequence of integers starting from 0.</p>
<div id="953d1f9b" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read the txt data</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>bestseller_data <span class="op">=</span> pd.read_csv(<span class="st">'../Data/bestseller_books.txt'</span>, sep<span class="op">=</span><span class="st">';'</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>bestseller_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unnamed: 0.1</th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="633d3726" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># accessing the index of the DataFrame</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>bestseller_data.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>RangeIndex(start=0, stop=550, step=1)</code></pre>
</div>
</div>
<p>Alternatively, we can use the <code>index_col</code> parameter in the <code>pd.read_csv()</code> function to set a specific column as the index when reading a CSV file in pandas. This allows us to directly specify which column should be used as the index of the resulting DataFrame.</p>
<div id="9adfbe9c" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>bestseller_index_data <span class="op">=</span> pd.read_csv(<span class="st">'../Data/bestseller_books.txt'</span>, sep<span class="op">=</span><span class="st">';'</span>, index_col<span class="op">=</span><span class="st">'Unnamed: 0.1'</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>bestseller_index_data.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="f9590b5a" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>bestseller_index_data.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="45">
<pre><code>Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       540, 541, 542, 543, 544, 545, 546, 547, 548, 549],
      dtype='int64', length=550)</code></pre>
</div>
</div>
<p>The <code>index</code> is crucial when subsetting your dataset using methods like <code>loc[]</code>, as it identifies the rows you want to select based on their labels.</p>
<div id="6f238b17" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the book that User rating is greater than 4.5</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>bestseller_index_data.loc[bestseller_index_data[<span class="st">'User Rating'</span>]<span class="op">==</span> <span class="fl">4.9</span>].head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="46">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">40</td>
<td>40</td>
<td>Brown Bear, Brown Bear, What Do You See?</td>
<td>Bill Martin Jr.</td>
<td>4.9</td>
<td>14344</td>
<td>5</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41</td>
<td>41</td>
<td>Brown Bear, Brown Bear, What Do You See?</td>
<td>Bill Martin Jr.</td>
<td>4.9</td>
<td>14344</td>
<td>5</td>
<td>2019</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">81</td>
<td>81</td>
<td>Dog Man and Cat Kid: From the Creator of Capta...</td>
<td>Dav Pilkey</td>
<td>4.9</td>
<td>5062</td>
<td>6</td>
<td>2018</td>
<td>Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">82</td>
<td>82</td>
<td>Dog Man: A Tale of Two Kitties: From the Creat...</td>
<td>Dav Pilkey</td>
<td>4.9</td>
<td>4786</td>
<td>8</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">83</td>
<td>83</td>
<td>Dog Man: Brawl of the Wild: From the Creator o...</td>
<td>Dav Pilkey</td>
<td>4.9</td>
<td>7235</td>
<td>4</td>
<td>2018</td>
<td>Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Additionally, you can modify the index at any point after the DataFrame is created by using the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.set_index.html">set_index()</a> function to re-index the rows based on existing column(s) of the DataFrame.</p>
<div id="42348d86" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>bestseller_data_reindexed <span class="op">=</span> bestseller_data.set_index(<span class="st">'Unnamed: 0.1'</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>bestseller_data_reindexed.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<pre><code>Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
       ...
       540, 541, 542, 543, 544, 545, 546, 547, 548, 549],
      dtype='int64', name='Unnamed: 0.1', length=550)</code></pre>
</div>
</div>
<p>Note that, the index column does not have to uniquely identify each row. For example, if we need to subset data by <code>Author</code> frequently in our analysis, we can set it as our index</p>
<div id="d155315b" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>bestseller_author_index <span class="op">=</span> bestseller_data.set_index(<span class="st">'Author'</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>bestseller_author_index.loc[<span class="st">'Jen Sincero'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="48">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unnamed: 0.1</th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Jen Sincero</td>
<td>546</td>
<td>546</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Jen Sincero</td>
<td>547</td>
<td>547</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2017</td>
<td>Non Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Jen Sincero</td>
<td>548</td>
<td>548</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Jen Sincero</td>
<td>549</td>
<td>549</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="40fdb126" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>bestseller_author_index.index</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="49">
<pre><code>Index(['JJ Smith', 'Stephen King', 'Jordan B. Peterson', 'George Orwell',
       'National Geographic Kids', 'George R. R. Martin',
       'George R. R. Martin', 'Amor Towles', 'James Comey', 'Fredrik Backman',
       ...
       'R. J. Palacio', 'R. J. Palacio', 'R. J. Palacio', 'R. J. Palacio',
       'R. J. Palacio', 'Jeff Kinney', 'Jen Sincero', 'Jen Sincero',
       'Jen Sincero', 'Jen Sincero'],
      dtype='object', name='Author', length=550)</code></pre>
</div>
</div>
<p>You can revert it back to a default index using <code>reset_index()</code>. It converts the current index into a regular column and resets the index to a default integer sequence.</p>
<div id="fff78969" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>bestseller_author_index.reset_index()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">Unnamed: 0.1</th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>JJ Smith</td>
<td>0</td>
<td>0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>Stephen King</td>
<td>1</td>
<td>1</td>
<td>11/22/63: A Novel</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>Jordan B. Peterson</td>
<td>2</td>
<td>2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>George Orwell</td>
<td>3</td>
<td>3</td>
<td>1984 (Signet Classics)</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>National Geographic Kids</td>
<td>4</td>
<td>4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
<td>...</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">545</td>
<td>Jeff Kinney</td>
<td>545</td>
<td>545</td>
<td>Wrecking Ball (Diary of a Wimpy Kid Book 14)</td>
<td>4.9</td>
<td>9413</td>
<td>8</td>
<td>2019</td>
<td>Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">546</td>
<td>Jen Sincero</td>
<td>546</td>
<td>546</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">547</td>
<td>Jen Sincero</td>
<td>547</td>
<td>547</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2017</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">548</td>
<td>Jen Sincero</td>
<td>548</td>
<td>548</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">549</td>
<td>Jen Sincero</td>
<td>549</td>
<td>549</td>
<td>You Are a Badass: How to Stop Doubting Your Gr...</td>
<td>4.7</td>
<td>14331</td>
<td>8</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

<p>550 rows × 9 columns</p>
</div>
</div>
</div>
<p>In summary, the index is a powerful feature of pandas for organizing and accessing data, and it can be set, changed, or reset as needed to suit your data analysis.</p>
<p>Later, you will learn about <strong>hierarchical indexing</strong>, which allows you to create multi-level indices by passing multiple columns.</p>
</section>
<section id="dropping-a-column" class="level3" data-number="7.6.3">
<h3 data-number="7.6.3" class="anchored" data-anchor-id="dropping-a-column"><span class="header-section-number">7.6.3</span> Dropping a column</h3>
<p>In pandas, you can drop a column from a DataFrame using the drop() method. This is useful when you want to remove columns that are redundant or when you want to simplify your DataFrame by excluding unnecessary data.</p>
<pre><code>df.drop(columns='column_name')
df.drop(columns= ['col_1', 'col_2'])</code></pre>
<div id="1b53084c" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop the repeated rows in the bestseller dataframe</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>bestseller_df <span class="op">=</span> bestseller_index_data.drop(columns <span class="op">=</span> <span class="st">'Unnamed: 0'</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>bestseller_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="52">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="9ce9b405" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># another way to drop the column</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>bestseller_index_data.drop(<span class="st">'Unnamed: 0'</span>, axis<span class="op">=</span><span class="dv">1</span>).head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p><strong>Note</strong>: The <code>df.drop()</code> function can be used to remove rows by specifying row labels, index values, or based on conditions. It includes an <code>axis</code> parameter, which defaults to dropping rows (<code>axis=0</code>). Feel free to explore its additional options.</p>
</section>
<section id="adding-a-column" class="level3" data-number="7.6.4">
<h3 data-number="7.6.4" class="anchored" data-anchor-id="adding-a-column"><span class="header-section-number">7.6.4</span> Adding a column</h3>
<p>In a DataFrame, it’s common to create new columns based on existing columns for analysis or prediction purposes. If the column name you specify does not already exist, a new column will be added to the DataFrame. If the column name already exists, the new values will overwrite the existing column.</p>
<p>Let’s classify books based on their user rating</p>
<div id="2cedec95" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> classify_rating(rating):</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> rating <span class="op">&gt;=</span> <span class="fl">4.5</span>:</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Highly Rated'</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="fl">3.0</span> <span class="op">&lt;=</span> rating <span class="op">&lt;</span> <span class="fl">4.5</span>:</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Moderately Rated'</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="st">'Low Rated'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="c7a4fc29" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>bestseller_df[<span class="st">'Rating_Class'</span>] <span class="op">=</span> bestseller_df[<span class="st">'User Rating'</span>].<span class="bu">apply</span>(classify_rating)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>bestseller_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">rating_class</th>
<th data-quarto-table-cell-role="th">Rating_class</th>
<th data-quarto-table-cell-role="th">Rating_Class</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
<td>Highly Rated</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="renaming-a-column" class="level3" data-number="7.6.5">
<h3 data-number="7.6.5" class="anchored" data-anchor-id="renaming-a-column"><span class="header-section-number">7.6.5</span> Renaming a column</h3>
<p>To rename a column in a pandas DataFrame, you can use the <code>rename()</code> method. .</p>
<ul>
<li>Renaming a single column</li>
</ul>
<pre><code>df.rename(columns={'old_name': 'new_name'}, inplace=False)</code></pre>
<div id="6d7fd80a" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename Year to Publication Year</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>bestseller_df.rename(columns<span class="op">=</span>{<span class="st">'Year'</span>:<span class="st">'Publication Year'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>bestseller_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Publication Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Renameing multiple columns</li>
</ul>
<p>Specifying a dictionary that maps old column names to new one</p>
<pre><code>df_renamed_multiple = df.rename(columns={'col1': 'new_col1', 'col2': 'new_col2'})</code></pre>
<div id="d9bbec0d" class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename Name to Book Name, and Author to Writer</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>bestseller_df.rename(columns<span class="op">=</span>{<span class="st">'Name'</span>:<span class="st">'Book Name'</span>, <span class="st">'Author'</span>:<span class="st">'Writer'</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>bestseller_df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Book Name</th>
<th data-quarto-table-cell-role="th">Writer</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Publication Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="sorting-data" class="level3" data-number="7.6.6">
<h3 data-number="7.6.6" class="anchored" data-anchor-id="sorting-data"><span class="header-section-number">7.6.6</span> Sorting data</h3>
<p>Sorting dataset is a very common operation. The <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.sort_values.html">sort_values()</a> function of Pandas can be used to sort a Pandas DataFrame or Series. Let us sort the spotify data in decreasing order of <em>track_popularity</em>:</p>
<div id="66be40d1" class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>bestseller_sorted <span class="op">=</span> bestseller_index_data.sort_values(by <span class="op">=</span> <span class="st">'User Rating'</span>, ascending <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>bestseller_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Unnamed: 0</th>
<th data-quarto-table-cell-role="th">Name</th>
<th data-quarto-table-cell-role="th">Author</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">521</td>
<td>521</td>
<td>Unfreedom of the Press</td>
<td>Mark R. Levin</td>
<td>4.9</td>
<td>5956</td>
<td>11</td>
<td>2019</td>
<td>Non Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">420</td>
<td>420</td>
<td>The Legend of Zelda: Hyrule Historia</td>
<td>Patrick Thorpe</td>
<td>4.9</td>
<td>5396</td>
<td>20</td>
<td>2013</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">248</td>
<td>248</td>
<td>Oh, the Places You'll Go!</td>
<td>Dr. Seuss</td>
<td>4.9</td>
<td>21834</td>
<td>8</td>
<td>2015</td>
<td>Fiction</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">247</td>
<td>247</td>
<td>Oh, the Places You'll Go!</td>
<td>Dr. Seuss</td>
<td>4.9</td>
<td>21834</td>
<td>8</td>
<td>2014</td>
<td>Fiction</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">246</td>
<td>246</td>
<td>Oh, the Places You'll Go!</td>
<td>Dr. Seuss</td>
<td>4.9</td>
<td>21834</td>
<td>8</td>
<td>2013</td>
<td>Fiction</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="ranking-data" class="level3" data-number="7.6.7">
<h3 data-number="7.6.7" class="anchored" data-anchor-id="ranking-data"><span class="header-section-number">7.6.7</span> Ranking data</h3>
<p>With the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rank.html">rank()</a> function, we can rank the observations.</p>
<p>For example, let us add a new column to the bestseller data that provides the rank of the <code>User Rating</code> column:</p>
<div id="df81a7ac" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>bestseller_ranked <span class="op">=</span> bestseller_df.copy()</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>bestseller_ranked[<span class="st">'Rating_rank'</span>]<span class="op">=</span>bestseller_ranked[<span class="st">'User Rating'</span>].rank()</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>bestseller_ranked.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Book Name</th>
<th data-quarto-table-cell-role="th">Writer</th>
<th data-quarto-table-cell-role="th">User Rating</th>
<th data-quarto-table-cell-role="th">Reviews</th>
<th data-quarto-table-cell-role="th">Price</th>
<th data-quarto-table-cell-role="th">Publication Year</th>
<th data-quarto-table-cell-role="th">Genre</th>
<th data-quarto-table-cell-role="th">Rating_rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>10-Day Green Smoothie Cleanse</td>
<td>JJ Smith</td>
<td>4.7</td>
<td>17350</td>
<td>8</td>
<td>2016</td>
<td>Non Fiction</td>
<td>317.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>11/22/63: A Novel</td>
<td>Stephen King</td>
<td>4.6</td>
<td>2052</td>
<td>22</td>
<td>2011</td>
<td>Fiction</td>
<td>211.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>12 Rules for Life: An Antidote to Chaos</td>
<td>Jordan B. Peterson</td>
<td>4.7</td>
<td>18979</td>
<td>15</td>
<td>2018</td>
<td>Non Fiction</td>
<td>317.5</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1984 (Signet Classics)</td>
<td>George Orwell</td>
<td>4.7</td>
<td>21424</td>
<td>6</td>
<td>2017</td>
<td>Fiction</td>
<td>317.5</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>5,000 Awesome Facts (About Everything!) (Natio...</td>
<td>National Geographic Kids</td>
<td>4.8</td>
<td>7665</td>
<td>12</td>
<td>2019</td>
<td>Non Fiction</td>
<td>435.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note the column <code>Rating_rank</code>. Why does it contain floating point numbers? Check the <code>rank()</code> documentation to find out!</p>
</section>
</section>
<section id="arithematic-operations-within-and-between-dataframes" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="arithematic-operations-within-and-between-dataframes"><span class="header-section-number">7.7</span> Arithematic operations within and between DataFrames</h2>
<p>Pandas is built on top of NumPy, and for arithmetic operations, it inherits many of NumPy’s powerful features. Pandas provides an intuitive and efficient way to perform arithmetic operations both within a DataFrame (on columns or rows) and between multiple DataFrames. These operations are element-wise, meaning they are applied to corresponding elements of the DataFrame or Series.</p>
<section id="arithematic-operations-within-a-dataframe" class="level3" data-number="7.7.1">
<h3 data-number="7.7.1" class="anchored" data-anchor-id="arithematic-operations-within-a-dataframe"><span class="header-section-number">7.7.1</span> Arithematic operations within a DataFrame</h3>
<p>You can easily perform arithmetic operations on columns or rows within a DataFrame</p>
<ul>
<li>Arithmetic Between Columns</li>
</ul>
<div id="0723ac9c" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>        <span class="st">'B'</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'C'</span>: [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]}</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Adding two columns</span></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'A_plus_B'</span>] <span class="op">=</span> df[<span class="st">'A'</span>] <span class="op">+</span> df[<span class="st">'B'</span>]</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Multiplying two columns</span></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'A_times_C'</span>] <span class="op">=</span> df[<span class="st">'A'</span>] <span class="op">*</span> df[<span class="st">'C'</span>]</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="61">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">A_plus_B</th>
<th data-quarto-table-cell-role="th">A_times_C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>5</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>5</td>
<td>8</td>
<td>7</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>6</td>
<td>9</td>
<td>9</td>
<td>27</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<ul>
<li>Arithmetic on Entire Rows</li>
</ul>
<div id="68946015" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summing values across columns for each row</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'row_sum'</span>] <span class="op">=</span> df.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">A_plus_B</th>
<th data-quarto-table-cell-role="th">A_times_C</th>
<th data-quarto-table-cell-role="th">row_sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>5</td>
<td>7</td>
<td>24</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>5</td>
<td>8</td>
<td>7</td>
<td>16</td>
<td>38</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>6</td>
<td>9</td>
<td>9</td>
<td>27</td>
<td>54</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="arithematic-operations-between-dataframes" class="level3" data-number="7.7.2">
<h3 data-number="7.7.2" class="anchored" data-anchor-id="arithematic-operations-between-dataframes"><span class="header-section-number">7.7.2</span> Arithematic operations between DataFrames</h3>
<p>When performing operations between two DataFrames, pandas aligns the data based on both the <code>index</code> and <code>column labels</code>. If the indices or columns do not match, pandas automatically fills the missing values with NaN (not-a-number) unless a fill value is provided.</p>
<p>Let us create two toy DataFrames:</p>
<div id="bf91907b" class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating two toy DataFrames</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>toy_df1 <span class="op">=</span> pd.DataFrame([(<span class="dv">1</span>,<span class="dv">2</span>),(<span class="dv">3</span>,<span class="dv">4</span>),(<span class="dv">5</span>,<span class="dv">6</span>)], columns<span class="op">=</span>[<span class="st">'a'</span>,<span class="st">'b'</span>])</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>toy_df2 <span class="op">=</span> pd.DataFrame([(<span class="dv">100</span>,<span class="dv">200</span>),(<span class="dv">300</span>,<span class="dv">400</span>),(<span class="dv">500</span>,<span class="dv">600</span>)], columns<span class="op">=</span>[<span class="st">'a'</span>,<span class="st">'b'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="e6c65e8a" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DataFrame 1</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>toy_df1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="c163e754" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DataFrame 2</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>toy_df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="65">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100</td>
<td>200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>300</td>
<td>400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>500</td>
<td>600</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Element by element operations between two DataFrames can be performed with the operators <code>+</code>, <code>-</code>, <code>*</code>,<code>/</code>,<code>**</code>, and <code>%</code>. Below is an example of element-by-element addition of two DataFrames:</p>
<div id="247ab4a5" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Element-by-element arithmetic addition of the two DataFrames</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>toy_df1 <span class="op">+</span> toy_df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="66">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>101</td>
<td>202</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>303</td>
<td>404</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>505</td>
<td>606</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that these operations create problems when the row indices and/or column names of the two DataFrames do not match. See the example below:</p>
<div id="56399bfc" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Creating another toy example of a DataFrame</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>toy_df3 <span class="op">=</span> pd.DataFrame([(<span class="dv">100</span>,<span class="dv">200</span>),(<span class="dv">300</span>,<span class="dv">400</span>),(<span class="dv">500</span>,<span class="dv">600</span>)], columns<span class="op">=</span>[<span class="st">'a'</span>,<span class="st">'b'</span>], index<span class="op">=</span>[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>])</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>toy_df3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">1</td>
<td>100</td>
<td>200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2</td>
<td>300</td>
<td>400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3</td>
<td>500</td>
<td>600</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="4055ea99" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding DataFrames with some unmatching row indices</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>toy_df1 <span class="op">+</span> toy_df3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>103.0</td>
<td>204.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>305.0</td>
<td>406.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that the rows whose indices match between the two DataFrames are added up. The rest of the values are missing (or <code>NaN</code>) because only one of the DataFrames has that index.</p>
<p>As in the case of row indices, missing values will also appear in the case of unmatching column names, as shown in the example below.</p>
<div id="2a95a603" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>toy_df4 <span class="op">=</span> pd.DataFrame([(<span class="dv">100</span>,<span class="dv">200</span>),(<span class="dv">300</span>,<span class="dv">400</span>),(<span class="dv">500</span>,<span class="dv">600</span>)], columns<span class="op">=</span>[<span class="st">'b'</span>,<span class="st">'c'</span>])</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>toy_df4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>100</td>
<td>200</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>300</td>
<td>400</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>500</td>
<td>600</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="704e6d85" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding DataFrames with some unmatching column names</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>toy_df1 <span class="op">+</span> toy_df4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="70">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
<th data-quarto-table-cell-role="th">c</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>NaN</td>
<td>102</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>NaN</td>
<td>304</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>NaN</td>
<td>506</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="arithmetic-between-dataframe-and-series-broadcasting" class="level3" data-number="7.7.3">
<h3 data-number="7.7.3" class="anchored" data-anchor-id="arithmetic-between-dataframe-and-series-broadcasting"><span class="header-section-number">7.7.3</span> Arithmetic Between DataFrame and Series (Broadcasting)</h3>
<p>Pandas supports <strong>broadcasting</strong>, where a Series can be broadcasted to match the dimensions of a DataFrame during an arithmetic operation.</p>
<div id="b30e7a27" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Broadcasting: The row [1,2] (a Series) is added on every row in df2 </span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>toy_df1.loc[<span class="dv">0</span>,:] <span class="op">+</span> toy_df2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="71">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>101</td>
<td>202</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>301</td>
<td>402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>501</td>
<td>602</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that the <code>+</code> operator is used to add values of a Series to a DataFrame based on column names. For adding a Series to a DataFrame based on row indices, we cannot use the <code>+</code> operator. Instead, we’ll need to use the <code>add()</code> function as explained below.</p>
<p><strong>Broadcasting based on row/column labels:</strong> We can use the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.add.html">add()</a> function to broadcast a Series to a DataFrame. By default the Series adds based on column names, as in the case of the <code>+</code> operator.</p>
<div id="84e043de" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Add the first row of df1 (a Series) to every row in df2 </span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>toy_df2.add(toy_df1.loc[<span class="dv">0</span>,:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="72">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>101</td>
<td>202</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>301</td>
<td>402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>501</td>
<td>602</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>For broadcasting based on row indices, we use the <code>axis</code> argument of the <code>add()</code> function.</p>
<div id="d6dbc0eb" class="cell" data-execution_count="73">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The second column of df1 (a Series) is added to every col in df2</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>toy_df2.add(toy_df1.loc[:,<span class="st">'b'</span>],axis<span class="op">=</span><span class="st">'index'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="73">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>102</td>
<td>202</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>304</td>
<td>404</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>506</td>
<td>606</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="converting-a-dataframe-to-a-numpy-array" class="level3" data-number="7.7.4">
<h3 data-number="7.7.4" class="anchored" data-anchor-id="converting-a-dataframe-to-a-numpy-array"><span class="header-section-number">7.7.4</span> Converting a DataFrame to a NumPy Array</h3>
<p>In pandas, you often need to convert a DataFrame or Series into a NumPy array to perform specific operations or to interface with libraries that require NumPy arrays.</p>
<p>There are two common methods for converting pandas objects to NumPy arrays: <code>.values</code> and <code>.to_numpy()</code>.</p>
<section id="using-.values" class="level4" data-number="7.7.4.1">
<h4 data-number="7.7.4.1" class="anchored" data-anchor-id="using-.values"><span class="header-section-number">7.7.4.1</span> Using <code>.values</code></h4>
<ul>
<li><p>The <code>.values</code> attribute returns the underlying NumPy array representation of a DataFrame or Series.</p></li>
<li><p>It provides a direct conversion, but it has been deprecated in favor of the newer <code>.to_numpy()</code> method because .values does not always handle all DataFrame types consistently.</p></li>
</ul>
<div id="8cb8a34a" class="cell" data-execution_count="74">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>toy_df1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="74">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">a</th>
<th data-quarto-table-cell-role="th">b</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>3</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>5</td>
<td>6</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="7a22d0c5" class="cell" data-execution_count="75">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>toy_df1.values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="75">
<pre><code>array([[1, 2],
       [3, 4],
       [5, 6]])</code></pre>
</div>
</div>
</section>
<section id="using-.to_numpy" class="level4" data-number="7.7.4.2">
<h4 data-number="7.7.4.2" class="anchored" data-anchor-id="using-.to_numpy"><span class="header-section-number">7.7.4.2</span> Using <code>.to_numpy()</code></h4>
<ul>
<li>The <code>.to_numpy()</code> method is a recommended way to convert a DataFrame to a NumPy array.</li>
<li>It handles different types of data, such as nullable types or mixed data types, more consistently than .values.</li>
<li>Additional parameters: .to_numpy() can take parameters like dtype (to specify the data type) and copy (to create a copy or not).</li>
</ul>
<div id="f63d997a" class="cell" data-execution_count="76">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>toy_df1.to_numpy()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="76">
<pre><code>array([[1, 2],
       [3, 4],
       [5, 6]])</code></pre>
</div>
</div>
<p>In the NumPy chapter, we explored the below case study that demonstrated the benefits of using matrix multiplication in NumPy over python loops. However, this same operation cannot be directly performed in a pandas DataFrame in the same way.</p>
<div id="f0003274" class="cell" data-execution_count="77">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>food_qty <span class="op">=</span> pd.read_csv(<span class="st">'../data/food_quantity.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>price <span class="op">=</span> pd.read_csv(<span class="st">'../data/price.csv'</span>,index_col<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="45e1c045" class="cell" data-execution_count="78">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>store_expense <span class="op">=</span> pd.DataFrame(<span class="fl">0.0</span>, columns<span class="op">=</span>price.columns, index <span class="op">=</span> food_qty.index)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> person <span class="kw">in</span> store_expense.index:</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> store <span class="kw">in</span> store_expense.columns:</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> food <span class="kw">in</span> food_qty.columns:</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>            store_expense.loc[person, store] <span class="op">+=</span> food_qty.loc[person, food]<span class="op">*</span>price.loc[food, store]</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>store_expense</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 0 ns
Wall time: 5.01 ms</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="78">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Target</th>
<th data-quarto-table-cell-role="th">Kroger</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Person</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ben</td>
<td>50.0</td>
<td>49.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Barbara</td>
<td>58.5</td>
<td>61.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Beth</td>
<td>43.5</td>
<td>43.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b625c191" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="op">%%</span>time</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="co"># using matrix multiplication in numpy</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>np.dot(food_qty.values, price.values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CPU times: total: 0 ns
Wall time: 996 μs</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>array([[50. , 49. ],
       [58.5, 61. ],
       [43.5, 43.5]])</code></pre>
</div>
</div>
<div id="96a6dec9" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># converting the result to a DataFrame</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>pd.DataFrame(np.dot(food_qty.values, price.values), columns<span class="op">=</span>price.columns, index<span class="op">=</span>food_qty.index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="80">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Target</th>
<th data-quarto-table-cell-role="th">Kroger</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Person</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">Ben</td>
<td>50.0</td>
<td>49.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">Barbara</td>
<td>58.5</td>
<td>61.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">Beth</td>
<td>43.5</td>
<td>43.5</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
</section>
<section id="advanced-dataframe-operations" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="advanced-dataframe-operations"><span class="header-section-number">7.8</span> Advanced DataFrame Operations</h2>
<p>Pandas provides powerful methods for applying functions to DataFrame rows, columns, or individual elements. These methods allow for flexible data transformations, making them essential for advanced data manipulation.</p>
<section id="apply-row-wise-or-column-wise" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="apply-row-wise-or-column-wise"><span class="header-section-number">7.8.1</span> <code>apply()</code>: Row-wise, or Column-wise</h3>
<p>The <code>apply()</code> function in pandas is used to apply a function along an axis of a DataFrame.</p>
<ul>
<li>Row-wise: You can apply a function to each row using <code>axis=1</code>.</li>
<li>Column-wise: You can apply a function to each column using <code>axis=0</code> (default behavior).</li>
</ul>
<p>Let’s create a DataFrame and apply a custom function to each row.</p>
<div id="cb0f4491" class="cell" data-execution_count="81">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B'</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>],</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'C'</span>: [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="d07becad" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="82">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>4</td>
<td>7</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>5</td>
<td>8</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>6</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="994e6086" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Function to compute the row sum</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> row_sum(row):</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> row.<span class="bu">sum</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="95922a67" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function row-wise (axis=1)</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Row_Sum'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(row_sum, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">Row_Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>12</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>5</td>
<td>8</td>
<td>15</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>6</td>
<td>9</td>
<td>18</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let’s apply the same function to each column next</p>
<div id="76192a6d" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Apply the function column-wise (axis=0)</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>column_sum <span class="op">=</span> df.<span class="bu">apply</span>(<span class="bu">sum</span>, axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>column_sum</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>A           6
B          15
C          24
Row_Sum    45
dtype: int64</code></pre>
</div>
</div>
</section>
<section id="map-element-wise" class="level3" data-number="7.8.2">
<h3 data-number="7.8.2" class="anchored" data-anchor-id="map-element-wise"><span class="header-section-number">7.8.2</span> <code>map()</code>: Element-wise</h3>
<p><code>map()</code> is typically used for element-wise transformations on a Series.</p>
<div id="e682adad" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># write the function to compute square of a number</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> square(x):</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">**</span> <span class="dv">2</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use the map() function to apply a function element-wise</span></span>
<span id="cb109-6"><a href="#cb109-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'A_squared'</span>] <span class="op">=</span> df[<span class="st">'A'</span>].<span class="bu">map</span>(square)</span>
<span id="cb109-7"><a href="#cb109-7" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">Row_Sum</th>
<th data-quarto-table-cell-role="th">A_squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>12</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>5</td>
<td>8</td>
<td>15</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>6</td>
<td>9</td>
<td>18</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Element-wise transformation on an entire DataFrame.</p>
<div id="d23309c0" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>df.<span class="bu">map</span>(square)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">Row_Sum</th>
<th data-quarto-table-cell-role="th">A_squared</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>16</td>
<td>49</td>
<td>144</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4</td>
<td>25</td>
<td>64</td>
<td>225</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>36</td>
<td>81</td>
<td>324</td>
<td>81</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>When applying a function to an entire DataFrame, it’s important to ensure that all columns have the same data type. Otherwise, you might encounter errors or unexpected behavior.</p>
<div id="ca1bfb46" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>df_str <span class="op">=</span> pd.DataFrame({</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B'</span>: [<span class="st">'I'</span>, <span class="st">'major'</span>, <span class="st">'in'</span>],</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'C'</span>: [<span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>]</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a><span class="co"># uncomment the following line to run the code</span></span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a><span class="co"># df_str.map(square)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="key-differences-between-map-and-apply" class="level3" data-number="7.8.3">
<h3 data-number="7.8.3" class="anchored" data-anchor-id="key-differences-between-map-and-apply"><span class="header-section-number">7.8.3</span> Key Differences Between <code>map()</code> and <code>apply()</code></h3>
<table class="caption-top table">
<colgroup>
<col style="width: 21%">
<col style="width: 40%">
<col style="width: 38%">
</colgroup>
<thead>
<tr class="header">
<th>Feature</th>
<th><code>map()</code></th>
<th><code>apply()</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Applies to</td>
<td>Both Series and DataFrame</td>
<td>Both Series and DataFrame</td>
</tr>
<tr class="even">
<td>Functionality</td>
<td>Element-wise transformations</td>
<td>Can apply more complex functions (row-wise or column-wise for DataFrame)</td>
</tr>
<tr class="odd">
<td>Input</td>
<td>Function, dictionary, or another Series</td>
<td>Function</td>
</tr>
<tr class="even">
<td>Use Case</td>
<td>Used for simpler element-wise replacements or mappings</td>
<td>Used for more complex operations that can act on rows, columns, or individual elements</td>
</tr>
<tr class="odd">
<td>Axis Option</td>
<td>N/A</td>
<td>Can specify axis in DataFrame (row-wise or column-wise)</td>
</tr>
</tbody>
</table>
<section id="summary" class="level4" data-number="7.8.3.1">
<h4 data-number="7.8.3.1" class="anchored" data-anchor-id="summary"><span class="header-section-number">7.8.3.1</span> Summary:</h4>
<ul>
<li><code>map()</code>: Primarily used for element-wise operations. It can take functions, dictionaries, or Series as input for substitution or transformation.</li>
<li><code>apply()</code>: Apply complex functions across rows or columns.</li>
</ul>
</section>
</section>
</section>
<section id="introduction-to-lambda-functions-in-pandas" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="introduction-to-lambda-functions-in-pandas"><span class="header-section-number">7.9</span> Introduction to Lambda Functions in Pandas</h2>
<p>A lambda function is a small, anonymous function defined using the lambda keyword in Python. It can take any number of arguments but can only have one expression. In pandas, lambda functions are often used for quick and concise operations on data.</p>
<section id="syntax-of-lambda-functions" class="level3" data-number="7.9.1">
<h3 data-number="7.9.1" class="anchored" data-anchor-id="syntax-of-lambda-functions"><span class="header-section-number">7.9.1</span> Syntax of Lambda Functions:</h3>
<p><code>lambda arguments: expression</code></p>
</section>
<section id="key-features" class="level3" data-number="7.9.2">
<h3 data-number="7.9.2" class="anchored" data-anchor-id="key-features"><span class="header-section-number">7.9.2</span> Key Features</h3>
<ul>
<li><strong>Anonymous</strong>: Lambda functions are defined without a name.</li>
<li><strong>Concise</strong>: They are typically used for small, simple functions that are not reused elsewhere.</li>
<li><strong>Single Expression</strong>: They can only contain one expression, which is evaluated and returned.</li>
</ul>
<p>Lambda functions are commonly used with <code>apply()</code> and <code>map()</code> to efficiently transform data in pandas, allowing for quick, inline function definitions without the need to explicitly define separate functions.</p>
<p>Let’s use a lambda function to rewrite the <code>apply()</code> and <code>map()</code> operations from the previous example</p>
<div id="18abc024" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'A_squared_lamdba'</span>] <span class="op">=</span> df[<span class="st">'A'</span>].<span class="bu">map</span>(<span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">Row_Sum</th>
<th data-quarto-table-cell-role="th">A_squared</th>
<th data-quarto-table-cell-role="th">A_squared_lamdba</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>4</td>
<td>7</td>
<td>12</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>2</td>
<td>5</td>
<td>8</td>
<td>15</td>
<td>4</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>3</td>
<td>6</td>
<td>9</td>
<td>18</td>
<td>9</td>
<td>9</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="b947a9b6" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>df_squared <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>df_squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">Row_Sum</th>
<th data-quarto-table-cell-role="th">A_squared</th>
<th data-quarto-table-cell-role="th">A_squared_lamdba</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1</td>
<td>16</td>
<td>49</td>
<td>144</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>4</td>
<td>25</td>
<td>64</td>
<td>225</td>
<td>16</td>
<td>16</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>9</td>
<td>36</td>
<td>81</td>
<td>324</td>
<td>81</td>
<td>81</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Let’s look at other examples using lambda</p>
<p>Example 1: adding a new column based on existing columns</p>
<div id="3ca997ed" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B'</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Use a lambda function to create a new column 'C' as the sum of 'A' and 'B'</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'C'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> row: row[<span class="st">'A'</span>] <span class="op">+</span> row[<span class="st">'B'</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A  B  C
0  1  4  5
1  2  5  7
2  3  6  9</code></pre>
</div>
</div>
<p>Example 2: Filter rows based on a condition</p>
<div id="af222e36" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filter rows where values in column 'A' are greater than 1</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>filtered_df <span class="op">=</span> df[df[<span class="st">'A'</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">&gt;</span> <span class="dv">1</span>)]</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(filtered_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   A  B  C
1  2  5  7
2  3  6  9</code></pre>
</div>
</div>
</section>
</section>
<section id="understanding-inplacetrue-and-inplacefalse" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="understanding-inplacetrue-and-inplacefalse"><span class="header-section-number">7.10</span> Understanding <code>inplace=True</code> and <code>inplace=False</code></h2>
<p>Above, we covered multiple methods that allow you to modify a DataFrame or Series. The <code>inplace</code> parameter of these methods determines whether the operation modifies the original object or returns a new object.</p>
<ul>
<li><code>inplace=True</code>: Modifies the original DataFrame or Series directly and returns None. The changes are made in place, meaning the original object is altered.</li>
<li><code>inplace=False</code>: Returns a new DataFrame or Series with the modifications, leaving the original object unchanged. This is the default behavior for most methods.</li>
</ul>
<p><strong>Note</strong>: The default value for the inplace parameter is False for most methods.</p>
<p>Usage Example:</p>
<div id="bdeb868e" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a DataFrame</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>inplace_df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'B'</span>: [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop a column without modifying the original DataFrame</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a>df_dropped <span class="op">=</span> inplace_df.drop(<span class="st">'A'</span>, axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df_dropped)  <span class="co"># New DataFrame without column 'A'</span></span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inplace_df)          <span class="co"># Original DataFrame remains unchanged</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop a column in place</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>inplace_df.drop(<span class="st">'A'</span>, axis<span class="op">=</span><span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inplace_df)          <span class="co"># Original DataFrame is now modified</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   B
0  4
1  5
2  6
   A  B
0  1  4
1  2  5
2  3  6
   B
0  4
1  5
2  6</code></pre>
</div>
</div>
</section>
<section id="case-study" class="level2" data-number="7.11">
<h2 data-number="7.11" class="anchored" data-anchor-id="case-study"><span class="header-section-number">7.11</span> Case study</h2>
<p>To see the application of arithematic operations on DataFrames, let us see the case study below.</p>
<p><strong>Song recommendation:</strong> Spotify recommends songs based on songs listened by the user. Suppose you have listened to the song <em>drivers license</em>. Spotify intends to recommend you 5 songs that are <em>similar</em> to <em>drivers license</em>. Which songs should it recommend?</p>
<p>Let us see the available song information that can help us identify songs similar to <em>drivers license</em>. The <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.columns.html">columns</a> attribute of DataFrame will display all the columns names. The description of some of the column names relating to audio features is <a href="https://developer.spotify.com/documentation/web-api/reference/#/operations/get-audio-features">here</a>.</p>
<div id="de50b39c" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>spotify_data.columns</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="93">
<pre><code>Index(['artist_followers', 'genres', 'artist_name', 'artist_popularity',
       'track_name', 'track_popularity', 'duration_ms', 'explicit',
       'release_year', 'danceability', 'energy', 'key', 'loudness', 'mode',
       'speechiness', 'acousticness', 'instrumentalness', 'liveness',
       'valence', 'tempo', 'time_signature'],
      dtype='object')</code></pre>
</div>
</div>
<p><strong>Solution approach:</strong> We have several features of a song. Let us find songs similar to <em>drivers license</em> in terms of <em>danceability, energy, key, loudness, mode, speechiness, acousticness, instrumentalness, liveness, valence, time_signature</em> and <em>tempo</em>. Note that we are considering only audio features for simplicity.</p>
<p>To find the songs most similar to <em>drivers license</em>, we need to define a measure that quantifies the similarity. Let us define similarity of a song with <em>drivers license</em> as the Euclidean distance of the song from <em>drivers license</em>, where the coordinates of a song are: (danceability, energy, key, loudness, mode, speechiness, acousticness, instrumentalness, liveness, valence, time_signature, tempo). Thus, similarity can be formulated as:</p>
<p><span class="math display">\[\scriptsize
Similarity_{DL-S} = \sqrt{(danceability_{DL}-danceability_{S})^2+(energy_{DL}-energy_{S})^2 +\dots + (tempo_{DL}-tempo_{S})^2}
\]</span></p>
<p>where the subscript <em>DL</em> stands for <em>drivers license</em> and <em>S</em> stands for any song. The top 5 songs with the least value of <span class="math inline">\(Similarity_{DL-S}\)</span> will be the most similar to <em>drivers lincense</em> and should be recommended.</p>
<p>Let us subset the columns that we need to use to compute the Euclidean distance.</p>
<div id="58f9e121" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>audio_features <span class="op">=</span> spotify_data[[<span class="st">'danceability'</span>, <span class="st">'energy'</span>, <span class="st">'key'</span>, <span class="st">'loudness'</span>,<span class="st">'mode'</span>,<span class="st">'speechiness'</span>,</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>                               <span class="st">'acousticness'</span>, <span class="st">'instrumentalness'</span>, <span class="st">'liveness'</span>,<span class="st">'valence'</span>, <span class="st">'tempo'</span>, <span class="st">'time_signature'</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="14ce032f" class="cell" data-execution_count="95">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>audio_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.673</td>
<td>0.529</td>
<td>0</td>
<td>-7.226</td>
<td>1</td>
<td>0.3060</td>
<td>0.0769</td>
<td>0.000338</td>
<td>0.0856</td>
<td>0.203</td>
<td>161.991</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.511</td>
<td>0.566</td>
<td>6</td>
<td>-7.230</td>
<td>0</td>
<td>0.2000</td>
<td>0.3490</td>
<td>0.000000</td>
<td>0.3400</td>
<td>0.218</td>
<td>83.903</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.699</td>
<td>0.687</td>
<td>7</td>
<td>-3.997</td>
<td>0</td>
<td>0.1060</td>
<td>0.3080</td>
<td>0.000036</td>
<td>0.1210</td>
<td>0.499</td>
<td>88.933</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.708</td>
<td>0.690</td>
<td>2</td>
<td>-5.181</td>
<td>1</td>
<td>0.0442</td>
<td>0.3480</td>
<td>0.000000</td>
<td>0.2220</td>
<td>0.543</td>
<td>79.993</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.753</td>
<td>0.597</td>
<td>8</td>
<td>-8.469</td>
<td>1</td>
<td>0.2920</td>
<td>0.0477</td>
<td>0.000000</td>
<td>0.1970</td>
<td>0.616</td>
<td>76.997</td>
<td>4</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="ff58a3b1" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Distribution of values of audio_features</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>audio_features.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.568357</td>
<td>0.580633</td>
<td>5.240326</td>
<td>-9.432548</td>
<td>0.670928</td>
<td>0.111984</td>
<td>0.383938</td>
<td>0.071169</td>
<td>0.223756</td>
<td>0.552302</td>
<td>119.335060</td>
<td>3.884177</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.159444</td>
<td>0.236631</td>
<td>3.532546</td>
<td>4.449731</td>
<td>0.469877</td>
<td>0.198068</td>
<td>0.321142</td>
<td>0.209555</td>
<td>0.198076</td>
<td>0.250017</td>
<td>29.864219</td>
<td>0.458082</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-60.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.462000</td>
<td>0.405000</td>
<td>2.000000</td>
<td>-11.990000</td>
<td>0.000000</td>
<td>0.033200</td>
<td>0.070000</td>
<td>0.000000</td>
<td>0.098100</td>
<td>0.353000</td>
<td>96.099250</td>
<td>4.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.579000</td>
<td>0.591000</td>
<td>5.000000</td>
<td>-8.645000</td>
<td>1.000000</td>
<td>0.043100</td>
<td>0.325000</td>
<td>0.000011</td>
<td>0.141000</td>
<td>0.560000</td>
<td>118.002000</td>
<td>4.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.685000</td>
<td>0.776000</td>
<td>8.000000</td>
<td>-6.131000</td>
<td>1.000000</td>
<td>0.075300</td>
<td>0.671000</td>
<td>0.002220</td>
<td>0.292000</td>
<td>0.760000</td>
<td>137.929000</td>
<td>4.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>0.988000</td>
<td>1.000000</td>
<td>11.000000</td>
<td>3.744000</td>
<td>1.000000</td>
<td>0.969000</td>
<td>0.996000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>243.507000</td>
<td>5.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that the audio features differ in terms of scale. Some features like <em>key</em> have a wide range of [0,11], while others like <em>danceability</em> have a very narrow range of [0,0.988]. If we use them directly, features like <em>danceability</em> will have a much higher influence on <span class="math inline">\(Similarity_{DL-S}\)</span> as compared to features like <em>key</em>. Assuming we wish all the features to have equal weight in quantifying a song’s similarity to <em>drivers license</em>, we should scale the features, so that their values are comparable.</p>
<p>Let us scale the value of each column to a standard uniform distribution: <span class="math inline">\(U[0,1]\)</span>.</p>
<p>For scaling the values of a column to <span class="math inline">\(U[0,1]\)</span>, we need to subtract the minimum value of the column from each value, and divide by the range of values of the column. For example, <em>danceability</em> can be standardized as follows:</p>
<div id="1b0770a3" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scaling danceability to U[0,1]</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>danceability_value_range <span class="op">=</span> audio_features.danceability.<span class="bu">max</span>()<span class="op">-</span>audio_features.danceability.<span class="bu">min</span>()</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>danceability_std <span class="op">=</span> (audio_features.danceability<span class="op">-</span>audio_features.danceability.<span class="bu">min</span>())<span class="op">/</span>danceability_value_range</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>danceability_std</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="97">
<pre><code>0         0.681174
1         0.517206
2         0.707490
3         0.716599
4         0.762146
            ...   
243185    0.621457
243186    0.797571
243187    0.533401
243188    0.565789
243189    0.750000
Name: danceability, Length: 243190, dtype: float64</code></pre>
</div>
</div>
<p>However, it will be cumbersome to repeat the above code for each audio feature. We can instead write a function that scales values of a column to <span class="math inline">\(U[0,1]\)</span>, and apply the function on all the audio features.</p>
<div id="fac4cf58" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Function to scale a column to U[0,1]</span></span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> scale_uniform(x):</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (x<span class="op">-</span>x.<span class="bu">min</span>())<span class="op">/</span>(x.<span class="bu">max</span>()<span class="op">-</span>x.<span class="bu">min</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will use the Pandas function <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.apply.html">apply()</a> to apply the above function to the DataFrame <code>audio_features</code>.</p>
<div id="22d00959" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Scaling all audio features to U[0,1]</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>audio_features_scaled <span class="op">=</span> audio_features.<span class="bu">apply</span>(scale_uniform)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above two blocks of code can be concisely written with the <code>lambda</code> function as:</p>
<div id="9bd969df" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>audio_features_scaled <span class="op">=</span> audio_features.<span class="bu">apply</span>(<span class="kw">lambda</span> x: (x<span class="op">-</span>x.<span class="bu">min</span>())<span class="op">/</span>(x.<span class="bu">max</span>()<span class="op">-</span>x.<span class="bu">min</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="de3d4ad3" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co">#All the audio features are scaled to U[0,1]</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>audio_features_scaled.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="101">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
<td>243190.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>0.575260</td>
<td>0.580633</td>
<td>0.476393</td>
<td>0.793290</td>
<td>0.670928</td>
<td>0.115566</td>
<td>0.385480</td>
<td>0.071169</td>
<td>0.223756</td>
<td>0.552302</td>
<td>0.490068</td>
<td>0.776835</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.161380</td>
<td>0.236631</td>
<td>0.321141</td>
<td>0.069806</td>
<td>0.469877</td>
<td>0.204405</td>
<td>0.322431</td>
<td>0.209555</td>
<td>0.198076</td>
<td>0.250017</td>
<td>0.122642</td>
<td>0.091616</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>0.467611</td>
<td>0.405000</td>
<td>0.181818</td>
<td>0.753169</td>
<td>0.000000</td>
<td>0.034262</td>
<td>0.070281</td>
<td>0.000000</td>
<td>0.098100</td>
<td>0.353000</td>
<td>0.394647</td>
<td>0.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>0.586032</td>
<td>0.591000</td>
<td>0.454545</td>
<td>0.805644</td>
<td>1.000000</td>
<td>0.044479</td>
<td>0.326305</td>
<td>0.000011</td>
<td>0.141000</td>
<td>0.560000</td>
<td>0.484594</td>
<td>0.800000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>0.693320</td>
<td>0.776000</td>
<td>0.727273</td>
<td>0.845083</td>
<td>1.000000</td>
<td>0.077709</td>
<td>0.673695</td>
<td>0.002220</td>
<td>0.292000</td>
<td>0.760000</td>
<td>0.566427</td>
<td>0.800000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
<td>1.000000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Since we need to find the Euclidean distance from the song <em>drivers license</em>, let us find the index of the row containing features of <em>drivers license.</em></p>
<div id="fc313393" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Index of the row consisting of drivers license can be found with the index attribute</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>drivers_license_index <span class="op">=</span> spotify_data[spotify_data.track_name<span class="op">==</span><span class="st">'drivers license'</span>].index[<span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Note that the object returned by the <code>index</code> attribute is of type <code>pandas.core.indexes.numeric.Int64Index</code>. The elements of this object can be retrieved like the elements of a python list. That is why the object is sliced with <code>[0]</code> to return the first element of the object. As there is only one observation with the <code>track_name</code> as <em>drivers license</em>, we sliced the first element. If there were multiple observations with <code>track_name</code> as <em>drivers license</em>, we will obtain the indices of all those observations with the <code>index</code> attribute.</p>
<div id="54720e4c" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>audio_features_scaled.loc[drivers_license_index,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>danceability        0.592105
energy              0.436000
key                 0.909091
loudness            0.803825
mode                1.000000
speechiness         0.062023
acousticness        0.723896
instrumentalness    0.000013
liveness            0.105000
valence             0.132000
tempo               0.590841
time_signature      0.800000
Name: 2398, dtype: float64</code></pre>
</div>
</div>
<p>Now, we’ll subtract the audio features of <em>drivers license</em> from all other songs (broadcasting):</p>
<div id="9861092e" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Audio features of drivers license are being subtracted from audio features of all songs by broadcasting</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>songs_minus_DL <span class="op">=</span> audio_features_scaled<span class="op">-</span>audio_features_scaled.loc[drivers_license_index,:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, let us square the difference computed above. We’ll use the in-built python function <code>pow()</code> to square the difference:</p>
<div id="d419a291" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>songs_minus_DL_sq <span class="op">=</span> songs_minus_DL.<span class="bu">pow</span>(<span class="dv">2</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>songs_minus_DL_sq.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">energy</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.007933</td>
<td>0.008649</td>
<td>0.826446</td>
<td>0.000580</td>
<td>0.0</td>
<td>0.064398</td>
<td>0.418204</td>
<td>1.055600e-07</td>
<td>0.000376</td>
<td>0.005041</td>
<td>0.005535</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>0.005610</td>
<td>0.016900</td>
<td>0.132231</td>
<td>0.000577</td>
<td>1.0</td>
<td>0.020844</td>
<td>0.139498</td>
<td>1.716100e-10</td>
<td>0.055225</td>
<td>0.007396</td>
<td>0.060654</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>0.013314</td>
<td>0.063001</td>
<td>0.074380</td>
<td>0.005586</td>
<td>1.0</td>
<td>0.002244</td>
<td>0.171942</td>
<td>5.382400e-10</td>
<td>0.000256</td>
<td>0.134689</td>
<td>0.050906</td>
<td>0.0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.015499</td>
<td>0.064516</td>
<td>0.528926</td>
<td>0.003154</td>
<td>0.0</td>
<td>0.000269</td>
<td>0.140249</td>
<td>1.716100e-10</td>
<td>0.013689</td>
<td>0.168921</td>
<td>0.068821</td>
<td>0.0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>0.028914</td>
<td>0.025921</td>
<td>0.033058</td>
<td>0.000021</td>
<td>0.0</td>
<td>0.057274</td>
<td>0.456981</td>
<td>1.716100e-10</td>
<td>0.008464</td>
<td>0.234256</td>
<td>0.075428</td>
<td>0.0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now, we’ll sum the squares of differences from all audio features to compute the similarity of all songs to <em>drivers license</em>.</p>
<div id="080c735c" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>distance_squared <span class="op">=</span> songs_minus_DL_sq.<span class="bu">sum</span>(axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>distance_squared.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="105">
<pre><code>0    1.337163
1    1.438935
2    1.516317
3    1.004043
4    0.920316
dtype: float64</code></pre>
</div>
</div>
<p>Now, we’ll sort these distances to find the top 5 songs closest to drivers’s license.</p>
<div id="1ae05e3e" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>distances_sorted <span class="op">=</span> distance_squared.sort_values()</span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>distances_sorted.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>2398      0.000000
81844     0.008633
4397      0.011160
130789    0.015018
143744    0.015058
dtype: float64</code></pre>
</div>
</div>
<p>Using the indices of the top 5 distances, we will identify the top 5 songs most similar to <em>drivers license</em>:</p>
<div id="fb89b7af" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>spotify_data.loc[distances_sorted.index[<span class="dv">0</span>:<span class="dv">6</span>],:]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="107">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">artist_followers</th>
<th data-quarto-table-cell-role="th">genres</th>
<th data-quarto-table-cell-role="th">artist_name</th>
<th data-quarto-table-cell-role="th">artist_popularity</th>
<th data-quarto-table-cell-role="th">track_name</th>
<th data-quarto-table-cell-role="th">track_popularity</th>
<th data-quarto-table-cell-role="th">duration_ms</th>
<th data-quarto-table-cell-role="th">explicit</th>
<th data-quarto-table-cell-role="th">release_year</th>
<th data-quarto-table-cell-role="th">danceability</th>
<th data-quarto-table-cell-role="th">...</th>
<th data-quarto-table-cell-role="th">key</th>
<th data-quarto-table-cell-role="th">loudness</th>
<th data-quarto-table-cell-role="th">mode</th>
<th data-quarto-table-cell-role="th">speechiness</th>
<th data-quarto-table-cell-role="th">acousticness</th>
<th data-quarto-table-cell-role="th">instrumentalness</th>
<th data-quarto-table-cell-role="th">liveness</th>
<th data-quarto-table-cell-role="th">valence</th>
<th data-quarto-table-cell-role="th">tempo</th>
<th data-quarto-table-cell-role="th">time_signature</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">2398</td>
<td>1444702</td>
<td>pop</td>
<td>Olivia Rodrigo</td>
<td>88</td>
<td>drivers license</td>
<td>99</td>
<td>242014</td>
<td>1</td>
<td>2021</td>
<td>0.585</td>
<td>...</td>
<td>10</td>
<td>-8.761</td>
<td>1</td>
<td>0.0601</td>
<td>0.721</td>
<td>0.000013</td>
<td>0.105</td>
<td>0.132</td>
<td>143.874</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">81844</td>
<td>2264501</td>
<td>pop</td>
<td>Jay Chou</td>
<td>74</td>
<td>安靜</td>
<td>49</td>
<td>334240</td>
<td>0</td>
<td>2001</td>
<td>0.513</td>
<td>...</td>
<td>10</td>
<td>-7.853</td>
<td>1</td>
<td>0.0281</td>
<td>0.688</td>
<td>0.000008</td>
<td>0.116</td>
<td>0.123</td>
<td>143.924</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4397</td>
<td>25457</td>
<td>pop</td>
<td>Terence Lam</td>
<td>60</td>
<td>拼命無恙 in Bb major</td>
<td>52</td>
<td>241062</td>
<td>0</td>
<td>2020</td>
<td>0.532</td>
<td>...</td>
<td>10</td>
<td>-9.690</td>
<td>1</td>
<td>0.0269</td>
<td>0.674</td>
<td>0.000000</td>
<td>0.117</td>
<td>0.190</td>
<td>151.996</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">130789</td>
<td>176266</td>
<td>pop</td>
<td>Alan Tam</td>
<td>54</td>
<td>從後趕上</td>
<td>8</td>
<td>258427</td>
<td>0</td>
<td>1988</td>
<td>0.584</td>
<td>...</td>
<td>10</td>
<td>-11.889</td>
<td>1</td>
<td>0.0282</td>
<td>0.707</td>
<td>0.000002</td>
<td>0.107</td>
<td>0.124</td>
<td>140.147</td>
<td>4</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">143744</td>
<td>396326</td>
<td>pop &amp; rock</td>
<td>Laura Branigan</td>
<td>64</td>
<td>How Am I Supposed to Live Without You</td>
<td>40</td>
<td>263320</td>
<td>0</td>
<td>1983</td>
<td>0.559</td>
<td>...</td>
<td>10</td>
<td>-8.260</td>
<td>1</td>
<td>0.0355</td>
<td>0.813</td>
<td>0.000083</td>
<td>0.134</td>
<td>0.185</td>
<td>139.079</td>
<td>4</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">35627</td>
<td>1600562</td>
<td>pop</td>
<td>Tiziano Ferro</td>
<td>68</td>
<td>Non Me Lo So Spiegare</td>
<td>44</td>
<td>240040</td>
<td>0</td>
<td>2014</td>
<td>0.609</td>
<td>...</td>
<td>11</td>
<td>-7.087</td>
<td>1</td>
<td>0.0352</td>
<td>0.706</td>
<td>0.000000</td>
<td>0.130</td>
<td>0.207</td>
<td>146.078</td>
<td>4</td>
</tr>
</tbody>
</table>

<p>6 rows × 21 columns</p>
</div>
</div>
</div>
<p>We can see the top 5 songs most similar to <em>drivers license</em> in the <em>track_name</em> column above. Interestingly, three of the five songs are Asian! These songs indeed sound similar to <em>drivers license</em>!</p>
</section>
<section id="independent-practice" class="level2" data-number="7.12">
<h2 data-number="7.12" class="anchored" data-anchor-id="independent-practice"><span class="header-section-number">7.12</span> Independent Practice:</h2>
<section id="practice-exercise-1" class="level3" data-number="7.12.1">
<h3 data-number="7.12.1" class="anchored" data-anchor-id="practice-exercise-1"><span class="header-section-number">7.12.1</span> Practice exercise 1</h3>
<section id="section" class="level4" data-number="7.12.1.1">
<h4 data-number="7.12.1.1" class="anchored" data-anchor-id="section"><span class="header-section-number">7.12.1.1</span> </h4>
<p>Read the file <em>Top 10 Albums By Year.csv</em>. This file contains the top 10 albums for each year from 1990 to 2021. Each row corresponds to a unique album.</p>
</section>
<section id="section-1" class="level4" data-number="7.12.1.2">
<h4 data-number="7.12.1.2" class="anchored" data-anchor-id="section-1"><span class="header-section-number">7.12.1.2</span> </h4>
<p>Print the summary statistics of the data, and answer the following questions:</p>
<ol type="1">
<li>What proportion of albums have 15 or lesser tracks? Mention a range for the proportion.</li>
<li>What is the mean length of a track (in minutes)?</li>
</ol>
</section>
<section id="section-2" class="level4" data-number="7.12.1.3">
<h4 data-number="7.12.1.3" class="anchored" data-anchor-id="section-2"><span class="header-section-number">7.12.1.3</span> </h4>
<p>Why is <code>Worldwide Sales</code> not included in the summary statistics table printed in the above step?</p>
</section>
<section id="section-3" class="level4" data-number="7.12.1.4">
<h4 data-number="7.12.1.4" class="anchored" data-anchor-id="section-3"><span class="header-section-number">7.12.1.4</span> </h4>
<p>Update the DataFrame so that <code>Worldwide Sales</code> is included in the summary statistics table. Print the summary statistics table.</p>
<p><strong>Hint</strong>: Sometimes it may not be possible to convert an object to numeric(). For example, the object ‘hi’ cannot be converted to a numeric() by the python compiler. To avoid getting an error, use the <code>errors</code> argument of <code>to_numeric()</code> to force such conversions to NaN (missing value).</p>
</section>
<section id="section-4" class="level4" data-number="7.12.1.5">
<h4 data-number="7.12.1.5" class="anchored" data-anchor-id="section-4"><span class="header-section-number">7.12.1.5</span> </h4>
<p>Create a new column called <code>mean_sales_per_year</code> that computes the average worldwide sales per year for each album, assuming that the worldwide sales are as of 2022. Print the first 5 rows of the updated DataFrame.</p>
</section>
<section id="section-5" class="level4" data-number="7.12.1.6">
<h4 data-number="7.12.1.6" class="anchored" data-anchor-id="section-5"><span class="header-section-number">7.12.1.6</span> </h4>
<p>Find the album having the highest worldwide sales per year, and its artist.</p>
</section>
<section id="section-6" class="level4" data-number="7.12.1.7">
<h4 data-number="7.12.1.7" class="anchored" data-anchor-id="section-6"><span class="header-section-number">7.12.1.7</span> </h4>
<p>Subset the data to include only Hip-Hop albums. How many Hip_Hop albums are there?</p>
</section>
<section id="section-7" class="level4" data-number="7.12.1.8">
<h4 data-number="7.12.1.8" class="anchored" data-anchor-id="section-7"><span class="header-section-number">7.12.1.8</span> </h4>
<p>Which album amongst hip-hop has the higest mean sales per year per track, and who is its artist?</p>
</section>
</section>
<section id="practice-exercise-2" class="level3" data-number="7.12.2">
<h3 data-number="7.12.2" class="anchored" data-anchor-id="practice-exercise-2"><span class="header-section-number">7.12.2</span> Practice exercise 2</h3>
<section id="section-8" class="level4" data-number="7.12.2.1">
<h4 data-number="7.12.2.1" class="anchored" data-anchor-id="section-8"><span class="header-section-number">7.12.2.1</span> </h4>
<p>Read the file <em>STAT303-1 survey for data analysis.csv</em>.</p>
</section>
<section id="section-9" class="level4" data-number="7.12.2.2">
<h4 data-number="7.12.2.2" class="anchored" data-anchor-id="section-9"><span class="header-section-number">7.12.2.2</span> </h4>
<p>How many observations and variables are there in the data?</p>
</section>
<section id="section-10" class="level4" data-number="7.12.2.3">
<h4 data-number="7.12.2.3" class="anchored" data-anchor-id="section-10"><span class="header-section-number">7.12.2.3</span> </h4>
<p>Rename all the columns of the data, except the first two columns, with the shorter names in the list <code>new_col_names</code> given below. The order of column names in the list is the same as the order in which the columns are to be renamed starting with the third column from the left.</p>
</section>
<section id="section-11" class="level4" data-number="7.12.2.4">
<h4 data-number="7.12.2.4" class="anchored" data-anchor-id="section-11"><span class="header-section-number">7.12.2.4</span> </h4>
<p>Rename the following columns again:</p>
<ol type="1">
<li><p>Rename <code>do_you_smoke</code> to <code>smoke</code>.</p></li>
<li><p>Rename <code>are_you_an_introvert_or_extrovert</code> to <code>introvert_extrovert</code>.</p></li>
</ol>
<p><strong>Hint:</strong> Use the function <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.rename.html">rename()</a></p>
</section>
<section id="section-12" class="level4" data-number="7.12.2.5">
<h4 data-number="7.12.2.5" class="anchored" data-anchor-id="section-12"><span class="header-section-number">7.12.2.5</span> </h4>
<p>Find the proportion of people going to more than 4 parties per month. Use the variable <code>parties_per_month</code>.</p>
</section>
<section id="section-13" class="level4" data-number="7.12.2.6">
<h4 data-number="7.12.2.6" class="anchored" data-anchor-id="section-13"><span class="header-section-number">7.12.2.6</span> </h4>
<p>Among the people who go to more than 4 parties a month, what proportion of them are introverts?</p>
</section>
<section id="section-14" class="level4" data-number="7.12.2.7">
<h4 data-number="7.12.2.7" class="anchored" data-anchor-id="section-14"><span class="header-section-number">7.12.2.7</span> </h4>
<p>Find the proportion of people in each category of the variable <code>how_happy</code>.</p>
</section>
<section id="section-15" class="level4" data-number="7.12.2.8">
<h4 data-number="7.12.2.8" class="anchored" data-anchor-id="section-15"><span class="header-section-number">7.12.2.8</span> </h4>
<p>Among the people who go to more than 4 parties a month, what proportion of them are either <code>Pretty happy</code> or <code>Very happy</code>?</p>
</section>
<section id="section-16" class="level4" data-number="7.12.2.9">
<h4 data-number="7.12.2.9" class="anchored" data-anchor-id="section-16"><span class="header-section-number">7.12.2.9</span> </h4>
<p>Examine the column <code>num_insta_followers</code>. Some numbers in the column contain a comma(<code>,</code>) or a tilde(<code>~</code>). Remove both these characters from the numbers in the column.</p>
<p><strong>Hint:</strong> You may use the function <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.replace.html">str.replace()</a> of the Pandas Series class.</p>
</section>
<section id="section-17" class="level4" data-number="7.12.2.10">
<h4 data-number="7.12.2.10" class="anchored" data-anchor-id="section-17"><span class="header-section-number">7.12.2.10</span> </h4>
<p>Convert the column <code>num_insta_followers</code> to numeric. Coerce the errors.</p>
</section>
<section id="section-18" class="level4" data-number="7.12.2.11">
<h4 data-number="7.12.2.11" class="anchored" data-anchor-id="section-18"><span class="header-section-number">7.12.2.11</span> </h4>
<p>What is the mean <code>internet_hours_per_day</code> for the top 46 people in terms of number of instagram followers?</p>
</section>
<section id="section-19" class="level4" data-number="7.12.2.12">
<h4 data-number="7.12.2.12" class="anchored" data-anchor-id="section-19"><span class="header-section-number">7.12.2.12</span> </h4>
<p>What is the mean <code>internet_hours_per_day</code> for the remaining people?</p>
</section>
</section>
<section id="practice-exercise-3" class="level3" data-number="7.12.3">
<h3 data-number="7.12.3" class="anchored" data-anchor-id="practice-exercise-3"><span class="header-section-number">7.12.3</span> Practice exercise 3</h3>
<section id="section-20" class="level4" data-number="7.12.3.1">
<h4 data-number="7.12.3.1" class="anchored" data-anchor-id="section-20"><span class="header-section-number">7.12.3.1</span> </h4>
<p>Use the updated dataset from Practice exercise 2.</p>
<p>The last four variables in the dataset are:</p>
<ol type="1">
<li><p><code>cant_change_math_ability</code></p></li>
<li><p><code>can_change_math_ability</code></p></li>
<li><p><code>math_is_genetic</code></p></li>
<li><p><code>much_effort_is_lack_of_talent</code></p></li>
</ol>
<p>Each of the above variables has values - <code>Agree</code> / <code>Disagree</code>. Replace <code>Agree</code> with <code>1</code> and <code>Disagree</code> with <code>0</code>.</p>
<p><strong>Hint :</strong> You can do it with any one of the following methods:</p>
<ol type="1">
<li><p>Use the map() function</p></li>
<li><p>Use the apply() function with the lambda function</p></li>
<li><p>Use the replace() function</p></li>
</ol>
<p>Two of the above methods avoid a <code>for</code>-loop. Which ones?</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./NumPy.html" class="pagination-link" aria-label="NumPy">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">NumPy</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Reading data.html" class="pagination-link" aria-label="Reading Data">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Reading Data</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>